
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Large Object Support &#8212; Swift 0.1.0.dev10162 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/basic.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="canonical" href="/openstack-swift/overview_large_objects.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Global Clusters" href="overview_global_cluster.html" />
    <link rel="prev" title="Rate Limiting" href="ratelimit.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">

<!-- Search CSS -->
<link href="_static/css/search.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/pygments.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


  </head><body>

<!-- SOURCE_FILE: https://opendev.org/openstack/swift/src/doc/source/overview_large_objects.rst -->

<script>
    (function (window, document) {
        var loader = function () {
            var script = document.createElement("script"), tag = document.getElementsByTagName("script")[0];
            script.src = "https://search.openstack.org/widget/embed.min.js?t="+Date.now();
            tag.parentNode.insertBefore(script, tag);
        };
        window.addEventListener ? window.addEventListener("load", loader, false) : window.attachEvent("onload", loader);
    })(window, document);
</script>

<nav class="navbar navbar-default" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="https://www.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</div>
      <ul class="nav navbar-nav navbar-main show">
        <li class="search-container-mobile">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</li>
        <li> <!--Software -->
          <a href="https://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/openstack-components">OpenStack Components</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/sdks">SDKs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/deployment-tools">Deployment Tools</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/assets/software/projectmap/openstack-map.pdf" target="_blank">OpenStack Map</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
          </ul>
        </li>
        <li> <!-- Use Cases -->
          <a href="https://www.openstack.org/use-cases/" class="drop" id="dropdownMenuUsers">Use Cases <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/">Users in Production</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/bare-metal/">Ironic Bare Metal</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/edge-computing/">Edge Computing</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/telecoms-and-nfv/">Telecom & NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/science/">Science and HPC</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/containers/">Containers</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/enterprise/">Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li> <!-- Events -->
          <a href="https://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">Open Infrastructure Summits</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/ptg/">Project Teams Gathering</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/opendev-2020/">OpenDev</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/community-events/">Community Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/openstackdays">OpenStack & OpenInfra Days</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
          </ul>
        </li>
        <li><!-- Community -->
          <a href="https://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/tech-committee">OpenStack Technical Committee</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/coa/">Get Certified (COA)</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketing/">Marketing Resources</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/news/">Community News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/supporting-organizations/">OpenInfra Foundation Supporting Organizations</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">Open Infrastructure Foundation (OpenInfra Foundation)</a></li>
          </ul>
        </li>
        <li><!-- Marketplace -->
          <a href="https://www.openstack.orgmarketplace/" class="drop" id="dropdownMenuLearn">Marketplace <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/distros/">Distros & Appliances</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/public-clouds/">Public Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/hosted-private-clouds/">Hosted Private Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/remotely-managed-private-clouds/">Remotely Managed Private Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/consulting/">Consulting & Integrators</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/drivers/">Drivers</a></li>
          </ul>
        </li>
        <li><!-- Blog -->
          <a href="https://www.openstack.org/blog/">Blog</a>
        </li>
        <li><!-- Docs -->
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
        <li> <!-- Join -->
            <li class="join-nav-section">
              <a href="https://openinfra.dev/join/" id="dropdownMenuJoin">Join <i class="fa fa-caret-down"></i></a>
              <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuJoin" style="display: none;">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sign up for Foundation Membership</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sponsor the Foundation</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">More about the Foundation</a></li>
              </ul>
            </li>
            <li>
              <a href="https://www.openstack.org/Security/login/?BackURL=/home/" class="sign-in-btn">Log In</a>
            </li>
        </li>
      </ul>
    </div>
  </div>
  <!-- /.container -->
</nav>

    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row docs-title">
  <div class="col-lg-8">
      <h1>Large Object Support</h1>
    
  </div>
  <div class="docs-actions">
    
    <a href="ratelimit.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Rate Limiting"></i></a>
    
    
    <a href="overview_global_cluster.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Global Clusters"></i></a>
    
    <a id="pdfLink1" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
    
  </div>
</div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-body" role="main">

  <section id="large-object-support">
<span id="large-objects"></span><h1>Large Object Support<a class="headerlink" href="#large-object-support" title="Permalink to this heading">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>Swift has a limit on the size of a single uploaded object; by default this is
5GB. However, the download size of a single object is virtually unlimited with
the concept of segmentation. Segments of the larger object are uploaded and a
special manifest file is created that, when downloaded, sends all the segments
concatenated as a single object. This also offers much greater upload speed
with the possibility of parallel uploads of the segments.</p>
</section>
<section id="module-swift.common.middleware.dlo">
<span id="id1"></span><span id="dlo-doc"></span><span id="dynamic-large-objects"></span><h2>Dynamic Large Objects<a class="headerlink" href="#module-swift.common.middleware.dlo" title="Permalink to this heading">¶</a></h2>
<p>Middleware that will provide Dynamic Large Object (DLO) support.</p>
<section id="using-swift">
<h3>Using <code class="docutils literal notranslate"><span class="pre">swift</span></code><a class="headerlink" href="#using-swift" title="Permalink to this heading">¶</a></h3>
<p>The quickest way to try out this feature is use the <code class="docutils literal notranslate"><span class="pre">swift</span></code> Swift Tool
included with the <a class="reference external" href="http://github.com/openstack/python-swiftclient">python-swiftclient</a> library.  You can use the <code class="docutils literal notranslate"><span class="pre">-S</span></code>
option to specify the segment size to use when splitting a large file. For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="n">upload</span> <span class="n">test_container</span> <span class="o">-</span><span class="n">S</span> <span class="mi">1073741824</span> <span class="n">large_file</span>
</pre></div>
</div>
<p>This would split the large_file into 1G segments and begin uploading those
segments in parallel. Once all the segments have been uploaded, <code class="docutils literal notranslate"><span class="pre">swift</span></code> will
then create the manifest file so the segments can be downloaded as one.</p>
<p>So now, the following <code class="docutils literal notranslate"><span class="pre">swift</span></code> command would download the entire large
object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="n">download</span> <span class="n">test_container</span> <span class="n">large_file</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">swift</span></code> command uses a strict convention for its segmented object
support. In the above example it will upload all the segments into a
second container named test_container_segments. These segments will
have names like large_file/1290206778.25/21474836480/00000000,
large_file/1290206778.25/21474836480/00000001, etc.</p>
<p>The main benefit for using a separate container is that the main container
listings will not be polluted with all the segment names. The reason for using
the segment name format of &lt;name&gt;/&lt;timestamp&gt;/&lt;size&gt;/&lt;segment&gt; is so that an
upload of a new file with the same name won’t overwrite the contents of the
first until the last moment when the manifest file is updated.</p>
<p><code class="docutils literal notranslate"><span class="pre">swift</span></code> will manage these segment files for you, deleting old segments on
deletes and overwrites, etc. You can override this behavior with the
<code class="docutils literal notranslate"><span class="pre">--leave-segments</span></code> option if desired; this is useful if you want to have
multiple versions of the same large object available.</p>
</section>
<section id="direct-api">
<h3>Direct API<a class="headerlink" href="#direct-api" title="Permalink to this heading">¶</a></h3>
<p>You can also work with the segments and manifests directly with HTTP
requests instead of having <code class="docutils literal notranslate"><span class="pre">swift</span></code> do that for you. You can just
upload the segments like you would any other object and the manifest
is just a zero-byte (not enforced) file with an extra
<code class="docutils literal notranslate"><span class="pre">X-Object-Manifest</span></code> header.</p>
<p>All the object segments need to be in the same container, have a common object
name prefix, and sort in the order in which they should be concatenated.
Object names are sorted lexicographically as UTF-8 byte strings.
They don’t have to be in the same container as the manifest file will be, which
is useful to keep container listings clean as explained above with <code class="docutils literal notranslate"><span class="pre">swift</span></code>.</p>
<p>The manifest file is simply a zero-byte (not enforced) file with the extra
<code class="docutils literal notranslate"><span class="pre">X-Object-Manifest:</span> <span class="pre">&lt;container&gt;/&lt;prefix&gt;</span></code> header, where <code class="docutils literal notranslate"><span class="pre">&lt;container&gt;</span></code> is
the container the object segments are in and <code class="docutils literal notranslate"><span class="pre">&lt;prefix&gt;</span></code> is the common prefix
for all the segments.</p>
<p>It is best to upload all the segments first and then create or update the
manifest. In this way, the full object won’t be available for downloading
until the upload is complete. Also, you can upload a new set of segments to
a second location and then update the manifest to point to this new location.
During the upload of the new segments, the original manifest will still be
available to download the first set of segments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When updating a manifest object using a POST request, a
<code class="docutils literal notranslate"><span class="pre">X-Object-Manifest</span></code> header must be included for the object to
continue to behave as a manifest object.</p>
<p>The manifest file should have no content. However, this is not enforced.
If the manifest path itself conforms to container/prefix specified in
<code class="docutils literal notranslate"><span class="pre">X-Object-Manifest</span></code>, and if manifest has some content/data in it, it
would also be considered as segment and manifest’s content will be part of
the concatenated GET response. The order of concatenation follows the usual
DLO logic which is - the order of concatenation adheres to order returned
when segment names are sorted.</p>
</div>
<p>Here’s an example using <code class="docutils literal notranslate"><span class="pre">curl</span></code> with tiny 1-byte segments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, upload the segments</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Auth-Token: &lt;token&gt;&#39;</span>         <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span><span class="o">/</span><span class="mi">00000001</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">binary</span> <span class="s1">&#39;1&#39;</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Auth-Token: &lt;token&gt;&#39;</span>         <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span><span class="o">/</span><span class="mi">00000002</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">binary</span> <span class="s1">&#39;2&#39;</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Auth-Token: &lt;token&gt;&#39;</span>         <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span><span class="o">/</span><span class="mi">00000003</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">binary</span> <span class="s1">&#39;3&#39;</span>

<span class="c1"># Next, create the manifest file</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Auth-Token: &lt;token&gt;&#39;</span>         <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Object-Manifest: container/myobject/&#39;</span>         <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">binary</span> <span class="s1">&#39;&#39;</span>

<span class="c1"># And now we can download the segments as a single object</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Auth-Token: &lt;token&gt;&#39;</span>         <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.dlo.GetContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.dlo.</span></span><span class="sig-name descname"><span class="pre">GetContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dlo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.dlo.GetContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.wsgi.WSGIContext" title="swift.common.wsgi.WSGIContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIContext</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.dlo.GetContext.get_or_head_response">
<span class="sig-name descname"><span class="pre">get_or_head_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_object_manifest</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.dlo.GetContext.get_or_head_response" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – user’s request</p></li>
<li><p><strong>x_object_manifest</strong> – as unquoted, native string</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.dlo.GetContext.handle_request">
<span class="sig-name descname"><span class="pre">handle_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.dlo.GetContext.handle_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a GET or HEAD request, and if it is for a dynamic large object
manifest, return an appropriate response.</p>
<p>Otherwise, simply pass it through.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-swift.common.middleware.slo">
<span id="id2"></span><span id="slo-doc"></span><span id="static-large-objects"></span><h2>Static Large Objects<a class="headerlink" href="#module-swift.common.middleware.slo" title="Permalink to this heading">¶</a></h2>
<p>Middleware that will provide Static Large Object (SLO) support.</p>
<p>This feature is very similar to Dynamic Large Object (DLO) support in that
it allows the user to upload many objects concurrently and afterwards
download them as a single object. It is different in that it does not rely
on eventually consistent container listings to do so. Instead, a user
defined manifest of the object segments is used.</p>
<section id="uploading-the-manifest">
<h3>Uploading the Manifest<a class="headerlink" href="#uploading-the-manifest" title="Permalink to this heading">¶</a></h3>
<p>After the user has uploaded the objects to be concatenated, a manifest is
uploaded. The request must be a <code class="docutils literal notranslate"><span class="pre">PUT</span></code> with the query parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>?multipart-manifest=put
</pre></div>
</div>
<p>The body of this request will be an ordered list of segment descriptions in
JSON format. The data to be supplied for each segment is either:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>path</p></td>
<td><p>the path to the segment object (not including account)
/container/object_name</p></td>
</tr>
<tr class="row-odd"><td><p>etag</p></td>
<td><p>(optional) the ETag given back when the segment object
was PUT</p></td>
</tr>
<tr class="row-even"><td><p>size_bytes</p></td>
<td><p>(optional) the size of the complete segment object in
bytes</p></td>
</tr>
<tr class="row-odd"><td><p>range</p></td>
<td><p>(optional) the (inclusive) range within the object to
use as a segment. If omitted, the entire object is used</p></td>
</tr>
</tbody>
</table>
<p>Or:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>data</p></td>
<td><p>base64-encoded data to be returned</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At least one object-backed segment must be included. If you’d like
to create a manifest consisting purely of data segments, consider
uploading a normal object instead.</p>
</div>
<p>The format of the list will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/cont/object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;etag&quot;</span><span class="p">:</span> <span class="s2">&quot;etagoftheobjectsegment&quot;</span><span class="p">,</span>
  <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="mi">10485760</span><span class="p">,</span>
  <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="s2">&quot;1048576-2097151&quot;</span><span class="p">},</span>
 <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="s2">&quot;interstitial data&quot;</span><span class="p">)},</span>
 <span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/cont/another-object&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
 <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>The number of object-backed segments is limited to <code class="docutils literal notranslate"><span class="pre">max_manifest_segments</span></code>
(configurable in proxy-server.conf, default 1000). Each segment must be at
least 1 byte. On upload, the middleware will head every object-backed segment
passed in to verify:</p>
<ol class="arabic simple">
<li><p>the segment exists (i.e. the <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> was successful);</p></li>
<li><p>the segment meets minimum size requirements;</p></li>
<li><p>if the user provided a non-null <code class="docutils literal notranslate"><span class="pre">etag</span></code>, the etag matches;</p></li>
<li><p>if the user provided a non-null <code class="docutils literal notranslate"><span class="pre">size_bytes</span></code>, the size_bytes matches; and</p></li>
<li><p>if the user provided a <code class="docutils literal notranslate"><span class="pre">range</span></code>, it is a singular, syntactically correct
range that is satisfiable given the size of the object referenced.</p></li>
</ol>
<p>For inlined data segments, the middleware verifies each is valid, non-empty
base64-encoded binary data. Note that data segments <em>do not</em> count against
<code class="docutils literal notranslate"><span class="pre">max_manifest_segments</span></code>.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">etag</span></code> and <code class="docutils literal notranslate"><span class="pre">size_bytes</span></code> keys are optional; if omitted, the
verification is not performed. If any of the objects fail to verify (not
found, size/etag mismatch, below minimum size, invalid range) then the user
will receive a 4xx error response. If everything does match, the user will
receive a 2xx response and the SLO object is ready for downloading.</p>
<p>Note that large manifests may take a long time to verify; historically,
clients would need to use a long read timeout for the connection to give
Swift enough time to send a final <code class="docutils literal notranslate"><span class="pre">201</span> <span class="pre">Created</span></code> or <code class="docutils literal notranslate"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></code>
response. Now, clients should use the query parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>?multipart-manifest=put&amp;heartbeat=on
</pre></div>
</div>
<p>to request that Swift send an immediate <code class="docutils literal notranslate"><span class="pre">202</span> <span class="pre">Accepted</span></code> response and periodic
whitespace to keep the connection alive. A final response code will appear in
the body. The format of the response body defaults to text/plain but can be
either json or xml depending on the <code class="docutils literal notranslate"><span class="pre">Accept</span></code> header. An example body is as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Response</span> <span class="n">Status</span><span class="p">:</span> <span class="mi">201</span> <span class="n">Created</span>
<span class="n">Response</span> <span class="n">Body</span><span class="p">:</span>
<span class="n">Etag</span><span class="p">:</span> <span class="s2">&quot;8f481cede6d2ddc07cb36aa084d9a64d&quot;</span>
<span class="n">Last</span> <span class="n">Modified</span><span class="p">:</span> <span class="n">Wed</span><span class="p">,</span> <span class="mi">25</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">17</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">55</span> <span class="n">GMT</span>
<span class="n">Errors</span><span class="p">:</span>
</pre></div>
</div>
<p>Or, as a json response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Response Status&quot;</span><span class="p">:</span> <span class="s2">&quot;201 Created&quot;</span><span class="p">,</span>
 <span class="s2">&quot;Response Body&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
 <span class="s2">&quot;Etag&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">8f481cede6d2ddc07cb36aa084d9a64d</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
 <span class="s2">&quot;Last Modified&quot;</span><span class="p">:</span> <span class="s2">&quot;Wed, 25 Oct 2017 17:08:55 GMT&quot;</span><span class="p">,</span>
 <span class="s2">&quot;Errors&quot;</span><span class="p">:</span> <span class="p">[]}</span>
</pre></div>
</div>
<p>Behind the scenes, on success, a JSON manifest generated from the user input is
sent to object servers with an extra <code class="docutils literal notranslate"><span class="pre">X-Static-Large-Object:</span> <span class="pre">True</span></code> header
and a modified <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code>. The items in this manifest will include the
<code class="docutils literal notranslate"><span class="pre">etag</span></code> and <code class="docutils literal notranslate"><span class="pre">size_bytes</span></code> for each segment, regardless of whether the client
specified them for verification. The parameter <code class="docutils literal notranslate"><span class="pre">swift_bytes=$total_size</span></code> will
be appended to the existing <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code>, where <code class="docutils literal notranslate"><span class="pre">$total_size</span></code> is the sum
of all the included segments’ <code class="docutils literal notranslate"><span class="pre">size_bytes</span></code>. This extra parameter will be
hidden from the user.</p>
<p>Manifest files can reference objects in separate containers, which will improve
concurrent upload speed. Objects can be referenced by multiple manifests. The
segments of a SLO manifest can even be other SLO manifests. Treat them as any
other object i.e., use the <code class="docutils literal notranslate"><span class="pre">Etag</span></code> and <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> given on the <code class="docutils literal notranslate"><span class="pre">PUT</span></code>
of the sub-SLO in the manifest to the parent SLO.</p>
<p>While uploading a manifest, a user can send <code class="docutils literal notranslate"><span class="pre">Etag</span></code> for verification. It needs
to be md5 of the segments’ etags, if there is no range specified. For example,
if the manifest to be uploaded looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/cont/object1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;etag&quot;</span><span class="p">:</span> <span class="s2">&quot;etagoftheobjectsegment1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="mi">10485760</span><span class="p">},</span>
 <span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/cont/object2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;etag&quot;</span><span class="p">:</span> <span class="s2">&quot;etagoftheobjectsegment2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="mi">10485760</span><span class="p">}]</span>
</pre></div>
</div>
<p>The Etag of the above manifest would be md5 of <code class="docutils literal notranslate"><span class="pre">etagoftheobjectsegment1</span></code> and
<code class="docutils literal notranslate"><span class="pre">etagoftheobjectsegment2</span></code>. This could be computed in the following way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="o">-</span><span class="n">n</span> <span class="s1">&#39;etagoftheobjectsegment1etagoftheobjectsegment2&#39;</span> <span class="o">|</span> <span class="n">md5sum</span>
</pre></div>
</div>
<p>If a manifest to be uploaded with a segment range looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/cont/object1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;etag&quot;</span><span class="p">:</span> <span class="s2">&quot;etagoftheobjectsegmentone&quot;</span><span class="p">,</span>
  <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="mi">10485760</span><span class="p">,</span>
  <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="s2">&quot;1-2&quot;</span><span class="p">},</span>
 <span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/cont/object2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;etag&quot;</span><span class="p">:</span> <span class="s2">&quot;etagoftheobjectsegmenttwo&quot;</span><span class="p">,</span>
  <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="mi">10485760</span><span class="p">,</span>
  <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="s2">&quot;3-4&quot;</span><span class="p">}]</span>
</pre></div>
</div>
<p>While computing the Etag of the above manifest, internally each segment’s etag
will be taken in the form of <code class="docutils literal notranslate"><span class="pre">etagvalue:rangevalue;</span></code>. Hence the Etag of the
above manifest would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="o">-</span><span class="n">n</span> <span class="s1">&#39;etagoftheobjectsegmentone:1-2;etagoftheobjectsegmenttwo:3-4;&#39;</span> \
<span class="o">|</span> <span class="n">md5sum</span>
</pre></div>
</div>
<p>For the purposes of Etag computations, inlined data segments are considered to
have an etag of the md5 of the raw data (i.e., <em>not</em> base64-encoded).</p>
</section>
<section id="range-specification">
<h3>Range Specification<a class="headerlink" href="#range-specification" title="Permalink to this heading">¶</a></h3>
<p>Users now have the ability to specify ranges for SLO segments.
Users can include an optional <code class="docutils literal notranslate"><span class="pre">range</span></code> field in segment descriptions
to specify which bytes from the underlying object should be used for the
segment data. Only one range may be specified per segment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">etag</span></code> and <code class="docutils literal notranslate"><span class="pre">size_bytes</span></code> fields still describe the backing object
as a whole.</p>
</div>
<p>If a user uploads this manifest:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/con/obj_seg_1&quot;</span><span class="p">,</span> <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="mi">2097152</span><span class="p">,</span> <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="s2">&quot;0-1048576&quot;</span><span class="p">},</span>
 <span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/con/obj_seg_2&quot;</span><span class="p">,</span> <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="mi">2097152</span><span class="p">,</span>
  <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="s2">&quot;512-1550000&quot;</span><span class="p">},</span>
 <span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/con/obj_seg_1&quot;</span><span class="p">,</span> <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="mi">2097152</span><span class="p">,</span> <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="s2">&quot;-2048&quot;</span><span class="p">}]</span>
</pre></div>
</div>
<p>The segment will consist of the first 1048576 bytes of /con/obj_seg_1,
followed by bytes 513 through 1550000 (inclusive) of /con/obj_seg_2, and
finally bytes 2095104 through 2097152 (i.e., the last 2048 bytes) of
/con/obj_seg_1.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The minimum sized range is 1 byte. This is the same as the minimum
segment size.</p>
</div>
</section>
<section id="inline-data-specification">
<h3>Inline Data Specification<a class="headerlink" href="#inline-data-specification" title="Permalink to this heading">¶</a></h3>
<p>When uploading a manifest, users can include ‘data’ segments that should
be included along with objects. The data in these segments must be
base64-encoded binary data and will be included in the etag of the
resulting large object exactly as if that data had been uploaded and
referenced as separate objects.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This feature is primarily aimed at reducing the need for storing
many tiny objects, and as such any supplied data must fit within
the maximum manifest size (default is 8MiB). This maximum size
can be configured via <code class="docutils literal notranslate"><span class="pre">max_manifest_size</span></code> in proxy-server.conf.</p>
</div>
</section>
<section id="retrieving-a-large-object">
<h3>Retrieving a Large Object<a class="headerlink" href="#retrieving-a-large-object" title="Permalink to this heading">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">GET</span></code> request to the manifest object will return the concatenation of the
objects from the manifest much like DLO. If any of the segments from the
manifest are not found or their <code class="docutils literal notranslate"><span class="pre">Etag</span></code>/<code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> have changed since
upload, the connection will drop. In this case a <code class="docutils literal notranslate"><span class="pre">409</span> <span class="pre">Conflict</span></code> will be
logged in the proxy logs and the user will receive incomplete results. Note
that this will be enforced regardless of whether the user performed per-segment
validation during upload.</p>
<p>The headers from this <code class="docutils literal notranslate"><span class="pre">GET</span></code> or <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> request will return the metadata
attached to the manifest object itself with some exceptions:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Header</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Content-Length</p></td>
<td><p>the total size of the SLO (the sum of the sizes of
the segments in the manifest)</p></td>
</tr>
<tr class="row-odd"><td><p>X-Static-Large-Object</p></td>
<td><p>the string “True”</p></td>
</tr>
<tr class="row-even"><td><p>Etag</p></td>
<td><p>the etag of the SLO (generated the same way as DLO)</p></td>
</tr>
</tbody>
</table>
<p>A <code class="docutils literal notranslate"><span class="pre">GET</span></code> request with the query parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>?multipart-manifest=get
</pre></div>
</div>
<p>will return a transformed version of the original manifest, containing
additional fields and different key names. For example, the first manifest in
the example above would look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;/cont/object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;hash&quot;</span><span class="p">:</span> <span class="s2">&quot;etagoftheobjectsegment&quot;</span><span class="p">,</span>
  <span class="s2">&quot;bytes&quot;</span><span class="p">:</span> <span class="mi">10485760</span><span class="p">,</span>
  <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="s2">&quot;1048576-2097151&quot;</span><span class="p">},</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>As you can see, some of the fields are renamed compared to the put request:
<em>path</em> is <em>name</em>, <em>etag</em> is <em>hash</em>, <em>size_bytes</em> is <em>bytes</em>.  The <em>range</em> field
remains the same (if present).</p>
<p>A GET request with the query parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>?multipart-manifest=get&amp;format=raw
</pre></div>
</div>
<p>will return the contents of the original manifest as it was sent by the client.
The main purpose for both calls is solely debugging.</p>
<p>When the manifest object is uploaded you are more or less guaranteed that
every segment in the manifest exists and matched the specifications.
However, there is nothing that prevents the user from breaking the
SLO download by deleting/replacing a segment referenced in the manifest. It is
left to the user to use caution in handling the segments.</p>
</section>
<section id="deleting-a-large-object">
<h3>Deleting a Large Object<a class="headerlink" href="#deleting-a-large-object" title="Permalink to this heading">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> request will just delete the manifest object itself. The segment
data referenced by the manifest will remain unchanged.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> with a query parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>?multipart-manifest=delete
</pre></div>
</div>
<p>will delete all the segments referenced in the manifest and then the manifest
itself. The failure response will be similar to the bulk delete middleware.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> with the query parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>?multipart-manifest=delete&amp;async=yes
</pre></div>
</div>
<p>will schedule all the segments referenced in the manifest to be deleted
asynchronously and then delete the manifest itself. Note that segments will
continue to appear in listings and be counted for quotas until they are
cleaned up by the object-expirer. This option is only available when all
segments are in the same container and none of them are nested SLOs.</p>
</section>
<section id="modifying-a-large-object">
<h3>Modifying a Large Object<a class="headerlink" href="#modifying-a-large-object" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">PUT</span></code> and <code class="docutils literal notranslate"><span class="pre">POST</span></code> requests will work as expected; <code class="docutils literal notranslate"><span class="pre">PUT</span></code>s will just
overwrite the manifest object for example.</p>
</section>
<section id="container-listings">
<h3>Container Listings<a class="headerlink" href="#container-listings" title="Permalink to this heading">¶</a></h3>
<p>In a container listing the size listed for SLO manifest objects will be the
<code class="docutils literal notranslate"><span class="pre">total_size</span></code> of the concatenated segments in the manifest. The overall
<code class="docutils literal notranslate"><span class="pre">X-Container-Bytes-Used</span></code> for the container (and subsequently for the account)
will not reflect <code class="docutils literal notranslate"><span class="pre">total_size</span></code> of the manifest but the actual size of the JSON
data stored. The reason for this somewhat confusing discrepancy is we want the
container listing to reflect the size of the manifest object when it is
downloaded. We do not, however, want to count the bytes-used twice (for both
the manifest and the segments it’s referring to) in the container and account
metadata which can be used for stats and billing purposes.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.slo.SloGetContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.slo.</span></span><span class="sig-name descname"><span class="pre">SloGetContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slo</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.slo.SloGetContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.wsgi.WSGIContext" title="swift.common.wsgi.WSGIContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIContext</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.slo.SloGetContext.convert_segment_listing">
<span class="sig-name descname"><span class="pre">convert_segment_listing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resp_headers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resp_iter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.slo.SloGetContext.convert_segment_listing" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the manifest data to match with the format
that was put in through ?multipart-manifest=put</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resp_headers</strong> – response headers</p></li>
<li><p><strong>resp_iter</strong> – a response iterable</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.slo.SloGetContext.handle_slo_get_or_head">
<span class="sig-name descname"><span class="pre">handle_slo_get_or_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.slo.SloGetContext.handle_slo_get_or_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a request and a start_response callable and does the normal WSGI
thing with them. Returns an iterator suitable for sending up the WSGI
chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> object; is a <code class="docutils literal notranslate"><span class="pre">GET</span></code> or
<code class="docutils literal notranslate"><span class="pre">HEAD</span></code> request aimed at what may (or may not) be a static
large object manifest.</p></li>
<li><p><strong>start_response</strong> – WSGI start_response callable</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.slo.StaticLargeObject">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.slo.</span></span><span class="sig-name descname"><span class="pre">StaticLargeObject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_manifest_segments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_manifest_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8388608</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yield_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_async_delete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.slo.StaticLargeObject" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>StaticLargeObject Middleware</p>
<p>See above for a full description.</p>
<p>The proxy logs created for any subrequests made will have swift.source set
to “SLO”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> – The next WSGI filter or app in the paste.deploy chain.</p></li>
<li><p><strong>conf</strong> – The configuration dict for the middleware.</p></li>
<li><p><strong>max_manifest_segments</strong> – The maximum number of segments allowed in
newly-created static large objects.</p></li>
<li><p><strong>max_manifest_size</strong> – The maximum size (in bytes) of newly-created
static-large-object manifests.</p></li>
<li><p><strong>yield_frequency</strong> – If the client included <code class="docutils literal notranslate"><span class="pre">heartbeat=on</span></code> in the
query parameters when creating a new static large
object, the period of time to wait between sending
whitespace to keep the connection alive.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.slo.StaticLargeObject.get_segments_to_delete_iter">
<span class="sig-name descname"><span class="pre">get_segments_to_delete_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.slo.StaticLargeObject.get_segments_to_delete_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>A generator function to be used to delete all the segments and
sub-segments referenced in a manifest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> – a <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> with an SLO manifest
in path</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>HTTPPreconditionFailed</strong> – on invalid UTF8 in request path</p></li>
<li><p><strong>HTTPBadRequest</strong> – on too many buffered sub segments and
on invalid SLO manifest path</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.slo.StaticLargeObject.get_slo_segments">
<span class="sig-name descname"><span class="pre">get_slo_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.slo.StaticLargeObject.get_slo_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> and returns the SLO
manifest’s segments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj_name</strong> – the name of the object being deleted,
as <code class="docutils literal notranslate"><span class="pre">/container/object</span></code></p></li>
<li><p><strong>req</strong> – the base <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>HTTPServerError</strong> – on unable to load obj_name or
on unable to load the SLO manifest data.</p></li>
<li><p><strong>HTTPBadRequest</strong> – on not an SLO manifest</p></li>
<li><p><strong>HTTPNotFound</strong> – on SLO manifest not found</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>SLO manifest’s segments</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.slo.StaticLargeObject.handle_multipart_delete">
<span class="sig-name descname"><span class="pre">handle_multipart_delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.slo.StaticLargeObject.handle_multipart_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Will delete all the segments in the SLO manifest and then, if
successful, will delete the manifest file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> – a <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> with an obj in path</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>swob.Response whose app_iter set to Bulk.handle_delete_iter</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.slo.StaticLargeObject.handle_multipart_get_or_head">
<span class="sig-name descname"><span class="pre">handle_multipart_get_or_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.slo.StaticLargeObject.handle_multipart_get_or_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles the GET or HEAD of a SLO manifest.</p>
<p>The response body (only on GET, of course) will consist of the
concatenation of the segments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – a <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> with a path
referencing an object</p></li>
<li><p><strong>start_response</strong> – WSGI start_response callable</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>HttpException</strong> – on errors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.slo.StaticLargeObject.handle_multipart_put">
<span class="sig-name descname"><span class="pre">handle_multipart_put</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.slo.StaticLargeObject.handle_multipart_put" title="Permalink to this definition">¶</a></dt>
<dd><p>Will handle the PUT of a SLO manifest.
Heads every object in manifest to check if is valid and if so will
save a manifest generated from the user input. Uses WSGIContext to
call self and start_response and returns a WSGI iterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – a <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> with an obj in path</p></li>
<li><p><strong>start_response</strong> – WSGI start_response callable</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>HttpException</strong> – on errors</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.slo.parse_and_validate_input">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.slo.</span></span><span class="sig-name descname"><span class="pre">parse_and_validate_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req_body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">req_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.slo.parse_and_validate_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a request body, parses it and returns a list of dictionaries.</p>
<p>The output structure is nearly the same as the input structure, but it
is not an exact copy. Given a valid object-backed input dictionary
<code class="docutils literal notranslate"><span class="pre">d_in</span></code>, its corresponding output dictionary <code class="docutils literal notranslate"><span class="pre">d_out</span></code> will be as follows:</p>
<ul class="simple">
<li><p>d_out[‘etag’] == d_in[‘etag’]</p></li>
<li><p>d_out[‘path’] == d_in[‘path’]</p></li>
<li><p>d_in[‘size_bytes’] can be a string (“12”) or an integer (12), but
d_out[‘size_bytes’] is an integer.</p></li>
<li><p>(optional) d_in[‘range’] is a string of the form “M-N”, “M-”, or
“-N”, where M and N are non-negative integers. d_out[‘range’] is the
corresponding swob.Range object. If d_in does not have a key
‘range’, neither will d_out.</p></li>
</ul>
<p>Inlined data dictionaries will have any extraneous padding stripped.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p>HTTPException on parse errors or semantic errors (e.g. bogus
JSON structure, syntactically invalid ranges)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of dictionaries on success</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id3">
<h2>Direct API<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<p>SLO support centers around the user generated manifest file. After the user
has uploaded the segments into their account a manifest file needs to be
built and uploaded. All object segments, must be at least 1 byte
in size. Please see the SLO docs for <a class="reference internal" href="#slo-doc"><span class="std std-ref">Static Large Objects</span></a> further
details.</p>
</section>
<section id="additional-notes">
<h2>Additional Notes<a class="headerlink" href="#additional-notes" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>With a <code class="docutils literal notranslate"><span class="pre">GET</span></code> or <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> of a manifest file, the <code class="docutils literal notranslate"><span class="pre">X-Object-Manifest:</span>
<span class="pre">&lt;container&gt;/&lt;prefix&gt;</span></code> header will be returned with the concatenated object
so you can tell where it’s getting its segments from.</p></li>
<li><p>When updating a manifest object using a POST request, a
<code class="docutils literal notranslate"><span class="pre">X-Object-Manifest</span></code> header must be included for the object to
continue to behave as a manifest object.</p></li>
<li><p>The response’s <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> for a <code class="docutils literal notranslate"><span class="pre">GET</span></code> or <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> on the manifest
file will be the sum of all the segments in the <code class="docutils literal notranslate"><span class="pre">&lt;container&gt;/&lt;prefix&gt;</span></code>
listing, dynamically. So, uploading additional segments after the manifest is
created will cause the concatenated object to be that much larger; there’s no
need to recreate the manifest file.</p></li>
<li><p>The response’s <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> for a <code class="docutils literal notranslate"><span class="pre">GET</span></code> or <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> on the manifest
will be the same as the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> set during the <code class="docutils literal notranslate"><span class="pre">PUT</span></code> request that
created the manifest. You can easily change the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> by reissuing
the <code class="docutils literal notranslate"><span class="pre">PUT</span></code>.</p></li>
<li><p>The response’s <code class="docutils literal notranslate"><span class="pre">ETag</span></code> for a <code class="docutils literal notranslate"><span class="pre">GET</span></code> or <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> on the manifest file will
be the MD5 sum of the concatenated string of ETags for each of the segments
in the manifest (for DLO, from the listing <code class="docutils literal notranslate"><span class="pre">&lt;container&gt;/&lt;prefix&gt;</span></code>).
Usually in Swift the ETag is the MD5 sum of the contents of the object, and
that holds true for each segment independently. But it’s not meaningful to
generate such an ETag for the manifest itself so this method was chosen to
at least offer change detection.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using the container sync feature you will need to ensure both
your manifest file and your segment files are synced if they happen to be
in different containers.</p>
</div>
</section>
<section id="history">
<h2>History<a class="headerlink" href="#history" title="Permalink to this heading">¶</a></h2>
<p>Dynamic large object support has gone through various iterations before
settling on this implementation.</p>
<p>The primary factor driving the limitation of object size in Swift is
maintaining balance among the partitions of the ring.  To maintain an even
dispersion of disk usage throughout the cluster the obvious storage pattern
was to simply split larger objects into smaller segments, which could then be
glued together during a read.</p>
<p>Before the introduction of large object support some applications were already
splitting their uploads into segments and re-assembling them on the client
side after retrieving the individual pieces.  This design allowed the client
to support backup and archiving of large data sets, but was also frequently
employed to improve performance or reduce errors due to network interruption.
The major disadvantage of this method is that knowledge of the original
partitioning scheme is required to properly reassemble the object, which is
not practical for some use cases, such as CDN origination.</p>
<p>In order to eliminate any barrier to entry for clients wanting to store
objects larger than 5GB, initially we also prototyped fully transparent
support for large object uploads.  A fully transparent implementation would
support a larger max size by automatically splitting objects into segments
during upload within the proxy without any changes to the client API.  All
segments were completely hidden from the client API.</p>
<p>This solution introduced a number of challenging failure conditions into the
cluster, wouldn’t provide the client with any option to do parallel uploads,
and had no basis for a resume feature.  The transparent implementation was
deemed just too complex for the benefit.</p>
<p>The current “user manifest” design was chosen in order to provide a
transparent download of large objects to the client and still provide the
uploading client a clean API to support segmented uploads.</p>
<p>To meet an many use cases as possible Swift supports two types of large
object manifests. Dynamic and static large object manifests both support
the same idea of allowing the user to upload many segments to be later
downloaded as a single file.</p>
<p>Dynamic large objects rely on a container listing to provide the manifest.
This has the advantage of allowing the user to add/removes segments from the
manifest at any time. It has the disadvantage of relying on eventually
consistent container listings. All three copies of the container dbs must
be updated for a complete list to be guaranteed. Also, all segments must
be in a single container, which can limit concurrent upload speed.</p>
<p>Static large objects rely on a user provided manifest file. A user can
upload objects into multiple containers and then reference those objects
(segments) in a self generated manifest file. Future GETs to that file will
download the concatenation of the specified segments. This has the advantage of
being able to immediately download the complete object once the manifest has
been successfully PUT. Being able to upload segments into separate containers
also improves concurrent upload speed. It has the disadvantage that the
manifest is finalized once PUT. Any changes to it means it has to be replaced.</p>
<p>Between these two methods the user has great flexibility in how (s)he chooses
to upload and retrieve large objects to Swift. Swift does not, however, stop
the user from harming themselves. In both cases the segments are deletable by
the user at any time. If a segment was deleted by mistake, a dynamic large
object, having no way of knowing it was ever there, would happily ignore the
deleted file and the user will get an incomplete file. A static large object
would, when failing to retrieve the object specified in the manifest, drop the
connection and the user would receive partial results.</p>
</section>
</section>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="ratelimit.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Rate Limiting"></i></a>
          
          
            <a href="overview_global_cluster.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Global Clusters"></i></a>
          
          <a id="pdfLink2" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">this page last updated: 2016-08-17 00:54:09</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="https://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the
                 document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="OpenStack Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/id/">Bahasa Indonesia (Indonesian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/it/">Italiano (Italian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/tr_TR/">Türkçe (Türkiye)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Swift 0.1.0.dev10162</h4></a>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api/object_api_v1_overview.html">Object Storage API overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_architecture.html">Swift Architectural Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_ring.html">The Rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_policies.html">Storage Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_reaper.html">The Account Reaper</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_auth.html">The Auth System</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_acl.html">Access Control Lists (ACLs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_replication.html">Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="ratelimit.html">Rate Limiting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Large Object Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.dlo">Dynamic Large Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.slo">Static Large Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">Direct API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-notes">Additional Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#history">History</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview_global_cluster.html">Global Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_container_sync.html">Container to Container Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_expiring_objects.html">Expiring Object Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="cors.html">CORS</a></li>
<li class="toctree-l1"><a class="reference internal" href="crossdomain.html">Cross-domain Policy File</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_erasure_code.html">Erasure Code Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_encryption.html">Object Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_backing_store.html">Using Swift as Backing Store for Service Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_container_sharding.html">Container Sharding</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_background.html">Building a Consistent Hashing Ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_partpower.html">Modifying Ring Partition Power</a></li>
<li class="toctree-l1"><a class="reference internal" href="associated_projects.html">Associated Projects</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html">Contributing to OpenStack Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#swift-design-principles">Swift Design Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#recommended-workflow">Recommended workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#notes-on-testing">Notes on Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#ideas">Ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#community">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/review_guidelines.html">Review Guidelines</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development_guidelines.html">Development Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_saio.html">SAIO (Swift All In One)</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_contribution_swift.html">First Contribution to Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies_saio.html">Adding Storage Policies to an Existing SAIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_auth.html">Auth Server and Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_middleware.html">Middleware and Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_ondisk_backends.html">Pluggable On-Disk Back-end APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_watchers.html">Auditor Watchers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deployment_guide.html">Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_deployment_guide.html">Apache Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin_guide.html">Administrator’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="replication_network.html">Dedicated replication network</a></li>
<li class="toctree-l1"><a class="reference internal" href="logs.html">Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops_runbook/index.html">Swift Ops Runbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin/index.html">OpenStack Swift Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="install/index.html">Object Storage Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="config/index.html">Configuration Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/object_api_v1_overview.html">Object Storage API overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/discoverability.html">Discoverability</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/container_quotas.html">Container quotas</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/object_versioning.html">Object versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/large_objects.html">Large objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/temporary_url_middleware.html">Temporary URL middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/form_post_middleware.html">Form POST middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/use_content-encoding_metadata.html">Use Content-Encoding metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/use_the_content-disposition_metadata.html">Use the Content-Disposition metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pseudo-hierarchical-folders-directories.html">Pseudo-hierarchical folders and directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pagination.html">Page through large lists of containers or objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/serialized-response-formats.html">Serialized response formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/static-website.html">Create static website</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/object-expiration.html">Object expiration</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/bulk-delete.html">Bulk delete</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="s3_compat.html">S3/Swift REST API Comparison Matrix</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ring.html">Partitioned Consistent Hash Ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy.html">Proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="account.html">Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="container.html">Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="db.html">Account DB and Container DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="object.html">Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="middleware.html">Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="audit_watchers.html">Object Audit Watchers</a></li>
</ul>

    </div>

  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="local-table-of-contents">
      <h4 class="docs-sidebar-section-title">Page Contents</h4>
      <ul>
<li><a class="reference internal" href="#">Large Object Support</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#module-swift.common.middleware.dlo">Dynamic Large Objects</a><ul>
<li><a class="reference internal" href="#using-swift">Using <code class="docutils literal notranslate"><span class="pre">swift</span></code></a></li>
<li><a class="reference internal" href="#direct-api">Direct API</a></li>
<li><a class="reference internal" href="#swift.common.middleware.dlo.GetContext"><code class="docutils literal notranslate"><span class="pre">GetContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.dlo.GetContext.get_or_head_response"><code class="docutils literal notranslate"><span class="pre">GetContext.get_or_head_response()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.dlo.GetContext.handle_request"><code class="docutils literal notranslate"><span class="pre">GetContext.handle_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.slo">Static Large Objects</a><ul>
<li><a class="reference internal" href="#uploading-the-manifest">Uploading the Manifest</a></li>
<li><a class="reference internal" href="#range-specification">Range Specification</a></li>
<li><a class="reference internal" href="#inline-data-specification">Inline Data Specification</a></li>
<li><a class="reference internal" href="#retrieving-a-large-object">Retrieving a Large Object</a></li>
<li><a class="reference internal" href="#deleting-a-large-object">Deleting a Large Object</a></li>
<li><a class="reference internal" href="#modifying-a-large-object">Modifying a Large Object</a></li>
<li><a class="reference internal" href="#container-listings">Container Listings</a></li>
<li><a class="reference internal" href="#swift.common.middleware.slo.SloGetContext"><code class="docutils literal notranslate"><span class="pre">SloGetContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.slo.SloGetContext.convert_segment_listing"><code class="docutils literal notranslate"><span class="pre">SloGetContext.convert_segment_listing()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.slo.SloGetContext.handle_slo_get_or_head"><code class="docutils literal notranslate"><span class="pre">SloGetContext.handle_slo_get_or_head()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.slo.StaticLargeObject"><code class="docutils literal notranslate"><span class="pre">StaticLargeObject</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.slo.StaticLargeObject.get_segments_to_delete_iter"><code class="docutils literal notranslate"><span class="pre">StaticLargeObject.get_segments_to_delete_iter()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.slo.StaticLargeObject.get_slo_segments"><code class="docutils literal notranslate"><span class="pre">StaticLargeObject.get_slo_segments()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.slo.StaticLargeObject.handle_multipart_delete"><code class="docutils literal notranslate"><span class="pre">StaticLargeObject.handle_multipart_delete()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.slo.StaticLargeObject.handle_multipart_get_or_head"><code class="docutils literal notranslate"><span class="pre">StaticLargeObject.handle_multipart_get_or_head()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.slo.StaticLargeObject.handle_multipart_put"><code class="docutils literal notranslate"><span class="pre">StaticLargeObject.handle_multipart_put()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.slo.parse_and_validate_input"><code class="docutils literal notranslate"><span class="pre">parse_and_validate_input()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id3">Direct API</a></li>
<li><a class="reference internal" href="#additional-notes">Additional Notes</a></li>
<li><a class="reference internal" href="#history">History</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="https://openstack.org/projects/">Projects</a></li>
          <li><a href="https://www.openstack.org/software/security/">OpenStack Security</a></li>
          <li><a href="https://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="https://openstack.org/blog/">Blog</a></li>g
          <li><a href="https://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="https://openstack.org/community/">User Groups</a></li>
          <li><a href="https://openstack.org/community/events/">Events</a></li>
          <li><a href="https://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="https://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="https://docs.openstack.org/contributors">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="https://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="https://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="https://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="https://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="https://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="https://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="https://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-3.2.1.min.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- standard sphinx include libraries, which allow search highlighting -->
<script type="text/javascript" src="_static/underscore.js"></script>
<script type="text/javascript" src="_static/doctools.js"></script>
<script type="text/javascript" src="_static/searchtools.js"></script>
<script type="text/javascript" src="_static/language_data.js"></script>

<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.1.0.dev10162',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      LINK_SUFFIX: '.html',
      SOURCELINK_SUFFIX: '.txt',
      HAS_SOURCE:  true
    };
</script>

<!-- Javascript for page -->
<script language="JavaScript">
  /* Build a description of this page including SHA, source location on git
   * repo, build time and the project's launchpad bug tag. Set the HREF of the
   * bug buttons
   */
    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
    /* "giturl" is the URL of the source file on Git and is auto-generated by
     * openstackdocstheme.
     *
     * "pagename" is a standard sphinx parameter containing the name of
     * the source file, without extension.
     */

    var sourceFile = "overview_large_objects" + ".rst";
    gitURL = "Source: https://opendev.org/openstack/swift/src/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: c25d961319e59efe02c05374924ba82b873992e1";
    var repositoryName = "openstack/swift";
    var bugProject = "swift";
    var bugTitle = "Large Object Support in Swift";
    var fieldTags = "";
    var useStoryboard = "";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.1.0.dev10162 on 2016-08-17 00:54:09";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags, repositoryName, useStoryboard);
    var currentSourceFile = "overview_large_objects";
    var pdfFileName = "doc-swift.pdf";
    pdfLink(currentSourceFile, pdfFileName);
</script>


  </body>
</html>