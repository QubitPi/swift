
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Deployment Guide &#8212; Swift 0.1.0.dev10162 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/basic.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="canonical" href="/openstack-swift/deployment_guide.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Apache Deployment Guide" href="apache_deployment_guide.html" />
    <link rel="prev" title="Auditor Watchers" href="development_watchers.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">

<!-- Search CSS -->
<link href="_static/css/search.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/pygments.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


  </head><body>

<!-- SOURCE_FILE: https://opendev.org/openstack/swift/src/doc/source/deployment_guide.rst -->

<script>
    (function (window, document) {
        var loader = function () {
            var script = document.createElement("script"), tag = document.getElementsByTagName("script")[0];
            script.src = "https://search.openstack.org/widget/embed.min.js?t="+Date.now();
            tag.parentNode.insertBefore(script, tag);
        };
        window.addEventListener ? window.addEventListener("load", loader, false) : window.attachEvent("onload", loader);
    })(window, document);
</script>

<nav class="navbar navbar-default" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="https://www.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</div>
      <ul class="nav navbar-nav navbar-main show">
        <li class="search-container-mobile">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</li>
        <li> <!--Software -->
          <a href="https://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/openstack-components">OpenStack Components</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/sdks">SDKs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/deployment-tools">Deployment Tools</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/assets/software/projectmap/openstack-map.pdf" target="_blank">OpenStack Map</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
          </ul>
        </li>
        <li> <!-- Use Cases -->
          <a href="https://www.openstack.org/use-cases/" class="drop" id="dropdownMenuUsers">Use Cases <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/">Users in Production</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/bare-metal/">Ironic Bare Metal</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/edge-computing/">Edge Computing</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/telecoms-and-nfv/">Telecom & NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/science/">Science and HPC</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/containers/">Containers</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/enterprise/">Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li> <!-- Events -->
          <a href="https://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">Open Infrastructure Summits</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/ptg/">Project Teams Gathering</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/opendev-2020/">OpenDev</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/community-events/">Community Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/openstackdays">OpenStack & OpenInfra Days</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
          </ul>
        </li>
        <li><!-- Community -->
          <a href="https://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/tech-committee">OpenStack Technical Committee</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/coa/">Get Certified (COA)</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketing/">Marketing Resources</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/news/">Community News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/supporting-organizations/">OpenInfra Foundation Supporting Organizations</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">Open Infrastructure Foundation (OpenInfra Foundation)</a></li>
          </ul>
        </li>
        <li><!-- Marketplace -->
          <a href="https://www.openstack.orgmarketplace/" class="drop" id="dropdownMenuLearn">Marketplace <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/distros/">Distros & Appliances</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/public-clouds/">Public Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/hosted-private-clouds/">Hosted Private Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/remotely-managed-private-clouds/">Remotely Managed Private Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/consulting/">Consulting & Integrators</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/drivers/">Drivers</a></li>
          </ul>
        </li>
        <li><!-- Blog -->
          <a href="https://www.openstack.org/blog/">Blog</a>
        </li>
        <li><!-- Docs -->
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
        <li> <!-- Join -->
            <li class="join-nav-section">
              <a href="https://openinfra.dev/join/" id="dropdownMenuJoin">Join <i class="fa fa-caret-down"></i></a>
              <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuJoin" style="display: none;">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sign up for Foundation Membership</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sponsor the Foundation</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">More about the Foundation</a></li>
              </ul>
            </li>
            <li>
              <a href="https://www.openstack.org/Security/login/?BackURL=/home/" class="sign-in-btn">Log In</a>
            </li>
        </li>
      </ul>
    </div>
  </div>
  <!-- /.container -->
</nav>

    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row docs-title">
  <div class="col-lg-8">
      <h1>Deployment Guide</h1>
    
  </div>
  <div class="docs-actions">
    
    <a href="development_watchers.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Auditor Watchers"></i></a>
    
    
    <a href="apache_deployment_guide.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Apache Deployment Guide"></i></a>
    
    <a id="pdfLink1" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
    
  </div>
</div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-body" role="main">

  <section id="deployment-guide">
<h1>Deployment Guide<a class="headerlink" href="#deployment-guide" title="Permalink to this heading">¶</a></h1>
<p>This document provides general guidance for deploying and configuring Swift.
Detailed descriptions of configuration options can be found in the
<a class="reference internal" href="config/index.html"><span class="doc">configuration documentation</span></a>.</p>
<section id="hardware-considerations">
<h2>Hardware Considerations<a class="headerlink" href="#hardware-considerations" title="Permalink to this heading">¶</a></h2>
<p>Swift is designed to run on commodity hardware. RAID on the storage drives is
not required and not recommended. Swift’s disk usage pattern is the worst case
possible for RAID, and performance degrades very quickly using RAID 5 or 6.</p>
</section>
<section id="deployment-options">
<h2>Deployment Options<a class="headerlink" href="#deployment-options" title="Permalink to this heading">¶</a></h2>
<p>The Swift services run completely autonomously, which provides for a lot of
flexibility when architecting the hardware deployment for Swift. The 4 main
services are:</p>
<ol class="arabic simple">
<li><p>Proxy Services</p></li>
<li><p>Object Services</p></li>
<li><p>Container Services</p></li>
<li><p>Account Services</p></li>
</ol>
<p>The Proxy Services are more CPU and network I/O intensive. If you are using
10g networking to the proxy, or are terminating SSL traffic at the proxy,
greater CPU power will be required.</p>
<p>The Object, Container, and Account Services (Storage Services) are more disk
and network I/O intensive.</p>
<p>The easiest deployment is to install all services on each server. There is
nothing wrong with doing this, as it scales each service out horizontally.</p>
<p>Alternatively, one set of servers may be dedicated to the Proxy Services and a
different set of servers dedicated to the Storage Services. This allows faster
networking to be configured to the proxy than the storage servers, and keeps
load balancing to the proxies more manageable.  Storage Services scale out
horizontally as storage servers are added, and the overall API throughput can
be scaled by adding more proxies.</p>
<p>If you need more throughput to either Account or Container Services, they may
each be deployed to their own servers. For example you might use faster (but
more expensive) SAS or even SSD drives to get faster disk I/O to the databases.</p>
<p>A high-availability (HA) deployment of Swift requires that multiple proxy
servers are deployed and requests are load-balanced between them. Each proxy
server instance is stateless and able to respond to requests for the entire
cluster.</p>
<p>Load balancing and network design is left as an exercise to the reader,
but this is a very important part of the cluster, so time should be spent
designing the network for a Swift cluster.</p>
</section>
<section id="web-front-end-options">
<h2>Web Front End Options<a class="headerlink" href="#web-front-end-options" title="Permalink to this heading">¶</a></h2>
<p>Swift comes with an integral web front end. However, it can also be deployed
as a request processor of an Apache2 using mod_wsgi as described in
<a class="reference internal" href="apache_deployment_guide.html"><span class="doc">Apache Deployment Guide</span></a>.</p>
</section>
<section id="preparing-the-ring">
<span id="ring-preparing"></span><h2>Preparing the Ring<a class="headerlink" href="#preparing-the-ring" title="Permalink to this heading">¶</a></h2>
<p>The first step is to determine the number of partitions that will be in the
ring. We recommend that there be a minimum of 100 partitions per drive to
insure even distribution across the drives. A good starting point might be
to figure out the maximum number of drives the cluster will contain, and then
multiply by 100, and then round up to the nearest power of two.</p>
<p>For example, imagine we are building a cluster that will have no more than
5,000 drives. That would mean that we would have a total number of 500,000
partitions, which is pretty close to 2^19, rounded up.</p>
<p>It is also a good idea to keep the number of partitions small (relatively).
The more partitions there are, the more work that has to be done by the
replicators and other backend jobs and the more memory the rings consume in
process. The goal is to find a good balance between small rings and maximum
cluster size.</p>
<p>The next step is to determine the number of replicas to store of the data.
Currently it is recommended to use 3 (as this is the only value that has
been tested). The higher the number, the more storage that is used but the
less likely you are to lose data.</p>
<p>It is also important to determine how many zones the cluster should have. It is
recommended to start with a minimum of 5 zones. You can start with fewer, but
our testing has shown that having at least five zones is optimal when failures
occur. We also recommend trying to configure the zones at as high a level as
possible to create as much isolation as possible. Some example things to take
into consideration can include physical location, power availability, and
network connectivity. For example, in a small cluster you might decide to
split the zones up by cabinet, with each cabinet having its own power and
network connectivity. The zone concept is very abstract, so feel free to use
it in whatever way best isolates your data from failure. Each zone exists
in a region.</p>
<p>A region is also an abstract concept that may be used to distinguish between
geographically separated areas as well as can be used within same datacenter.
Regions and zones are referenced by a positive integer.</p>
<p>You can now start building the ring with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span><span class="o">-</span><span class="n">ring</span><span class="o">-</span><span class="n">builder</span> <span class="o">&lt;</span><span class="n">builder_file</span><span class="o">&gt;</span> <span class="n">create</span> <span class="o">&lt;</span><span class="n">part_power</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">replicas</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">min_part_hours</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This will start the ring build process creating the &lt;builder_file&gt; with
2^&lt;part_power&gt; partitions. &lt;min_part_hours&gt; is the time in hours before a
specific partition can be moved in succession (24 is a good value for this).</p>
<p>Devices can be added to the ring with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span><span class="o">-</span><span class="n">ring</span><span class="o">-</span><span class="n">builder</span> <span class="o">&lt;</span><span class="n">builder_file</span><span class="o">&gt;</span> <span class="n">add</span> <span class="n">r</span><span class="o">&lt;</span><span class="n">region</span><span class="o">&gt;</span><span class="n">z</span><span class="o">&lt;</span><span class="n">zone</span><span class="o">&gt;-&lt;</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;/&lt;</span><span class="n">device_name</span><span class="o">&gt;</span><span class="n">_</span><span class="o">&lt;</span><span class="n">meta</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">weight</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This will add a device to the ring where &lt;builder_file&gt; is the name of the
builder file that was created previously, &lt;region&gt; is the number of the region
the zone is in, &lt;zone&gt; is the number of the zone this device is in, &lt;ip&gt; is
the ip address of the server the device is in, &lt;port&gt; is the port number that
the server is running on, &lt;device_name&gt; is the name of the device on the server
(for example: sdb1), &lt;meta&gt; is a string of metadata for the device (optional),
and &lt;weight&gt; is a float weight that determines how many partitions are put on
the device relative to the rest of the devices in the cluster (a good starting
point is 100.0 x TB on the drive).Add each device that will be initially in the
cluster.</p>
<p>Once all of the devices are added to the ring, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span><span class="o">-</span><span class="n">ring</span><span class="o">-</span><span class="n">builder</span> <span class="o">&lt;</span><span class="n">builder_file</span><span class="o">&gt;</span> <span class="n">rebalance</span>
</pre></div>
</div>
<p>This will distribute the partitions across the drives in the ring. It is
important whenever making changes to the ring to make all the changes
required before running rebalance. This will ensure that the ring stays as
balanced as possible, and as few partitions are moved as possible.</p>
<p>The above process should be done to make a ring for each storage service
(Account, Container and Object). The builder files will be needed in future
changes to the ring, so it is very important that these be kept and backed up.
The resulting .tar.gz ring file should be pushed to all of the servers in the
cluster. For more information about building rings, running
swift-ring-builder with no options will display help text with available
commands and options. More information on how the ring works internally
can be found in the <a class="reference internal" href="overview_ring.html"><span class="doc">Ring Overview</span></a>.</p>
</section>
<section id="running-object-servers-per-disk">
<span id="server-per-port-configuration"></span><h2>Running object-servers Per Disk<a class="headerlink" href="#running-object-servers-per-disk" title="Permalink to this heading">¶</a></h2>
<p>The lack of true asynchronous file I/O on Linux leaves the object-server
workers vulnerable to misbehaving disks.  Because any object-server worker can
service a request for any disk, and a slow I/O request blocks the eventlet hub,
a single slow disk can impair an entire storage node.  This also prevents
object servers from fully utilizing all their disks during heavy load.</p>
<p>Another way to get full I/O isolation is to give each disk on a storage node a
different port in the storage policy rings.  Then set the
<a class="reference internal" href="config/object_server_config.html#object-server-default-options"><span class="std std-ref">servers_per_port</span></a>
option in the object-server config.  NOTE: while the purpose of this config
setting is to run one or more object-server worker processes per <em>disk</em>, the
implementation just runs object-servers per unique port of local devices in the
rings.  The deployer must combine this option with appropriately-configured
rings to benefit from this feature.</p>
<p>Here’s an example (abbreviated) old-style ring (2 node cluster with 2 disks
each):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Devices</span><span class="p">:</span>    <span class="nb">id</span>  <span class="n">region</span>  <span class="n">zone</span>      <span class="n">ip</span> <span class="n">address</span>  <span class="n">port</span>  <span class="n">replication</span> <span class="n">ip</span>  <span class="n">replication</span> <span class="n">port</span>      <span class="n">name</span>
             <span class="mi">0</span>       <span class="mi">1</span>     <span class="mi">1</span>       <span class="mf">1.1.0.1</span>    <span class="mi">6200</span>       <span class="mf">1.1.0.1</span>                <span class="mi">6200</span>      <span class="n">d1</span>
             <span class="mi">1</span>       <span class="mi">1</span>     <span class="mi">1</span>       <span class="mf">1.1.0.1</span>    <span class="mi">6200</span>       <span class="mf">1.1.0.1</span>                <span class="mi">6200</span>      <span class="n">d2</span>
             <span class="mi">2</span>       <span class="mi">1</span>     <span class="mi">2</span>       <span class="mf">1.1.0.2</span>    <span class="mi">6200</span>       <span class="mf">1.1.0.2</span>                <span class="mi">6200</span>      <span class="n">d3</span>
             <span class="mi">3</span>       <span class="mi">1</span>     <span class="mi">2</span>       <span class="mf">1.1.0.2</span>    <span class="mi">6200</span>       <span class="mf">1.1.0.2</span>                <span class="mi">6200</span>      <span class="n">d4</span>
</pre></div>
</div>
<p>And here’s the same ring set up for <code class="docutils literal notranslate"><span class="pre">servers_per_port</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Devices</span><span class="p">:</span>    <span class="nb">id</span>  <span class="n">region</span>  <span class="n">zone</span>      <span class="n">ip</span> <span class="n">address</span>  <span class="n">port</span>  <span class="n">replication</span> <span class="n">ip</span>  <span class="n">replication</span> <span class="n">port</span>      <span class="n">name</span>
             <span class="mi">0</span>       <span class="mi">1</span>     <span class="mi">1</span>       <span class="mf">1.1.0.1</span>    <span class="mi">6200</span>       <span class="mf">1.1.0.1</span>                <span class="mi">6200</span>      <span class="n">d1</span>
             <span class="mi">1</span>       <span class="mi">1</span>     <span class="mi">1</span>       <span class="mf">1.1.0.1</span>    <span class="mi">6201</span>       <span class="mf">1.1.0.1</span>                <span class="mi">6201</span>      <span class="n">d2</span>
             <span class="mi">2</span>       <span class="mi">1</span>     <span class="mi">2</span>       <span class="mf">1.1.0.2</span>    <span class="mi">6200</span>       <span class="mf">1.1.0.2</span>                <span class="mi">6200</span>      <span class="n">d3</span>
             <span class="mi">3</span>       <span class="mi">1</span>     <span class="mi">2</span>       <span class="mf">1.1.0.2</span>    <span class="mi">6201</span>       <span class="mf">1.1.0.2</span>                <span class="mi">6201</span>      <span class="n">d4</span>
</pre></div>
</div>
<p>When migrating from normal to <code class="docutils literal notranslate"><span class="pre">servers_per_port</span></code>, perform these steps in order:</p>
<ol class="arabic simple">
<li><p>Upgrade Swift code to a version capable of doing <code class="docutils literal notranslate"><span class="pre">servers_per_port</span></code>.</p></li>
<li><p>Enable <code class="docutils literal notranslate"><span class="pre">servers_per_port</span></code> with a value greater than zero.</p></li>
<li><p>Restart <code class="docutils literal notranslate"><span class="pre">swift-object-server</span></code> processes with a SIGHUP.  At this point, you
will have the <code class="docutils literal notranslate"><span class="pre">servers_per_port</span></code> number of <code class="docutils literal notranslate"><span class="pre">swift-object-server</span></code> processes
serving all requests for all disks on each node.  This preserves
availability, but you should perform the next step as quickly as possible.</p></li>
<li><p>Push out new rings that actually have different ports per disk on each
server.  One of the ports in the new ring should be the same as the port
used in the old ring (“6200” in the example above).  This will cover
existing proxy-server processes who haven’t loaded the new ring yet.  They
can still talk to any storage node regardless of whether or not that
storage node has loaded the ring and started object-server processes on the
new ports.</p></li>
</ol>
<p>If you do not run a separate object-server for replication, then this setting
must be available to the object-replicator and object-reconstructor (i.e.
appear in the [DEFAULT] config section).</p>
</section>
<section id="general-service-configuration">
<span id="id1"></span><h2>General Service Configuration<a class="headerlink" href="#general-service-configuration" title="Permalink to this heading">¶</a></h2>
<p>Most Swift services fall into two categories.  Swift’s wsgi servers and
background daemons.</p>
<p>For more information specific to the configuration of Swift’s wsgi servers
with paste deploy see <a class="reference internal" href="#general-server-configuration"><span class="std std-ref">General Server Configuration</span></a>.</p>
<p>Configuration for servers and daemons can be expressed together in the same
file for each type of server, or separately.  If a required section for the
service trying to start is missing there will be an error.  The sections not
used by the service are ignored.</p>
<p>Consider the example of an object storage node.  By convention, configuration
for the object-server, object-updater, object-replicator, object-auditor, and
object-reconstructor exist in a single file <code class="docutils literal notranslate"><span class="pre">/etc/swift/object-server.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">DEFAULT</span><span class="p">]</span>
<span class="n">reclaim_age</span> <span class="o">=</span> <span class="mi">604800</span>

<span class="p">[</span><span class="n">pipeline</span><span class="p">:</span><span class="n">main</span><span class="p">]</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="nb">object</span><span class="o">-</span><span class="n">server</span>

<span class="p">[</span><span class="n">app</span><span class="p">:</span><span class="nb">object</span><span class="o">-</span><span class="n">server</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#object</span>

<span class="p">[</span><span class="nb">object</span><span class="o">-</span><span class="n">replicator</span><span class="p">]</span>

<span class="p">[</span><span class="nb">object</span><span class="o">-</span><span class="n">updater</span><span class="p">]</span>

<span class="p">[</span><span class="nb">object</span><span class="o">-</span><span class="n">auditor</span><span class="p">]</span>
</pre></div>
</div>
<p>Swift services expect a configuration path as the first argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swift-object-auditor
Usage: swift-object-auditor CONFIG [options]

Error: missing config path argument
</pre></div>
</div>
<p>If you omit the object-auditor section this file could not be used as the
configuration path when starting the <code class="docutils literal notranslate"><span class="pre">swift-object-auditor</span></code> daemon:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swift-object-auditor /etc/swift/object-server.conf
Unable to find object-auditor config section in /etc/swift/object-server.conf
</pre></div>
</div>
<p>If the configuration path is a directory instead of a file all of the files in
the directory with the file extension “.conf” will be combined to generate the
configuration object which is delivered to the Swift service.  This is
referred to generally as “directory based configuration”.</p>
<p>Directory based configuration leverages ConfigParser’s native multi-file
support.  Files ending in “.conf” in the given directory are parsed in
lexicographical order.  Filenames starting with ‘.’ are ignored.  A mixture of
file and directory configuration paths is not supported - if the configuration
path is a file only that file will be parsed.</p>
<p>The Swift service management tool <code class="docutils literal notranslate"><span class="pre">swift-init</span></code> has adopted the convention of
looking for <code class="docutils literal notranslate"><span class="pre">/etc/swift/{type}-server.conf.d/</span></code> if the file
<code class="docutils literal notranslate"><span class="pre">/etc/swift/{type}-server.conf</span></code> file does not exist.</p>
<p>When using directory based configuration, if the same option under the same
section appears more than once in different files, the last value parsed is
said to override previous occurrences.  You can ensure proper override
precedence by prefixing the files in the configuration directory with
numerical values.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">swift</span><span class="o">/</span>
    <span class="n">default</span><span class="o">.</span><span class="n">base</span>
    <span class="nb">object</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span>
        <span class="mi">000</span><span class="n">_default</span><span class="o">.</span><span class="n">conf</span> <span class="o">-&gt;</span> <span class="o">../</span><span class="n">default</span><span class="o">.</span><span class="n">base</span>
        <span class="mi">001</span><span class="n">_default</span><span class="o">-</span><span class="n">override</span><span class="o">.</span><span class="n">conf</span>
        <span class="mi">010</span><span class="n">_server</span><span class="o">.</span><span class="n">conf</span>
        <span class="mi">020</span><span class="n">_replicator</span><span class="o">.</span><span class="n">conf</span>
        <span class="mi">030</span><span class="n">_updater</span><span class="o">.</span><span class="n">conf</span>
        <span class="mi">040</span><span class="n">_auditor</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
<p>You can inspect the resulting combined configuration object using the
<code class="docutils literal notranslate"><span class="pre">swift-config</span></code> command line tool</p>
</section>
<section id="general-server-configuration">
<span id="id2"></span><h2>General Server Configuration<a class="headerlink" href="#general-server-configuration" title="Permalink to this heading">¶</a></h2>
<p>Swift uses paste.deploy (<a class="reference external" href="https://pypi.org/project/Paste/">https://pypi.org/project/Paste/</a>) to manage server
configurations. Detailed descriptions of configuration options can be found in
the <a class="reference internal" href="config/index.html"><span class="doc">configuration documentation</span></a>.</p>
<p>Default configuration options are set in the <code class="docutils literal notranslate"><span class="pre">[DEFAULT]</span></code> section, and any
options specified there can be overridden in any of the other sections BUT
ONLY BY USING THE SYNTAX <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">option_name</span> <span class="pre">=</span> <span class="pre">value</span></code>. This is the unfortunate
way paste.deploy works and I’ll try to explain it in full.</p>
<p>First, here’s an example paste.deploy configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">DEFAULT</span><span class="p">]</span>
<span class="n">name1</span> <span class="o">=</span> <span class="n">globalvalue</span>
<span class="n">name2</span> <span class="o">=</span> <span class="n">globalvalue</span>
<span class="n">name3</span> <span class="o">=</span> <span class="n">globalvalue</span>
<span class="nb">set</span> <span class="n">name4</span> <span class="o">=</span> <span class="n">globalvalue</span>

<span class="p">[</span><span class="n">pipeline</span><span class="p">:</span><span class="n">main</span><span class="p">]</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">myapp</span>

<span class="p">[</span><span class="n">app</span><span class="p">:</span><span class="n">myapp</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">mypkg</span><span class="c1">#myapp</span>
<span class="n">name2</span> <span class="o">=</span> <span class="n">localvalue</span>
<span class="nb">set</span> <span class="n">name3</span> <span class="o">=</span> <span class="n">localvalue</span>
<span class="nb">set</span> <span class="n">name5</span> <span class="o">=</span> <span class="n">localvalue</span>
<span class="n">name6</span> <span class="o">=</span> <span class="n">localvalue</span>
</pre></div>
</div>
<p>The resulting configuration that myapp receives is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">global</span> <span class="p">{</span><span class="s1">&#39;__file__&#39;</span><span class="p">:</span> <span class="s1">&#39;/etc/mypkg/wsgi.conf&#39;</span><span class="p">,</span> <span class="s1">&#39;here&#39;</span><span class="p">:</span> <span class="s1">&#39;/etc/mypkg&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name1&#39;</span><span class="p">:</span> <span class="s1">&#39;globalvalue&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name2&#39;</span><span class="p">:</span> <span class="s1">&#39;globalvalue&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name3&#39;</span><span class="p">:</span> <span class="s1">&#39;localvalue&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name4&#39;</span><span class="p">:</span> <span class="s1">&#39;globalvalue&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name5&#39;</span><span class="p">:</span> <span class="s1">&#39;localvalue&#39;</span><span class="p">,</span>
        <span class="s1">&#39;set name4&#39;</span><span class="p">:</span> <span class="s1">&#39;globalvalue&#39;</span><span class="p">}</span>
<span class="n">local</span> <span class="p">{</span><span class="s1">&#39;name6&#39;</span><span class="p">:</span> <span class="s1">&#39;localvalue&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>So, <code class="docutils literal notranslate"><span class="pre">name1</span></code> got the global value which is fine since it’s only in the <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code>
section anyway.</p>
<p><code class="docutils literal notranslate"><span class="pre">name2</span></code> got the global value from <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> even though it appears to be
overridden in the <code class="docutils literal notranslate"><span class="pre">app:myapp</span></code> subsection. This is just the unfortunate way
paste.deploy works (at least at the time of this writing.)</p>
<p><code class="docutils literal notranslate"><span class="pre">name3</span></code> got the local value from the <code class="docutils literal notranslate"><span class="pre">app:myapp</span></code> subsection because it is using
the special paste.deploy syntax of <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">option_name</span> <span class="pre">=</span> <span class="pre">value</span></code>. So, if you want
a default value for most app/filters but want to override it in one
subsection, this is how you do it.</p>
<p><code class="docutils literal notranslate"><span class="pre">name4</span></code> got the global value from <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> since it’s only in that section
anyway. But, since we used the <code class="docutils literal notranslate"><span class="pre">set</span></code> syntax in the <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> section even
though we shouldn’t, notice we also got a <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">name4</span></code> variable. Weird, but
probably not harmful.</p>
<p><code class="docutils literal notranslate"><span class="pre">name5</span></code> got the local value from the <code class="docutils literal notranslate"><span class="pre">app:myapp</span></code> subsection since it’s only
there anyway, but notice that it is in the global configuration and not the
local configuration. This is because we used the <code class="docutils literal notranslate"><span class="pre">set</span></code> syntax to set the
value. Again, weird, but not harmful since Swift just treats the two sets of
configuration values as one set anyway.</p>
<p><code class="docutils literal notranslate"><span class="pre">name6</span></code> got the local value from <code class="docutils literal notranslate"><span class="pre">app:myapp</span></code> subsection since it’s only there,
and since we didn’t use the <code class="docutils literal notranslate"><span class="pre">set</span></code> syntax, it’s only in the local
configuration and not the global one. Though, as indicated above, there is no
special distinction with Swift.</p>
<p>That’s quite an explanation for something that should be so much simpler, but
it might be important to know how paste.deploy interprets configuration files.
The main rule to remember when working with Swift configuration files is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">option_name</span> <span class="pre">=</span> <span class="pre">value</span></code> syntax in subsections if the option is
also set in the <code class="docutils literal notranslate"><span class="pre">[DEFAULT]</span></code> section. Don’t get in the habit of always
using the <code class="docutils literal notranslate"><span class="pre">set</span></code> syntax or you’ll probably mess up your non-paste.deploy
configuration files.</p>
</div>
<section id="per-policy-configuration">
<span id="proxy-server-per-policy-config"></span><h3>Per policy configuration<a class="headerlink" href="#per-policy-configuration" title="Permalink to this heading">¶</a></h3>
<p>Some proxy-server configuration options may be overridden for individual
<a class="reference internal" href="overview_policies.html"><span class="doc">Storage Policies</span></a> by including per-policy config section(s). These
options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sorting_method</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_affinity</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_affinity</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_affinity_node_count</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_affinity_handoff_delete_count</span></code></p></li>
</ul>
<p>The per-policy config section name must be of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">proxy</span><span class="o">-</span><span class="n">server</span><span class="p">:</span><span class="n">policy</span><span class="p">:</span><span class="o">&lt;</span><span class="n">policy</span> <span class="n">index</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The per-policy config section name should refer to the policy index, not
the policy name.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first part of proxy-server config section name must match the name of
the proxy-server config section. This is typically <code class="docutils literal notranslate"><span class="pre">proxy-server</span></code> as
shown above, but if different then the names of any per-policy config
sections must be changed accordingly.</p>
</div>
<p>The value of an option specified in a per-policy section will override any
value given in the proxy-server section for that policy only. Otherwise the
value of these options will be that specified in the proxy-server section.</p>
<p>For example, the following section provides policy-specific options for a
policy with index <code class="docutils literal notranslate"><span class="pre">3</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">proxy</span><span class="o">-</span><span class="n">server</span><span class="p">:</span><span class="n">policy</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">sorting_method</span> <span class="o">=</span> <span class="n">affinity</span>
<span class="n">read_affinity</span> <span class="o">=</span> <span class="n">r2</span><span class="o">=</span><span class="mi">1</span>
<span class="n">write_affinity</span> <span class="o">=</span> <span class="n">r2</span>
<span class="n">write_affinity_node_count</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">replicas</span>
<span class="n">write_affinity_handoff_delete_count</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended that per-policy config options are <em>not</em> included in the
<code class="docutils literal notranslate"><span class="pre">[DEFAULT]</span></code> section. If they are then the following behavior applies.</p>
<p>Per-policy config sections will inherit options in the <code class="docutils literal notranslate"><span class="pre">[DEFAULT]</span></code>
section of the config file, and any such inheritance will take precedence
over inheriting options from the proxy-server config section.</p>
<p>Per-policy config section options will override options in the
<code class="docutils literal notranslate"><span class="pre">[DEFAULT]</span></code> section. Unlike the behavior described under <a class="reference internal" href="#id2">General Server
Configuration</a> for paste-deploy <code class="docutils literal notranslate"><span class="pre">filter</span></code> and <code class="docutils literal notranslate"><span class="pre">app</span></code> sections, the
<code class="docutils literal notranslate"><span class="pre">set</span></code> keyword is not required for options to override in per-policy
config sections.</p>
<p>For example, given the following settings in a config file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">DEFAULT</span><span class="p">]</span>
<span class="n">sorting_method</span> <span class="o">=</span> <span class="n">affinity</span>
<span class="n">read_affinity</span> <span class="o">=</span> <span class="n">r0</span><span class="o">=</span><span class="mi">100</span>
<span class="n">write_affinity</span> <span class="o">=</span> <span class="n">r0</span>

<span class="p">[</span><span class="n">app</span><span class="p">:</span><span class="n">proxy</span><span class="o">-</span><span class="n">server</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#proxy</span>
<span class="c1"># use of set keyword here overrides [DEFAULT] option</span>
<span class="nb">set</span> <span class="n">read_affinity</span> <span class="o">=</span> <span class="n">r1</span><span class="o">=</span><span class="mi">100</span>
<span class="c1"># without set keyword, [DEFAULT] option overrides in a paste-deploy section</span>
<span class="n">write_affinity</span> <span class="o">=</span> <span class="n">r1</span>

<span class="p">[</span><span class="n">proxy</span><span class="o">-</span><span class="n">server</span><span class="p">:</span><span class="n">policy</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sorting_method</span> <span class="o">=</span> <span class="n">affinity</span>
<span class="c1"># set keyword not required here to override [DEFAULT] option</span>
<span class="n">write_affinity</span> <span class="o">=</span> <span class="n">r1</span>
</pre></div>
</div>
<p>would result in policy with index <code class="docutils literal notranslate"><span class="pre">0</span></code> having settings:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">read_affinity</span> <span class="pre">=</span> <span class="pre">r0=100</span></code> (inherited from the <code class="docutils literal notranslate"><span class="pre">[DEFAULT]</span></code> section)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_affinity</span> <span class="pre">=</span> <span class="pre">r1</span></code> (specified in the policy 0 section)</p></li>
</ul>
<p>and any other policy would have the default settings of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">read_affinity</span> <span class="pre">=</span> <span class="pre">r1=100</span></code> (set in the proxy-server section)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_affinity</span> <span class="pre">=</span> <span class="pre">r0</span></code> (inherited from the <code class="docutils literal notranslate"><span class="pre">[DEFAULT]</span></code> section)</p></li>
</ul>
</div>
</section>
<section id="proxy-middlewares">
<h3>Proxy Middlewares<a class="headerlink" href="#proxy-middlewares" title="Permalink to this heading">¶</a></h3>
<p>Many features in Swift are implemented as middleware in the proxy-server
pipeline. See <a class="reference internal" href="middleware.html"><span class="doc">Middleware</span></a> and the <code class="docutils literal notranslate"><span class="pre">proxy-server.conf-sample</span></code> file for
more information. In particular, the use of some type of <a class="reference internal" href="overview_auth.html"><span class="doc">authentication
and authorization middleware</span></a> is highly recommended.</p>
</section>
</section>
<section id="memcached-considerations">
<h2>Memcached Considerations<a class="headerlink" href="#memcached-considerations" title="Permalink to this heading">¶</a></h2>
<p>Several of the Services rely on Memcached for caching certain types of lookups,
such as auth tokens, and container/account existence.  Swift does not do any
caching of actual object data.  Memcached should be able to run on any servers
that have available RAM and CPU.  Typically Memcached is run on the proxy
servers.  The <code class="docutils literal notranslate"><span class="pre">memcache_servers</span></code> config option in the <code class="docutils literal notranslate"><span class="pre">proxy-server.conf</span></code>
should contain all memcached servers.</p>
<section id="shard-range-listing-cache">
<h3>Shard Range Listing Cache<a class="headerlink" href="#shard-range-listing-cache" title="Permalink to this heading">¶</a></h3>
<p>When a container gets <a class="reference internal" href="overview_container_sharding.html#sharding-doc"><span class="std std-ref">sharded</span></a> the root container will still be the
primary entry point to many container requests, as it provides the list of shards.
To take load off the root container Swift by default caches the list of shards returned.</p>
<p>As the number of shards for a root container grows to more than 3k the memcache default max
size of 1MB can be reached.</p>
<p>If you over-run your max configured memcache size you’ll see messages like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="n">setting</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">memcached</span><span class="p">:</span> <span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">11211</span><span class="p">:</span> <span class="n">SERVER_ERROR</span> <span class="nb">object</span> <span class="n">too</span> <span class="n">large</span> <span class="k">for</span> <span class="n">cache</span>
</pre></div>
</div>
<p>When you see these messages your root containers are getting hammered and
probably returning 503 reponses to clients.  Override the default 1MB limit to
5MB with something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">memcached</span> <span class="o">-</span><span class="n">I</span> <span class="mi">5000000</span> <span class="o">...</span>
</pre></div>
</div>
<p>Memcache has a <code class="docutils literal notranslate"><span class="pre">stats</span> <span class="pre">sizes</span></code> option that can point out the current size usage. As this
reaches the current max an increase might be in order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># telnet &lt;memcache server&gt; 11211</span>
<span class="o">&gt;</span> <span class="n">stats</span> <span class="n">sizes</span>
<span class="n">STAT</span> <span class="mi">160</span> <span class="mi">2</span>
<span class="n">STAT</span> <span class="mi">448</span> <span class="mi">1</span>
<span class="n">STAT</span> <span class="mi">576</span> <span class="mi">1</span>
<span class="n">END</span>
</pre></div>
</div>
</section>
</section>
<section id="system-time">
<h2>System Time<a class="headerlink" href="#system-time" title="Permalink to this heading">¶</a></h2>
<p>Time may be relative but it is relatively important for Swift!  Swift uses
timestamps to determine which is the most recent version of an object.
It is very important for the system time on each server in the cluster to
by synced as closely as possible (more so for the proxy server, but in general
it is a good idea for all the servers).  Typical deployments use NTP with a
local NTP server to ensure that the system times are as close as possible.
This should also be monitored to ensure that the times do not vary too much.</p>
</section>
<section id="general-service-tuning">
<span id="id3"></span><h2>General Service Tuning<a class="headerlink" href="#general-service-tuning" title="Permalink to this heading">¶</a></h2>
<p>Most services support either a <code class="docutils literal notranslate"><span class="pre">workers</span></code> or <code class="docutils literal notranslate"><span class="pre">concurrency</span></code> value in the
settings.  This allows the services to make effective use of the cores
available. A good starting point is to set the concurrency level for the proxy
and storage services to 2 times the number of cores available. If more than
one service is sharing a server, then some experimentation may be needed to
find the best balance.</p>
<p>For example, one operator reported using the following settings in a production
Swift cluster:</p>
<ul class="simple">
<li><p>Proxy servers have dual quad core processors (i.e. 8 cores); testing has
shown 16 workers to be a pretty good balance when saturating a 10g network
and gives good CPU utilization.</p></li>
<li><p>Storage server processes all run together on the same servers. These servers
have dual quad core processors, for 8 cores total. The Account, Container,
and Object servers are run with 8 workers each. Most of the background jobs
are run at a concurrency of 1, with the exception of the replicators which
are run at a concurrency of 2.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">max_clients</span></code> parameter can be used to adjust the number of client
requests an individual worker accepts for processing. The fewer requests being
processed at one time, the less likely a request that consumes the worker’s
CPU time, or blocks in the OS, will negatively impact other requests. The more
requests being processed at one time, the more likely one worker can utilize
network and disk capacity.</p>
<p>On systems that have more cores, and more memory, where one can afford to run
more workers, raising the number of workers and lowering the maximum number of
clients serviced per worker can lessen the impact of CPU intensive or stalled
requests.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">nice_priority</span></code> parameter can be used to set program scheduling priority.
The <code class="docutils literal notranslate"><span class="pre">ionice_class</span></code> and <code class="docutils literal notranslate"><span class="pre">ionice_priority</span></code> parameters can be used to set I/O scheduling
class and priority on the systems that use an I/O scheduler that supports
I/O priorities. As at kernel 2.6.17 the only such scheduler is the Completely
Fair Queuing (CFQ) I/O scheduler. If you run your Storage servers all together
on the same servers, you can slow down the auditors or prioritize
object-server I/O via these parameters (but probably do not need to change
it on the proxy). It is a new feature and the best practices are still
being developed. On some systems it may be required to run the daemons as root.
For more info also see setpriority(2) and ioprio_set(2).</p>
<p>The above configuration setting should be taken as suggestions and testing
of configuration settings should be done to ensure best utilization of CPU,
network connectivity, and disk I/O.</p>
</section>
<section id="filesystem-considerations">
<h2>Filesystem Considerations<a class="headerlink" href="#filesystem-considerations" title="Permalink to this heading">¶</a></h2>
<p>Swift is designed to be mostly filesystem agnostic–the only requirement
being that the filesystem supports extended attributes (xattrs). After
thorough testing with our use cases and hardware configurations, XFS was
the best all-around choice. If you decide to use a filesystem other than
XFS, we highly recommend thorough testing.</p>
<p>For distros with more recent kernels (for example Ubuntu 12.04 Precise),
we recommend using the default settings (including the default inode size
of 256 bytes) when creating the file system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkfs</span><span class="o">.</span><span class="n">xfs</span> <span class="o">-</span><span class="n">L</span> <span class="n">D1</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span>
</pre></div>
</div>
<p>In the last couple of years, XFS has made great improvements in how inodes
are allocated and used.  Using the default inode size no longer has an
impact on performance.</p>
<p>For distros with older kernels (for example Ubuntu 10.04 Lucid),
some settings can dramatically impact performance. We recommend the
following when creating the file system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkfs</span><span class="o">.</span><span class="n">xfs</span> <span class="o">-</span><span class="n">i</span> <span class="n">size</span><span class="o">=</span><span class="mi">1024</span> <span class="o">-</span><span class="n">L</span> <span class="n">D1</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span>
</pre></div>
</div>
<p>Setting the inode size is important, as XFS stores xattr data in the inode.
If the metadata is too large to fit in the inode, a new extent is created,
which can cause quite a performance problem. Upping the inode size to 1024
bytes provides enough room to write the default metadata, plus a little
headroom.</p>
<p>The following example mount options are recommended when using XFS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">xfs</span> <span class="o">-</span><span class="n">o</span> <span class="n">noatime</span> <span class="o">-</span><span class="n">L</span> <span class="n">D1</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="n">d1</span>
</pre></div>
</div>
<p>We do not recommend running Swift on RAID, but if you are using
RAID it is also important to make sure that the proper sunit and swidth
settings get set so that XFS can make most efficient use of the RAID array.</p>
<p>For a standard Swift install, all data drives are mounted directly under
<code class="docutils literal notranslate"><span class="pre">/srv/node</span></code> (as can be seen in the above example of mounting label <code class="docutils literal notranslate"><span class="pre">D1</span></code>
as <code class="docutils literal notranslate"><span class="pre">/srv/node/d1</span></code>). If you choose to mount the drives in another directory,
be sure to set the <code class="docutils literal notranslate"><span class="pre">devices</span></code> config option in all of the server configs to
point to the correct directory.</p>
<p>The mount points for each drive in <code class="docutils literal notranslate"><span class="pre">/srv/node/</span></code> should be owned by the root user
almost exclusively (<code class="docutils literal notranslate"><span class="pre">root:root</span> <span class="pre">755</span></code>). This is required to prevent rsync from
syncing files into the root drive in the event a drive is unmounted.</p>
<p>Swift uses system calls to reserve space for new objects being written into
the system. If your filesystem does not support <code class="docutils literal notranslate"><span class="pre">fallocate()</span></code> or
<code class="docutils literal notranslate"><span class="pre">posix_fallocate()</span></code>, be sure to set the <code class="docutils literal notranslate"><span class="pre">disable_fallocate</span> <span class="pre">=</span> <span class="pre">true</span></code> config
parameter in account, container, and object server configs.</p>
<p>Most current Linux distributions ship with a default installation of updatedb.
This tool runs periodically and updates the file name database that is used by
the GNU locate tool. However, including Swift object and container database
files is most likely not required and the periodic update affects the
performance quite a bit. To disable the inclusion of these files add the path
where Swift stores its data to the setting PRUNEPATHS in <code class="docutils literal notranslate"><span class="pre">/etc/updatedb.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PRUNEPATHS</span><span class="o">=</span><span class="s2">&quot;... /tmp ... /var/spool ... /srv/node&quot;</span>
</pre></div>
</div>
</section>
<section id="general-system-tuning">
<h2>General System Tuning<a class="headerlink" href="#general-system-tuning" title="Permalink to this heading">¶</a></h2>
<p>The following changes have been found to be useful when running Swift on Ubuntu
Server 10.04.</p>
<p>The following settings should be in <code class="docutils literal notranslate"><span class="pre">/etc/sysctl.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># disable TIME_WAIT.. wait..</span>
<span class="n">net</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">tcp_tw_recycle</span><span class="o">=</span><span class="mi">1</span>
<span class="n">net</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">tcp_tw_reuse</span><span class="o">=</span><span class="mi">1</span>

<span class="c1"># disable syn cookies</span>
<span class="n">net</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">tcp_syncookies</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># double amount of allowed conntrack</span>
<span class="n">net</span><span class="o">.</span><span class="n">netfilter</span><span class="o">.</span><span class="n">nf_conntrack_max</span> <span class="o">=</span> <span class="mi">262144</span>
</pre></div>
</div>
<p>To load the updated sysctl settings, run <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">sysctl</span> <span class="pre">-p</span></code>.</p>
<p>A note about changing the TIME_WAIT values.  By default the OS will hold
a port open for 60 seconds to ensure that any remaining packets can be
received.  During high usage, and with the number of connections that are
created, it is easy to run out of ports.  We can change this since we are
in control of the network.  If you are not in control of the network, or
do not expect high loads, then you may not want to adjust those values.</p>
</section>
<section id="logging-considerations">
<h2>Logging Considerations<a class="headerlink" href="#logging-considerations" title="Permalink to this heading">¶</a></h2>
<p>Swift is set up to log directly to syslog. Every service can be configured
with the <code class="docutils literal notranslate"><span class="pre">log_facility</span></code> option to set the syslog log facility destination.
We recommended using syslog-ng to route the logs to specific log
files locally on the server and also to remote log collecting servers.
Additionally, custom log handlers can be used via the custom_log_handlers
setting.</p>
</section>
</section>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="development_watchers.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Auditor Watchers"></i></a>
          
          
            <a href="apache_deployment_guide.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Apache Deployment Guide"></i></a>
          
          <a id="pdfLink2" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">this page last updated: 2021-07-21 15:00:13</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="https://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the
                 document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="OpenStack Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/id/">Bahasa Indonesia (Indonesian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/it/">Italiano (Italian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/tr_TR/">Türkçe (Türkiye)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Swift 0.1.0.dev10162</h4></a>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/object_api_v1_overview.html">Object Storage API overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_architecture.html">Swift Architectural Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_ring.html">The Rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_policies.html">Storage Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_reaper.html">The Account Reaper</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_auth.html">The Auth System</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_acl.html">Access Control Lists (ACLs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_replication.html">Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="ratelimit.html">Rate Limiting</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_large_objects.html">Large Object Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_global_cluster.html">Global Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_container_sync.html">Container to Container Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_expiring_objects.html">Expiring Object Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="cors.html">CORS</a></li>
<li class="toctree-l1"><a class="reference internal" href="crossdomain.html">Cross-domain Policy File</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_erasure_code.html">Erasure Code Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_encryption.html">Object Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_backing_store.html">Using Swift as Backing Store for Service Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_container_sharding.html">Container Sharding</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_background.html">Building a Consistent Hashing Ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_partpower.html">Modifying Ring Partition Power</a></li>
<li class="toctree-l1"><a class="reference internal" href="associated_projects.html">Associated Projects</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html">Contributing to OpenStack Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#swift-design-principles">Swift Design Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#recommended-workflow">Recommended workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#notes-on-testing">Notes on Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#ideas">Ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#community">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/review_guidelines.html">Review Guidelines</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development_guidelines.html">Development Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_saio.html">SAIO (Swift All In One)</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_contribution_swift.html">First Contribution to Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies_saio.html">Adding Storage Policies to an Existing SAIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_auth.html">Auth Server and Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_middleware.html">Middleware and Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_ondisk_backends.html">Pluggable On-Disk Back-end APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_watchers.html">Auditor Watchers</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Deployment Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hardware-considerations">Hardware Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deployment-options">Deployment Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#web-front-end-options">Web Front End Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparing-the-ring">Preparing the Ring</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-object-servers-per-disk">Running object-servers Per Disk</a></li>
<li class="toctree-l2"><a class="reference internal" href="#general-service-configuration">General Service Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#general-server-configuration">General Server Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#memcached-considerations">Memcached Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#system-time">System Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="#general-service-tuning">General Service Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filesystem-considerations">Filesystem Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#general-system-tuning">General System Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logging-considerations">Logging Considerations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apache_deployment_guide.html">Apache Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin_guide.html">Administrator’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="replication_network.html">Dedicated replication network</a></li>
<li class="toctree-l1"><a class="reference internal" href="logs.html">Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops_runbook/index.html">Swift Ops Runbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin/index.html">OpenStack Swift Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="install/index.html">Object Storage Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="config/index.html">Configuration Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/object_api_v1_overview.html">Object Storage API overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/discoverability.html">Discoverability</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/container_quotas.html">Container quotas</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/object_versioning.html">Object versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/large_objects.html">Large objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/temporary_url_middleware.html">Temporary URL middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/form_post_middleware.html">Form POST middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/use_content-encoding_metadata.html">Use Content-Encoding metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/use_the_content-disposition_metadata.html">Use the Content-Disposition metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pseudo-hierarchical-folders-directories.html">Pseudo-hierarchical folders and directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pagination.html">Page through large lists of containers or objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/serialized-response-formats.html">Serialized response formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/static-website.html">Create static website</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/object-expiration.html">Object expiration</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/bulk-delete.html">Bulk delete</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="s3_compat.html">S3/Swift REST API Comparison Matrix</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ring.html">Partitioned Consistent Hash Ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy.html">Proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="account.html">Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="container.html">Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="db.html">Account DB and Container DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="object.html">Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="middleware.html">Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="audit_watchers.html">Object Audit Watchers</a></li>
</ul>

    </div>

  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="local-table-of-contents">
      <h4 class="docs-sidebar-section-title">Page Contents</h4>
      <ul>
<li><a class="reference internal" href="#">Deployment Guide</a><ul>
<li><a class="reference internal" href="#hardware-considerations">Hardware Considerations</a></li>
<li><a class="reference internal" href="#deployment-options">Deployment Options</a></li>
<li><a class="reference internal" href="#web-front-end-options">Web Front End Options</a></li>
<li><a class="reference internal" href="#preparing-the-ring">Preparing the Ring</a></li>
<li><a class="reference internal" href="#running-object-servers-per-disk">Running object-servers Per Disk</a></li>
<li><a class="reference internal" href="#general-service-configuration">General Service Configuration</a></li>
<li><a class="reference internal" href="#general-server-configuration">General Server Configuration</a><ul>
<li><a class="reference internal" href="#per-policy-configuration">Per policy configuration</a></li>
<li><a class="reference internal" href="#proxy-middlewares">Proxy Middlewares</a></li>
</ul>
</li>
<li><a class="reference internal" href="#memcached-considerations">Memcached Considerations</a><ul>
<li><a class="reference internal" href="#shard-range-listing-cache">Shard Range Listing Cache</a></li>
</ul>
</li>
<li><a class="reference internal" href="#system-time">System Time</a></li>
<li><a class="reference internal" href="#general-service-tuning">General Service Tuning</a></li>
<li><a class="reference internal" href="#filesystem-considerations">Filesystem Considerations</a></li>
<li><a class="reference internal" href="#general-system-tuning">General System Tuning</a></li>
<li><a class="reference internal" href="#logging-considerations">Logging Considerations</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="https://openstack.org/projects/">Projects</a></li>
          <li><a href="https://www.openstack.org/software/security/">OpenStack Security</a></li>
          <li><a href="https://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="https://openstack.org/blog/">Blog</a></li>g
          <li><a href="https://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="https://openstack.org/community/">User Groups</a></li>
          <li><a href="https://openstack.org/community/events/">Events</a></li>
          <li><a href="https://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="https://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="https://docs.openstack.org/contributors">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="https://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="https://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="https://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="https://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="https://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="https://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="https://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-3.2.1.min.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- standard sphinx include libraries, which allow search highlighting -->
<script type="text/javascript" src="_static/underscore.js"></script>
<script type="text/javascript" src="_static/doctools.js"></script>
<script type="text/javascript" src="_static/searchtools.js"></script>
<script type="text/javascript" src="_static/language_data.js"></script>

<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.1.0.dev10162',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      LINK_SUFFIX: '.html',
      SOURCELINK_SUFFIX: '.txt',
      HAS_SOURCE:  true
    };
</script>

<!-- Javascript for page -->
<script language="JavaScript">
  /* Build a description of this page including SHA, source location on git
   * repo, build time and the project's launchpad bug tag. Set the HREF of the
   * bug buttons
   */
    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
    /* "giturl" is the URL of the source file on Git and is auto-generated by
     * openstackdocstheme.
     *
     * "pagename" is a standard sphinx parameter containing the name of
     * the source file, without extension.
     */

    var sourceFile = "deployment_guide" + ".rst";
    gitURL = "Source: https://opendev.org/openstack/swift/src/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: c25d961319e59efe02c05374924ba82b873992e1";
    var repositoryName = "openstack/swift";
    var bugProject = "swift";
    var bugTitle = "Deployment Guide in Swift";
    var fieldTags = "";
    var useStoryboard = "";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.1.0.dev10162 on 2021-07-21 15:00:13";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags, repositoryName, useStoryboard);
    var currentSourceFile = "deployment_guide";
    var pdfFileName = "doc-swift.pdf";
    pdfLink(currentSourceFile, pdfFileName);
</script>


  </body>
</html>