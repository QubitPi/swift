
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>SAIO (Swift All In One) &#8212; Swift 0.1.0.dev10162 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/basic.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="canonical" href="/openstack-swift/development_saio.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="First Contribution to Swift" href="first_contribution_swift.html" />
    <link rel="prev" title="Development Guidelines" href="development_guidelines.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">

<!-- Search CSS -->
<link href="_static/css/search.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/pygments.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


  </head><body>

<!-- SOURCE_FILE: https://opendev.org/openstack/swift/src/doc/source/development_saio.rst -->

<script>
    (function (window, document) {
        var loader = function () {
            var script = document.createElement("script"), tag = document.getElementsByTagName("script")[0];
            script.src = "https://search.openstack.org/widget/embed.min.js?t="+Date.now();
            tag.parentNode.insertBefore(script, tag);
        };
        window.addEventListener ? window.addEventListener("load", loader, false) : window.attachEvent("onload", loader);
    })(window, document);
</script>

<nav class="navbar navbar-default" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="https://www.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</div>
      <ul class="nav navbar-nav navbar-main show">
        <li class="search-container-mobile">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</li>
        <li> <!--Software -->
          <a href="https://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/openstack-components">OpenStack Components</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/sdks">SDKs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/deployment-tools">Deployment Tools</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/assets/software/projectmap/openstack-map.pdf" target="_blank">OpenStack Map</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
          </ul>
        </li>
        <li> <!-- Use Cases -->
          <a href="https://www.openstack.org/use-cases/" class="drop" id="dropdownMenuUsers">Use Cases <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/">Users in Production</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/bare-metal/">Ironic Bare Metal</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/edge-computing/">Edge Computing</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/telecoms-and-nfv/">Telecom & NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/science/">Science and HPC</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/containers/">Containers</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/enterprise/">Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li> <!-- Events -->
          <a href="https://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">Open Infrastructure Summits</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/ptg/">Project Teams Gathering</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/opendev-2020/">OpenDev</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/community-events/">Community Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/openstackdays">OpenStack & OpenInfra Days</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
          </ul>
        </li>
        <li><!-- Community -->
          <a href="https://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/tech-committee">OpenStack Technical Committee</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/coa/">Get Certified (COA)</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketing/">Marketing Resources</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/news/">Community News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/supporting-organizations/">OpenInfra Foundation Supporting Organizations</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">Open Infrastructure Foundation (OpenInfra Foundation)</a></li>
          </ul>
        </li>
        <li><!-- Marketplace -->
          <a href="https://www.openstack.orgmarketplace/" class="drop" id="dropdownMenuLearn">Marketplace <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/distros/">Distros & Appliances</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/public-clouds/">Public Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/hosted-private-clouds/">Hosted Private Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/remotely-managed-private-clouds/">Remotely Managed Private Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/consulting/">Consulting & Integrators</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/drivers/">Drivers</a></li>
          </ul>
        </li>
        <li><!-- Blog -->
          <a href="https://www.openstack.org/blog/">Blog</a>
        </li>
        <li><!-- Docs -->
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
        <li> <!-- Join -->
            <li class="join-nav-section">
              <a href="https://openinfra.dev/join/" id="dropdownMenuJoin">Join <i class="fa fa-caret-down"></i></a>
              <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuJoin" style="display: none;">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sign up for Foundation Membership</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sponsor the Foundation</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">More about the Foundation</a></li>
              </ul>
            </li>
            <li>
              <a href="https://www.openstack.org/Security/login/?BackURL=/home/" class="sign-in-btn">Log In</a>
            </li>
        </li>
      </ul>
    </div>
  </div>
  <!-- /.container -->
</nav>

    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row docs-title">
  <div class="col-lg-8">
      <h1>SAIO (Swift All In One)</h1>
    
  </div>
  <div class="docs-actions">
    
    <a href="development_guidelines.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Development Guidelines"></i></a>
    
    
    <a href="first_contribution_swift.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: First Contribution to Swift"></i></a>
    
    <a id="pdfLink1" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
    
  </div>
</div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-body" role="main">

  <section id="saio-swift-all-in-one">
<span id="saio"></span><h1>SAIO (Swift All In One)<a class="headerlink" href="#saio-swift-all-in-one" title="Permalink to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This guide assumes an existing Linux server. A physical machine or VM will
work. We recommend configuring it with at least 2GB of memory and 40GB of
storage space. We recommend using a VM in order to isolate Swift and its
dependencies from other projects you may be working on.</p>
</div>
<section id="instructions-for-setting-up-a-development-vm">
<h2>Instructions for setting up a development VM<a class="headerlink" href="#instructions-for-setting-up-a-development-vm" title="Permalink to this heading">¶</a></h2>
<p>This section documents setting up a virtual machine for doing Swift
development.  The virtual machine will emulate running a four node Swift
cluster. To begin:</p>
<ul class="simple">
<li><p>Get a Linux system server image, this guide will cover:</p>
<ul>
<li><p>Ubuntu 14.04, 16.04 LTS</p></li>
<li><p>CentOS 7</p></li>
<li><p>Fedora</p></li>
<li><p>OpenSuse</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>Create guest virtual machine from the image.</p></li>
</ul>
</section>
<section id="what-s-in-a-your-user-name">
<h2>What’s in a &lt;your-user-name&gt;<a class="headerlink" href="#what-s-in-a-your-user-name" title="Permalink to this heading">¶</a></h2>
<p>Much of the configuration described in this guide requires escalated
administrator (<code class="docutils literal notranslate"><span class="pre">root</span></code>) privileges; however, we assume that administrator logs
in as an unprivileged user and can use <code class="docutils literal notranslate"><span class="pre">sudo</span></code> to run privileged commands.</p>
<p>Swift processes also run under a separate user and group, set by configuration
option, and referenced as <code class="docutils literal notranslate"><span class="pre">&lt;your-user-name&gt;:&lt;your-group-name&gt;</span></code>.  The default user
is <code class="docutils literal notranslate"><span class="pre">swift</span></code>, which may not exist on your system.  These instructions are
intended to allow a developer to use his/her username for
<code class="docutils literal notranslate"><span class="pre">&lt;your-user-name&gt;:&lt;your-group-name&gt;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For OpenSuse users, a user’s primary group is <code class="docutils literal notranslate"><span class="pre">users</span></code>, so you have 2 options:</p>
<ul>
<li><p>Change <code class="docutils literal notranslate"><span class="pre">${USER}:${USER}</span></code> to <code class="docutils literal notranslate"><span class="pre">${USER}:users</span></code> in all references of this guide; or</p></li>
<li><p>Create a group for your username and add yourself to it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sudo groupadd ${USER} &amp;&amp; sudo gpasswd -a ${USER} ${USER} &amp;&amp; newgrp ${USER}
</pre></div>
</div>
</li>
</ul>
</div>
</section>
<section id="installing-dependencies">
<h2>Installing dependencies<a class="headerlink" href="#installing-dependencies" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p>On <code class="docutils literal notranslate"><span class="pre">apt</span></code> based systems:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">curl</span> <span class="n">gcc</span> <span class="n">memcached</span> <span class="n">rsync</span> <span class="n">sqlite3</span> <span class="n">xfsprogs</span> \
                     <span class="n">git</span><span class="o">-</span><span class="n">core</span> <span class="n">libffi</span><span class="o">-</span><span class="n">dev</span> <span class="n">python</span><span class="o">-</span><span class="n">setuptools</span> \
                     <span class="n">liberasurecode</span><span class="o">-</span><span class="n">dev</span> <span class="n">libssl</span><span class="o">-</span><span class="n">dev</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">coverage</span> <span class="n">python</span><span class="o">-</span><span class="n">dev</span> <span class="n">python</span><span class="o">-</span><span class="n">nose</span> \
                     <span class="n">python</span><span class="o">-</span><span class="n">xattr</span> <span class="n">python</span><span class="o">-</span><span class="n">eventlet</span> \
                     <span class="n">python</span><span class="o">-</span><span class="n">greenlet</span> <span class="n">python</span><span class="o">-</span><span class="n">pastedeploy</span> \
                     <span class="n">python</span><span class="o">-</span><span class="n">netifaces</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span> <span class="n">python</span><span class="o">-</span><span class="n">dnspython</span> \
                     <span class="n">python</span><span class="o">-</span><span class="n">mock</span>
</pre></div>
</div>
</li>
<li><p>On <code class="docutils literal notranslate"><span class="pre">CentOS</span></code> (requires additional repositories):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">epel</span><span class="o">-</span><span class="n">release</span>
<span class="n">sudo</span> <span class="n">yum</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="n">enable</span> <span class="n">epel</span> <span class="n">extras</span>
<span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">centos</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="n">train</span>
<span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">curl</span> <span class="n">gcc</span> <span class="n">memcached</span> <span class="n">rsync</span> <span class="n">sqlite</span> <span class="n">xfsprogs</span> <span class="n">git</span><span class="o">-</span><span class="n">core</span> \
                 <span class="n">libffi</span><span class="o">-</span><span class="n">devel</span> <span class="n">xinetd</span> <span class="n">liberasurecode</span><span class="o">-</span><span class="n">devel</span> \
                 <span class="n">openssl</span><span class="o">-</span><span class="n">devel</span> <span class="n">python</span><span class="o">-</span><span class="n">setuptools</span> \
                 <span class="n">python</span><span class="o">-</span><span class="n">coverage</span> <span class="n">python</span><span class="o">-</span><span class="n">devel</span> <span class="n">python</span><span class="o">-</span><span class="n">nose</span> \
                 <span class="n">pyxattr</span> <span class="n">python</span><span class="o">-</span><span class="n">eventlet</span> \
                 <span class="n">python</span><span class="o">-</span><span class="n">greenlet</span> <span class="n">python</span><span class="o">-</span><span class="n">paste</span><span class="o">-</span><span class="n">deploy</span> \
                 <span class="n">python</span><span class="o">-</span><span class="n">netifaces</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span> <span class="n">python</span><span class="o">-</span><span class="n">dns</span> \
                 <span class="n">python</span><span class="o">-</span><span class="n">mock</span>
</pre></div>
</div>
</li>
<li><p>On <code class="docutils literal notranslate"><span class="pre">Fedora</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dnf</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">dnf</span> <span class="n">install</span> <span class="n">curl</span> <span class="n">gcc</span> <span class="n">memcached</span> <span class="n">rsync</span><span class="o">-</span><span class="n">daemon</span> <span class="n">sqlite</span> <span class="n">xfsprogs</span> <span class="n">git</span><span class="o">-</span><span class="n">core</span> \
                 <span class="n">libffi</span><span class="o">-</span><span class="n">devel</span> <span class="n">xinetd</span> <span class="n">liberasurecode</span><span class="o">-</span><span class="n">devel</span> \
                 <span class="n">openssl</span><span class="o">-</span><span class="n">devel</span> <span class="n">python</span><span class="o">-</span><span class="n">setuptools</span> \
                 <span class="n">python</span><span class="o">-</span><span class="n">coverage</span> <span class="n">python</span><span class="o">-</span><span class="n">devel</span> <span class="n">python</span><span class="o">-</span><span class="n">nose</span> \
                 <span class="n">pyxattr</span> <span class="n">python</span><span class="o">-</span><span class="n">eventlet</span> \
                 <span class="n">python</span><span class="o">-</span><span class="n">greenlet</span> <span class="n">python</span><span class="o">-</span><span class="n">paste</span><span class="o">-</span><span class="n">deploy</span> \
                 <span class="n">python</span><span class="o">-</span><span class="n">netifaces</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span> <span class="n">python</span><span class="o">-</span><span class="n">dns</span> \
                 <span class="n">python</span><span class="o">-</span><span class="n">mock</span>
</pre></div>
</div>
</li>
<li><p>On <code class="docutils literal notranslate"><span class="pre">OpenSuse</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">zypper</span> <span class="n">install</span> <span class="n">curl</span> <span class="n">gcc</span> <span class="n">memcached</span> <span class="n">rsync</span> <span class="n">sqlite3</span> <span class="n">xfsprogs</span> <span class="n">git</span><span class="o">-</span><span class="n">core</span> \
                    <span class="n">libffi</span><span class="o">-</span><span class="n">devel</span> <span class="n">liberasurecode</span><span class="o">-</span><span class="n">devel</span> <span class="n">python2</span><span class="o">-</span><span class="n">setuptools</span> \
                    <span class="n">libopenssl</span><span class="o">-</span><span class="n">devel</span>
<span class="n">sudo</span> <span class="n">zypper</span> <span class="n">install</span> <span class="n">python2</span><span class="o">-</span><span class="n">coverage</span> <span class="n">python</span><span class="o">-</span><span class="n">devel</span> <span class="n">python2</span><span class="o">-</span><span class="n">nose</span> \
                    <span class="n">python</span><span class="o">-</span><span class="n">xattr</span> <span class="n">python</span><span class="o">-</span><span class="n">eventlet</span> <span class="n">python2</span><span class="o">-</span><span class="n">greenlet</span> \
                    <span class="n">python2</span><span class="o">-</span><span class="n">netifaces</span> <span class="n">python2</span><span class="o">-</span><span class="n">pip</span> <span class="n">python2</span><span class="o">-</span><span class="n">dnspython</span> \
                    <span class="n">python2</span><span class="o">-</span><span class="n">mock</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This installs necessary system dependencies and <em>most</em> of the python
dependencies. Later in the process setuptools/distribute or pip will install
and/or upgrade packages.</p>
</div>
</section>
<section id="configuring-storage">
<h2>Configuring storage<a class="headerlink" href="#configuring-storage" title="Permalink to this heading">¶</a></h2>
<p>Swift requires some space on XFS filesystems to store data and run tests.</p>
<p>Choose either <a class="reference internal" href="#partition-section"><span class="std std-ref">Using a partition for storage</span></a> or <a class="reference internal" href="#loopback-section"><span class="std std-ref">Using a loopback device for storage</span></a>.</p>
<section id="using-a-partition-for-storage">
<span id="partition-section"></span><h3>Using a partition for storage<a class="headerlink" href="#using-a-partition-for-storage" title="Permalink to this heading">¶</a></h3>
<p>If you are going to use a separate partition for Swift data, be sure to add
another device when creating the VM, and follow these instructions:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The disk does not have to be <code class="docutils literal notranslate"><span class="pre">/dev/sdb1</span></code> (for example, it could be
<code class="docutils literal notranslate"><span class="pre">/dev/vdb1</span></code>) however the mount point should still be <code class="docutils literal notranslate"><span class="pre">/mnt/sdb1</span></code>.</p>
</div>
<ol class="arabic">
<li><p>Set up a single partition on the device (this will wipe the drive):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">parted</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb</span> <span class="n">mklabel</span> <span class="n">msdos</span> <span class="n">mkpart</span> <span class="n">p</span> <span class="n">xfs</span> <span class="mi">0</span><span class="o">%</span> <span class="mi">100</span><span class="o">%</span>
</pre></div>
</div>
</li>
<li><p>Create an XFS file system on the partition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkfs</span><span class="o">.</span><span class="n">xfs</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb1</span>
</pre></div>
</div>
</li>
<li><p>Find the UUID of the new partition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">blkid</span>
</pre></div>
</div>
</li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">/etc/fstab</span></code> and add:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UUID</span><span class="o">=</span><span class="s2">&quot;&lt;UUID-from-output-above&gt;&quot;</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">sdb1</span> <span class="n">xfs</span> <span class="n">noatime</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p>Create the Swift data mount point and test that mounting works:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">sdb1</span>
<span class="n">sudo</span> <span class="n">mount</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
</li>
<li><p>Next, skip to <a class="reference internal" href="#common-dev-section"><span class="std std-ref">Common Post-Device Setup</span></a>.</p></li>
</ol>
</section>
<section id="using-a-loopback-device-for-storage">
<span id="loopback-section"></span><h3>Using a loopback device for storage<a class="headerlink" href="#using-a-loopback-device-for-storage" title="Permalink to this heading">¶</a></h3>
<p>If you want to use a loopback device instead of another partition, follow
these instructions:</p>
<ol class="arabic">
<li><p>Create the file for the loopback device:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">srv</span>
<span class="n">sudo</span> <span class="n">truncate</span> <span class="o">-</span><span class="n">s</span> <span class="mi">1</span><span class="n">GB</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">swift</span><span class="o">-</span><span class="n">disk</span>
<span class="n">sudo</span> <span class="n">mkfs</span><span class="o">.</span><span class="n">xfs</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">swift</span><span class="o">-</span><span class="n">disk</span>
</pre></div>
</div>
<p>Modify size specified in the <code class="docutils literal notranslate"><span class="pre">truncate</span></code> command to make a larger or
smaller partition as needed.</p>
</li>
<li><p>Edit <cite>/etc/fstab</cite> and add:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">swift</span><span class="o">-</span><span class="n">disk</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">sdb1</span> <span class="n">xfs</span> <span class="n">loop</span><span class="p">,</span><span class="n">noatime</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p>Create the Swift data mount point and test that mounting works:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">sdb1</span>
<span class="n">sudo</span> <span class="n">mount</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="common-post-device-setup">
<span id="common-dev-section"></span><h3>Common Post-Device Setup<a class="headerlink" href="#common-post-device-setup" title="Permalink to this heading">¶</a></h3>
<ol class="arabic">
<li><p>Create the individualized data links:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sudo mkdir /mnt/sdb1/1 /mnt/sdb1/2 /mnt/sdb1/3 /mnt/sdb1/4
sudo chown ${USER}:${USER} /mnt/sdb1/*
for x in {1..4}; do sudo ln -s /mnt/sdb1/$x /srv/$x; done
sudo mkdir -p /srv/1/node/sdb1 /srv/1/node/sdb5 \
              /srv/2/node/sdb2 /srv/2/node/sdb6 \
              /srv/3/node/sdb3 /srv/3/node/sdb7 \
              /srv/4/node/sdb4 /srv/4/node/sdb8
sudo mkdir -p /var/run/swift
sudo mkdir -p /var/cache/swift /var/cache/swift2 \
              /var/cache/swift3 /var/cache/swift4
sudo chown -R ${USER}:${USER} /var/run/swift
sudo chown -R ${USER}:${USER} /var/cache/swift*
# **Make sure to include the trailing slash after /srv/$x/**
for x in {1..4}; do sudo chown -R ${USER}:${USER} /srv/$x/; done
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We create the mount points and mount the loopback file under
/mnt/sdb1. This file will contain one directory per simulated Swift node,
each owned by the current Swift user.</p>
<p>We then create symlinks to these directories under /srv.
If the disk sdb or loopback file is unmounted, files will not be written under
/srv/*, because the symbolic link destination /mnt/sdb1/* will not
exist. This prevents disk sync operations from writing to the root
partition in the event a drive is unmounted.</p>
</div>
</li>
<li><p>Restore appropriate permissions on reboot.</p>
<ul>
<li><p>On traditional Linux systems, add the following lines to <code class="docutils literal notranslate"><span class="pre">/etc/rc.local</span></code> (before the <code class="docutils literal notranslate"><span class="pre">exit</span> <span class="pre">0</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">swift</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">swift2</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">swift3</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">swift4</span>
<span class="n">chown</span> <span class="o">&lt;</span><span class="n">your</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">your</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">swift</span><span class="o">*</span>
<span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">swift</span>
<span class="n">chown</span> <span class="o">&lt;</span><span class="n">your</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">your</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">swift</span>
</pre></div>
</div>
</li>
<li><p>On CentOS and Fedora we can use systemd (rc.local is deprecated):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cat &lt;&lt; EOF |sudo tee /etc/tmpfiles.d/swift.conf
d /var/cache/swift 0755 ${USER} ${USER} - -
d /var/cache/swift2 0755 ${USER} ${USER} - -
d /var/cache/swift3 0755 ${USER} ${USER} - -
d /var/cache/swift4 0755 ${USER} ${USER} - -
d /var/run/swift 0755 ${USER} ${USER} - -
EOF
</pre></div>
</div>
</li>
<li><p>On OpenSuse place the lines in <code class="docutils literal notranslate"><span class="pre">/etc/init.d/boot.local</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On some systems the rc file might need to be an executable shell script.</p>
</div>
</li>
</ol>
<section id="creating-an-xfs-tmp-dir">
<h4>Creating an XFS tmp dir<a class="headerlink" href="#creating-an-xfs-tmp-dir" title="Permalink to this heading">¶</a></h4>
<p>Tests require having a directory available on an XFS filesystem. By default the
tests use <code class="docutils literal notranslate"><span class="pre">/tmp</span></code>, however this can be pointed elsewhere with the <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code>
environment variable.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your root filesystem is XFS, you can skip this section if <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> is
just a directory and not a mounted tmpfs. Or you could simply point to any
existing directory owned by your user by specifying it with the <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code>
environment variable.</p>
<p>If your root filesystem is not XFS, you should create a loopback device,
format it with XFS and mount it. You can mount it over <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> or to
another location and specify it with the <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code> environment variable.</p>
</div>
<ul>
<li><p>Create the file for the tmp loopback device:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">srv</span>
<span class="n">sudo</span> <span class="n">truncate</span> <span class="o">-</span><span class="n">s</span> <span class="mi">1</span><span class="n">GB</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">swift</span><span class="o">-</span><span class="n">tmp</span>  <span class="c1"># create 1GB file for XFS in /srv</span>
<span class="n">sudo</span> <span class="n">mkfs</span><span class="o">.</span><span class="n">xfs</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">swift</span><span class="o">-</span><span class="n">tmp</span>
</pre></div>
</div>
</li>
<li><p>To mount the tmp loopback device at <code class="docutils literal notranslate"><span class="pre">/tmp</span></code>, do the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mount</span> <span class="o">-</span><span class="n">o</span> <span class="n">loop</span><span class="p">,</span><span class="n">noatime</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">swift</span><span class="o">-</span><span class="n">tmp</span> <span class="o">/</span><span class="n">tmp</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="o">-</span><span class="n">R</span> <span class="mi">1777</span> <span class="o">/</span><span class="n">tmp</span>
</pre></div>
</div>
<ul>
<li><p>To persist this, edit and add the following to <code class="docutils literal notranslate"><span class="pre">/etc/fstab</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">swift</span><span class="o">-</span><span class="n">tmp</span> <span class="o">/</span><span class="n">tmp</span> <span class="n">xfs</span> <span class="n">rw</span><span class="p">,</span><span class="n">noatime</span><span class="p">,</span><span class="n">attr2</span><span class="p">,</span><span class="n">inode64</span><span class="p">,</span><span class="n">noquota</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>To mount the tmp loopback at an alternate location (for example, <code class="docutils literal notranslate"><span class="pre">/mnt/tmp</span></code>),
do the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sudo mkdir -p /mnt/tmp
sudo mount -o loop,noatime /srv/swift-tmp /mnt/tmp
sudo chown ${USER}:${USER} /mnt/tmp
</pre></div>
</div>
<ul>
<li><p>To persist this, edit and add the following to <code class="docutils literal notranslate"><span class="pre">/etc/fstab</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">swift</span><span class="o">-</span><span class="n">tmp</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">tmp</span> <span class="n">xfs</span> <span class="n">rw</span><span class="p">,</span><span class="n">noatime</span><span class="p">,</span><span class="n">attr2</span><span class="p">,</span><span class="n">inode64</span><span class="p">,</span><span class="n">noquota</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p>Set your <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code> environment dir so that Swift looks in the right location:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export TMPDIR=/mnt/tmp
echo &quot;export TMPDIR=/mnt/tmp&quot; &gt;&gt; $HOME/.bashrc
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</section>
</section>
</section>
<section id="getting-the-code">
<h2>Getting the code<a class="headerlink" href="#getting-the-code" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Check out the python-swiftclient repo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $HOME; git clone https://opendev.org/openstack/python-swiftclient.git
</pre></div>
</div>
</li>
<li><p>Build a development installation of python-swiftclient:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $HOME/python-swiftclient; sudo python setup.py develop; cd -
</pre></div>
</div>
<p>Ubuntu 12.04 users need to install python-swiftclient’s dependencies before the installation of
python-swiftclient. This is due to a bug in an older version of setup tools:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $HOME/python-swiftclient; sudo pip install -r requirements.txt; sudo python setup.py develop; cd -
</pre></div>
</div>
</li>
<li><p>Check out the Swift repo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">openstack</span><span class="o">/</span><span class="n">swift</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</li>
<li><p>Build a development installation of Swift:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $HOME/swift; sudo pip install --no-binary cryptography -r requirements.txt; sudo python setup.py develop; cd -
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to a difference in how <code class="docutils literal notranslate"><span class="pre">libssl.so</span></code> is named in OpenSuse vs. other Linux distros the
wheel/binary won’t work; thus we use <code class="docutils literal notranslate"><span class="pre">--no-binary</span> <span class="pre">cryptography</span></code> to build <code class="docutils literal notranslate"><span class="pre">cryptography</span></code>
locally.</p>
</div>
<p>Fedora users might have to perform the following if development
installation of Swift fails:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">xattr</span>
</pre></div>
</div>
</li>
<li><p>Install Swift’s test dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $HOME/swift; sudo pip install -r test-requirements.txt
</pre></div>
</div>
</li>
</ol>
</section>
<section id="setting-up-rsync">
<h2>Setting up rsync<a class="headerlink" href="#setting-up-rsync" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Create <code class="docutils literal notranslate"><span class="pre">/etc/rsyncd.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sudo cp $HOME/swift/doc/saio/rsyncd.conf /etc/
sudo sed -i &quot;s/&lt;your-user-name&gt;/${USER}/&quot; /etc/rsyncd.conf
</pre></div>
</div>
<p>Here is the default <code class="docutils literal notranslate"><span class="pre">rsyncd.conf</span></code> file contents maintained in the repo
that is copied and fixed up above:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">uid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">gid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/rsyncd.log</span>
<span class="na">pid file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/run/rsyncd.pid</span>
<span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.0.0.0</span>

<span class="k">[account6212]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/1/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/account6212.lock</span>

<span class="k">[account6222]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/2/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/account6222.lock</span>

<span class="k">[account6232]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/3/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/account6232.lock</span>

<span class="k">[account6242]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/4/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/account6242.lock</span>

<span class="k">[container6211]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/1/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/container6211.lock</span>

<span class="k">[container6221]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/2/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/container6221.lock</span>

<span class="k">[container6231]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/3/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/container6231.lock</span>

<span class="k">[container6241]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/4/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/container6241.lock</span>

<span class="k">[object6210]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/1/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/object6210.lock</span>

<span class="k">[object6220]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/2/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/object6220.lock</span>

<span class="k">[object6230]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/3/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/object6230.lock</span>

<span class="k">[object6240]</span>
<span class="na">max connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">25</span>
<span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/4/node/</span>
<span class="na">read only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">lock file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/lock/object6240.lock</span>
</pre></div>
</div>
</li>
<li><p>Enable rsync daemon</p>
<ul>
<li><p>On Ubuntu, edit the following line in <code class="docutils literal notranslate"><span class="pre">/etc/default/rsync</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RSYNC_ENABLE</span><span class="o">=</span><span class="n">true</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You might have to create the file to perform the edits.</p>
</div>
<ul>
<li><p>On CentOS and Fedora, enable the systemd service:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">rsyncd</span>
</pre></div>
</div>
</li>
<li><p>On OpenSuse, nothing needs to happen here.</p></li>
</ul>
</li>
<li><p>On platforms with SELinux in <code class="docutils literal notranslate"><span class="pre">Enforcing</span></code> mode, either set to <code class="docutils literal notranslate"><span class="pre">Permissive</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">setenforce</span> <span class="n">Permissive</span>
<span class="n">sudo</span> <span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;s/^SELINUX=.*/SELINUX=permissive/g&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">selinux</span><span class="o">/</span><span class="n">config</span>
</pre></div>
</div>
<p>Or just allow rsync full access:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">setsebool</span> <span class="o">-</span><span class="n">P</span> <span class="n">rsync_full_access</span> <span class="mi">1</span>
</pre></div>
</div>
</li>
<li><p>Start the rsync daemon</p>
<ul>
<li><p>On Ubuntu 14.04, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">rsync</span> <span class="n">restart</span>
</pre></div>
</div>
</li>
<li><p>On Ubuntu 16.04, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">rsync</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">rsync</span>
</pre></div>
</div>
</li>
<li><p>On CentOS, Fedora and OpenSuse, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">rsyncd</span>
</pre></div>
</div>
</li>
<li><p>On other xinetd based systems simply run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">xinetd</span> <span class="n">restart</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Verify rsync is accepting connections for all servers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="n">rsync</span><span class="p">:</span><span class="o">//</span><span class="n">pub</span><span class="nd">@localhost</span><span class="o">/</span>
</pre></div>
</div>
<p>You should see the following output from the above command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">account6212</span>
<span class="n">account6222</span>
<span class="n">account6232</span>
<span class="n">account6242</span>
<span class="n">container6211</span>
<span class="n">container6221</span>
<span class="n">container6231</span>
<span class="n">container6241</span>
<span class="n">object6210</span>
<span class="n">object6220</span>
<span class="n">object6230</span>
<span class="n">object6240</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="starting-memcached">
<h2>Starting memcached<a class="headerlink" href="#starting-memcached" title="Permalink to this heading">¶</a></h2>
<p>On non-Ubuntu distros you need to ensure memcached is running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">memcached</span> <span class="n">start</span>
<span class="n">sudo</span> <span class="n">chkconfig</span> <span class="n">memcached</span> <span class="n">on</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">memcached</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">memcached</span>
</pre></div>
</div>
<p>The tempauth middleware stores tokens in memcached. If memcached is not
running, tokens cannot be validated, and accessing Swift becomes impossible.</p>
</section>
<section id="optional-setting-up-rsyslog-for-individual-logging">
<h2>Optional: Setting up rsyslog for individual logging<a class="headerlink" href="#optional-setting-up-rsyslog-for-individual-logging" title="Permalink to this heading">¶</a></h2>
<p>Fedora and OpenSuse may not have rsyslog installed, in which case you will need
to install it if you want to use individual logging.</p>
<ol class="arabic">
<li><p>Install rsyslogd</p>
<ul>
<li><p>On Fedora:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dnf</span> <span class="n">install</span> <span class="n">rsyslog</span>
</pre></div>
</div>
</li>
<li><p>On OpenSuse:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">zypper</span> <span class="n">install</span> <span class="n">rsyslog</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Install the Swift rsyslogd configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sudo cp $HOME/swift/doc/saio/rsyslog.d/10-swift.conf /etc/rsyslog.d/
</pre></div>
</div>
<p>Be sure to review that conf file to determine if you want all the logs
in one file vs. all the logs separated out, and if you want hourly logs
for stats processing. For convenience, we provide its default contents
below:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment the following to have a log containing all logs together</span>
<span class="c1">#local1,local2,local3,local4,local5.*   /var/log/swift/all.log</span>

<span class="c1"># Uncomment the following to have hourly proxy logs for stats processing</span>
<span class="c1">#$template HourlyProxyLog,&quot;/var/log/swift/hourly/%$YEAR%%$MONTH%%$DAY%%$HOUR%&quot;</span>
<span class="c1">#local1.*;local1.!notice ?HourlyProxyLog</span>

<span class="na">local1.*;local1.!notice /var/log/swift/proxy.log</span>
<span class="na">local1.notice           /var/log/swift/proxy.error</span>
<span class="na">local1.*                ~</span>

<span class="na">local2.*;local2.!notice /var/log/swift/storage1.log</span>
<span class="na">local2.notice           /var/log/swift/storage1.error</span>
<span class="na">local2.*                ~</span>

<span class="na">local3.*;local3.!notice /var/log/swift/storage2.log</span>
<span class="na">local3.notice           /var/log/swift/storage2.error</span>
<span class="na">local3.*                ~</span>

<span class="na">local4.*;local4.!notice /var/log/swift/storage3.log</span>
<span class="na">local4.notice           /var/log/swift/storage3.error</span>
<span class="na">local4.*                ~</span>

<span class="na">local5.*;local5.!notice /var/log/swift/storage4.log</span>
<span class="na">local5.notice           /var/log/swift/storage4.error</span>
<span class="na">local5.*                ~</span>

<span class="na">local6.*;local6.!notice /var/log/swift/expirer.log</span>
<span class="na">local6.notice           /var/log/swift/expirer.error</span>
<span class="na">local6.*                ~</span>
</pre></div>
</div>
</li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">/etc/rsyslog.conf</span></code> and make the following change (usually in the
“GLOBAL DIRECTIVES” section):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$PrivDropToGroup adm
</pre></div>
</div>
</li>
<li><p>If using hourly logs (see above) perform:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">swift</span><span class="o">/</span><span class="n">hourly</span>
</pre></div>
</div>
<p>Otherwise perform:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">swift</span>
</pre></div>
</div>
</li>
<li><p>Setup the logging directory and start syslog:</p>
<ul>
<li><p>On Ubuntu:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">syslog</span><span class="o">.</span><span class="n">adm</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">swift</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="o">-</span><span class="n">R</span> <span class="n">g</span><span class="o">+</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">swift</span>
<span class="n">sudo</span> <span class="n">service</span> <span class="n">rsyslog</span> <span class="n">restart</span>
</pre></div>
</div>
</li>
<li><p>On CentOS, Fedora and OpenSuse:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">root</span><span class="p">:</span><span class="n">adm</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">swift</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="o">-</span><span class="n">R</span> <span class="n">g</span><span class="o">+</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">swift</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">rsyslog</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">rsyslog</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
</section>
<section id="configuring-each-node">
<h2>Configuring each node<a class="headerlink" href="#configuring-each-node" title="Permalink to this heading">¶</a></h2>
<p>After performing the following steps, be sure to verify that Swift has access
to resulting configuration files (sample configuration files are provided with
all defaults in line-by-line comments).</p>
<ol class="arabic">
<li><p>Optionally remove an existing swift directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">swift</span>
</pre></div>
</div>
</li>
<li><p>Populate the <code class="docutils literal notranslate"><span class="pre">/etc/swift</span></code> directory itself:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $HOME/swift/doc; sudo cp -r saio/swift /etc/swift; cd -
sudo chown -R ${USER}:${USER} /etc/swift
</pre></div>
</div>
</li>
<li><p>Update <code class="docutils literal notranslate"><span class="pre">&lt;your-user-name&gt;</span></code> references in the Swift config files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">find</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">swift</span><span class="o">/</span> <span class="o">-</span><span class="n">name</span> \<span class="o">*.</span><span class="n">conf</span> <span class="o">|</span> <span class="n">xargs</span> <span class="n">sudo</span> <span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&quot;s/&lt;your-user-name&gt;/$</span><span class="si">{USER}</span><span class="s2">/&quot;</span>
</pre></div>
</div>
</li>
</ol>
<p>The contents of the configuration files provided by executing the above
commands are as follows:</p>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/swift.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[swift-hash]</span>
<span class="c1"># random unique strings that can never change (DO NOT LOSE)</span>
<span class="c1"># Use only printable chars (python -c &quot;import string; print(string.printable)&quot;)</span>
<span class="na">swift_hash_path_prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">changeme</span>
<span class="na">swift_hash_path_suffix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">changeme</span>

<span class="k">[storage-policy:0]</span>
<span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">gold</span>
<span class="na">policy_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">replication</span>
<span class="na">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>

<span class="k">[storage-policy:1]</span>
<span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">silver</span>
<span class="na">policy_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">replication</span>

<span class="k">[storage-policy:2]</span>
<span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">ec42</span>
<span class="na">policy_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">erasure_coding</span>
<span class="na">ec_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">liberasurecode_rs_vand</span>
<span class="na">ec_num_data_fragments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">4</span>
<span class="na">ec_num_parity_fragments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/proxy-server.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.1</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">8080</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL1</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="c1"># Yes, proxy-logging appears twice. This is so that</span>
<span class="c1"># middleware-originated requests get logged too.</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">catch_errors gatekeeper healthcheck proxy-logging cache etag-quoter listing_formats bulk tempurl ratelimit crossdomain container_sync tempauth staticweb copy container-quotas account-quotas slo dlo versioned_writes symlink proxy-logging proxy-server</span>

<span class="k">[filter:catch_errors]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#catch_errors</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[filter:proxy-logging]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy_logging</span>

<span class="k">[filter:bulk]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#bulk</span>

<span class="k">[filter:ratelimit]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#ratelimit</span>

<span class="k">[filter:crossdomain]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#crossdomain</span>

<span class="k">[filter:dlo]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#dlo</span>

<span class="k">[filter:slo]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#slo</span>

<span class="k">[filter:container_sync]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#container_sync</span>
<span class="na">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">//saio/saio_endpoint</span>

<span class="k">[filter:tempurl]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#tempurl</span>

<span class="k">[filter:tempauth]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#tempauth</span>
<span class="na">user_admin_admin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">admin .admin .reseller_admin</span>
<span class="na">user_test_tester</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing .admin</span>
<span class="na">user_test_tester2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing2 .admin</span>
<span class="na">user_test_tester3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing3</span>
<span class="na">user_test2_tester2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing2 .admin</span>

<span class="k">[filter:staticweb]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#staticweb</span>

<span class="k">[filter:account-quotas]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#account_quotas</span>

<span class="k">[filter:container-quotas]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#container_quotas</span>

<span class="k">[filter:cache]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#memcache</span>

<span class="k">[filter:etag-quoter]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#etag_quoter</span>
<span class="na">enable_by_default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>

<span class="k">[filter:gatekeeper]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#gatekeeper</span>

<span class="k">[filter:versioned_writes]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#versioned_writes</span>
<span class="na">allow_versioned_writes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">allow_object_versioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[filter:copy]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#copy</span>

<span class="k">[filter:listing_formats]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#listing_formats</span>

<span class="k">[filter:domain_remap]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#domain_remap</span>

<span class="k">[filter:symlink]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#symlink</span>

<span class="c1"># To enable, add the s3api middleware to the pipeline before tempauth</span>
<span class="k">[filter:s3api]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#s3api</span>
<span class="na">s3_acl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
<span class="na">check_bucket_owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">yes</span>
<span class="na">cors_preflight_allow_origin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">*</span>

<span class="c1"># Example to create root secret: `openssl rand -base64 32`</span>
<span class="k">[filter:keymaster]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#keymaster</span>
<span class="na">encryption_root_secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">changeme/changeme/changeme/changeme/change/=</span>

<span class="c1"># To enable use of encryption add both middlewares to pipeline, example:</span>
<span class="c1"># &lt;other middleware&gt; keymaster encryption proxy-logging proxy-server</span>
<span class="k">[filter:encryption]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#encryption</span>

<span class="k">[app:proxy-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy</span>
<span class="na">allow_account_management</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">account_autocreate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/object-expirer.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="c1"># swift_dir = /etc/swift</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="c1"># You can specify default log routing here if you want:</span>
<span class="na">log_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">object-expirer</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL6</span>
<span class="na">log_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">INFO</span>
<span class="c1">#log_address = /dev/log</span>
<span class="c1">#</span>
<span class="c1"># comma separated list of functions to call to setup custom log handlers.</span>
<span class="c1"># functions get passed: conf, name, log_to_console, log_route, fmt, logger,</span>
<span class="c1"># adapted_logger</span>
<span class="c1"># log_custom_handlers =</span>
<span class="c1">#</span>
<span class="c1"># If set, log_udp_host will override log_address</span>
<span class="c1"># log_udp_host =</span>
<span class="c1"># log_udp_port = 514</span>
<span class="c1">#</span>
<span class="c1"># You can enable StatsD logging here:</span>
<span class="c1"># log_statsd_host =</span>
<span class="c1"># log_statsd_port = 8125</span>
<span class="c1"># log_statsd_default_sample_rate = 1.0</span>
<span class="c1"># log_statsd_sample_rate_factor = 1.0</span>
<span class="c1"># log_statsd_metric_prefix =</span>

<span class="k">[object-expirer]</span>
<span class="na">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">300</span>
<span class="c1"># report_interval = 300</span>
<span class="c1"># concurrency is the level of concurrency to use to do the work, this value</span>
<span class="c1"># must be set to at least 1</span>
<span class="c1"># concurrency = 1</span>
<span class="c1"># processes is how many parts to divide the work into, one part per process</span>
<span class="c1">#   that will be doing the work</span>
<span class="c1"># processes set 0 means that a single process will be doing all the work</span>
<span class="c1"># processes can also be specified on the command line and will override the</span>
<span class="c1">#   config value</span>
<span class="c1"># processes = 0</span>
<span class="c1"># process is which of the parts a particular process will work on</span>
<span class="c1"># process can also be specified on the command line and will override the config</span>
<span class="c1">#   value</span>
<span class="c1"># process is &quot;zero based&quot;, if you want to use 3 processes, you should run</span>
<span class="c1">#  processes with process set to 0, 1, and 2</span>
<span class="c1"># process = 0</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">catch_errors cache proxy-server</span>

<span class="k">[app:proxy-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy</span>
<span class="c1"># See proxy-server.conf-sample for options</span>

<span class="k">[filter:cache]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#memcache</span>
<span class="c1"># See proxy-server.conf-sample for options</span>

<span class="k">[filter:catch_errors]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#catch_errors</span>
<span class="c1"># See proxy-server.conf-sample for options</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/container-sync-realms.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[saio]</span>
<span class="na">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">changeme</span>
<span class="na">key2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">changeme</span>
<span class="na">cluster_saio_endpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">http://127.0.0.1:8080/v1/</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/account-server/1.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/1/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.1</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6212</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL2</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon account-server</span>

<span class="k">[app:account-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#account</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[account-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::account{replication_port}</span>

<span class="k">[account-auditor]</span>

<span class="k">[account-reaper]</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/container-server/1.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/1/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.1</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6211</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL2</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon container-server</span>

<span class="k">[app:container-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#container</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[container-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::container{replication_port}</span>

<span class="k">[container-updater]</span>

<span class="k">[container-auditor]</span>

<span class="k">[container-sync]</span>

<span class="k">[container-sharder]</span>
<span class="na">auto_shard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::container{replication_port}</span>
<span class="c1"># This is intentionally much smaller than the default of 1,000,000 so tests</span>
<span class="c1"># can run in a reasonable amount of time</span>
<span class="na">shard_container_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100</span>
<span class="c1"># The probe tests make explicit assumptions about the batch sizes</span>
<span class="na">shard_scanner_batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10</span>
<span class="na">cleave_batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/container-reconciler/1.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="c1"># swift_dir = /etc/swift</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="c1"># You can specify default log routing here if you want:</span>
<span class="c1"># log_name = swift</span>
<span class="c1"># log_facility = LOG_LOCAL0</span>
<span class="c1"># log_level = INFO</span>
<span class="c1"># log_address = /dev/log</span>
<span class="c1">#</span>
<span class="c1"># comma separated list of functions to call to setup custom log handlers.</span>
<span class="c1"># functions get passed: conf, name, log_to_console, log_route, fmt, logger,</span>
<span class="c1"># adapted_logger</span>
<span class="c1"># log_custom_handlers =</span>
<span class="c1">#</span>
<span class="c1"># If set, log_udp_host will override log_address</span>
<span class="c1"># log_udp_host =</span>
<span class="c1"># log_udp_port = 514</span>
<span class="c1">#</span>
<span class="c1"># You can enable StatsD logging here:</span>
<span class="c1"># log_statsd_host =</span>
<span class="c1"># log_statsd_port = 8125</span>
<span class="c1"># log_statsd_default_sample_rate = 1.0</span>
<span class="c1"># log_statsd_sample_rate_factor = 1.0</span>
<span class="c1"># log_statsd_metric_prefix =</span>

<span class="k">[container-reconciler]</span>
<span class="c1"># reclaim_age = 604800</span>
<span class="c1"># interval = 300</span>
<span class="c1"># request_tries = 3</span>
<span class="na">processes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">4</span>
<span class="na">process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">catch_errors proxy-logging cache proxy-server</span>

<span class="k">[app:proxy-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy</span>
<span class="c1"># See proxy-server.conf-sample for options</span>

<span class="k">[filter:cache]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#memcache</span>
<span class="c1"># See proxy-server.conf-sample for options</span>

<span class="k">[filter:proxy-logging]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy_logging</span>

<span class="k">[filter:catch_errors]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#catch_errors</span>
<span class="c1"># See proxy-server.conf-sample for options</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/object-server/1.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/1/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.1</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6210</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL2</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon object-server</span>

<span class="k">[app:object-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#object</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[object-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::object{replication_port}</span>

<span class="k">[object-reconstructor]</span>

<span class="k">[object-updater]</span>

<span class="k">[object-auditor]</span>

<span class="k">[object-relinker]</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/account-server/2.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/2/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.2</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6222</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL3</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift2</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon account-server</span>

<span class="k">[app:account-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#account</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[account-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::account{replication_port}</span>

<span class="k">[account-auditor]</span>

<span class="k">[account-reaper]</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/container-server/2.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/2/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.2</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6221</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL3</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift2</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon container-server</span>

<span class="k">[app:container-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#container</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[container-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::container{replication_port}</span>

<span class="k">[container-updater]</span>

<span class="k">[container-auditor]</span>

<span class="k">[container-sync]</span>

<span class="k">[container-sharder]</span>
<span class="na">auto_shard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::container{replication_port}</span>
<span class="c1"># This is intentionally much smaller than the default of 1,000,000 so tests</span>
<span class="c1"># can run in a reasonable amount of time</span>
<span class="na">shard_container_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100</span>
<span class="c1"># The probe tests make explicit assumptions about the batch sizes</span>
<span class="na">shard_scanner_batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10</span>
<span class="na">cleave_batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/container-reconciler/2.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="c1"># swift_dir = /etc/swift</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="c1"># You can specify default log routing here if you want:</span>
<span class="c1"># log_name = swift</span>
<span class="c1"># log_facility = LOG_LOCAL0</span>
<span class="c1"># log_level = INFO</span>
<span class="c1"># log_address = /dev/log</span>
<span class="c1">#</span>
<span class="c1"># comma separated list of functions to call to setup custom log handlers.</span>
<span class="c1"># functions get passed: conf, name, log_to_console, log_route, fmt, logger,</span>
<span class="c1"># adapted_logger</span>
<span class="c1"># log_custom_handlers =</span>
<span class="c1">#</span>
<span class="c1"># If set, log_udp_host will override log_address</span>
<span class="c1"># log_udp_host =</span>
<span class="c1"># log_udp_port = 514</span>
<span class="c1">#</span>
<span class="c1"># You can enable StatsD logging here:</span>
<span class="c1"># log_statsd_host =</span>
<span class="c1"># log_statsd_port = 8125</span>
<span class="c1"># log_statsd_default_sample_rate = 1.0</span>
<span class="c1"># log_statsd_sample_rate_factor = 1.0</span>
<span class="c1"># log_statsd_metric_prefix =</span>

<span class="k">[container-reconciler]</span>
<span class="c1"># reclaim_age = 604800</span>
<span class="c1"># interval = 300</span>
<span class="c1"># request_tries = 3</span>
<span class="na">processes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">4</span>
<span class="na">process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">catch_errors proxy-logging cache proxy-server</span>

<span class="k">[app:proxy-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy</span>
<span class="c1"># See proxy-server.conf-sample for options</span>

<span class="k">[filter:cache]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#memcache</span>
<span class="c1"># See proxy-server.conf-sample for options</span>

<span class="k">[filter:proxy-logging]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy_logging</span>

<span class="k">[filter:catch_errors]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#catch_errors</span>
<span class="c1"># See proxy-server.conf-sample for options</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/object-server/2.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/2/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.2</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6220</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL3</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift2</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon object-server</span>

<span class="k">[app:object-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#object</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[object-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::object{replication_port}</span>

<span class="k">[object-reconstructor]</span>

<span class="k">[object-updater]</span>

<span class="k">[object-auditor]</span>

<span class="k">[object-relinker]</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/account-server/3.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/3/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.3</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6232</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL4</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift3</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon account-server</span>

<span class="k">[app:account-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#account</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[account-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::account{replication_port}</span>

<span class="k">[account-auditor]</span>

<span class="k">[account-reaper]</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/container-server/3.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/3/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.3</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6231</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL4</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift3</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon container-server</span>

<span class="k">[app:container-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#container</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[container-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::container{replication_port}</span>

<span class="k">[container-updater]</span>

<span class="k">[container-auditor]</span>

<span class="k">[container-sync]</span>

<span class="k">[container-sharder]</span>
<span class="na">auto_shard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::container{replication_port}</span>
<span class="c1"># This is intentionally much smaller than the default of 1,000,000 so tests</span>
<span class="c1"># can run in a reasonable amount of time</span>
<span class="na">shard_container_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100</span>
<span class="c1"># The probe tests make explicit assumptions about the batch sizes</span>
<span class="na">shard_scanner_batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10</span>
<span class="na">cleave_batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/container-reconciler/3.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="c1"># swift_dir = /etc/swift</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="c1"># You can specify default log routing here if you want:</span>
<span class="c1"># log_name = swift</span>
<span class="c1"># log_facility = LOG_LOCAL0</span>
<span class="c1"># log_level = INFO</span>
<span class="c1"># log_address = /dev/log</span>
<span class="c1">#</span>
<span class="c1"># comma separated list of functions to call to setup custom log handlers.</span>
<span class="c1"># functions get passed: conf, name, log_to_console, log_route, fmt, logger,</span>
<span class="c1"># adapted_logger</span>
<span class="c1"># log_custom_handlers =</span>
<span class="c1">#</span>
<span class="c1"># If set, log_udp_host will override log_address</span>
<span class="c1"># log_udp_host =</span>
<span class="c1"># log_udp_port = 514</span>
<span class="c1">#</span>
<span class="c1"># You can enable StatsD logging here:</span>
<span class="c1"># log_statsd_host =</span>
<span class="c1"># log_statsd_port = 8125</span>
<span class="c1"># log_statsd_default_sample_rate = 1.0</span>
<span class="c1"># log_statsd_sample_rate_factor = 1.0</span>
<span class="c1"># log_statsd_metric_prefix =</span>

<span class="k">[container-reconciler]</span>
<span class="c1"># reclaim_age = 604800</span>
<span class="c1"># interval = 300</span>
<span class="c1"># request_tries = 3</span>
<span class="na">processes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">4</span>
<span class="na">process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">catch_errors proxy-logging cache proxy-server</span>

<span class="k">[app:proxy-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy</span>
<span class="c1"># See proxy-server.conf-sample for options</span>

<span class="k">[filter:cache]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#memcache</span>
<span class="c1"># See proxy-server.conf-sample for options</span>

<span class="k">[filter:proxy-logging]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy_logging</span>

<span class="k">[filter:catch_errors]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#catch_errors</span>
<span class="c1"># See proxy-server.conf-sample for options</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/object-server/3.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/3/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.3</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6230</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL4</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift3</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon object-server</span>

<span class="k">[app:object-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#object</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[object-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::object{replication_port}</span>

<span class="k">[object-reconstructor]</span>

<span class="k">[object-updater]</span>

<span class="k">[object-auditor]</span>

<span class="k">[object-relinker]</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/account-server/4.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/4/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.4</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6242</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL5</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift4</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon account-server</span>

<span class="k">[app:account-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#account</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[account-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::account{replication_port}</span>

<span class="k">[account-auditor]</span>

<span class="k">[account-reaper]</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/container-server/4.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/4/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.4</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6241</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL5</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift4</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon container-server</span>

<span class="k">[app:container-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#container</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[container-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::container{replication_port}</span>

<span class="k">[container-updater]</span>

<span class="k">[container-auditor]</span>

<span class="k">[container-sync]</span>

<span class="k">[container-sharder]</span>
<span class="na">auto_shard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::container{replication_port}</span>
<span class="c1"># This is intentionally much smaller than the default of 1,000,000 so tests</span>
<span class="c1"># can run in a reasonable amount of time</span>
<span class="na">shard_container_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100</span>
<span class="c1"># The probe tests make explicit assumptions about the batch sizes</span>
<span class="na">shard_scanner_batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10</span>
<span class="na">cleave_batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/container-reconciler/4.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="c1"># swift_dir = /etc/swift</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="c1"># You can specify default log routing here if you want:</span>
<span class="c1"># log_name = swift</span>
<span class="c1"># log_facility = LOG_LOCAL0</span>
<span class="c1"># log_level = INFO</span>
<span class="c1"># log_address = /dev/log</span>
<span class="c1">#</span>
<span class="c1"># comma separated list of functions to call to setup custom log handlers.</span>
<span class="c1"># functions get passed: conf, name, log_to_console, log_route, fmt, logger,</span>
<span class="c1"># adapted_logger</span>
<span class="c1"># log_custom_handlers =</span>
<span class="c1">#</span>
<span class="c1"># If set, log_udp_host will override log_address</span>
<span class="c1"># log_udp_host =</span>
<span class="c1"># log_udp_port = 514</span>
<span class="c1">#</span>
<span class="c1"># You can enable StatsD logging here:</span>
<span class="c1"># log_statsd_host =</span>
<span class="c1"># log_statsd_port = 8125</span>
<span class="c1"># log_statsd_default_sample_rate = 1.0</span>
<span class="c1"># log_statsd_sample_rate_factor = 1.0</span>
<span class="c1"># log_statsd_metric_prefix =</span>

<span class="k">[container-reconciler]</span>
<span class="c1"># reclaim_age = 604800</span>
<span class="c1"># interval = 300</span>
<span class="c1"># request_tries = 3</span>
<span class="na">processes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">4</span>
<span class="na">process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">3</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">catch_errors proxy-logging cache proxy-server</span>

<span class="k">[app:proxy-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy</span>
<span class="c1"># See proxy-server.conf-sample for options</span>

<span class="k">[filter:cache]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#memcache</span>
<span class="c1"># See proxy-server.conf-sample for options</span>

<span class="k">[filter:proxy-logging]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#proxy_logging</span>

<span class="k">[filter:catch_errors]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#catch_errors</span>
<span class="c1"># See proxy-server.conf-sample for options</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/swift/object-server/4.conf</span></code></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">devices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/srv/4/node</span>
<span class="na">mount_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
<span class="na">disable_fallocate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
<span class="na">bind_ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">127.0.0.4</span>
<span class="na">bind_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6240</span>
<span class="na">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&lt;your-user-name&gt;</span>
<span class="na">log_facility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">LOG_LOCAL5</span>
<span class="na">recon_cache_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/cache/swift4</span>
<span class="na">eventlet_debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>

<span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">healthcheck recon object-server</span>

<span class="k">[app:object-server]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#object</span>

<span class="k">[filter:recon]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#recon</span>

<span class="k">[filter:healthcheck]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#healthcheck</span>

<span class="k">[object-replicator]</span>
<span class="na">rsync_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{replication_ip}::object{replication_port}</span>

<span class="k">[object-reconstructor]</span>

<span class="k">[object-updater]</span>

<span class="k">[object-auditor]</span>

<span class="k">[object-relinker]</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="setting-up-scripts-for-running-swift">
<span id="setup-scripts"></span><h2>Setting up scripts for running Swift<a class="headerlink" href="#setting-up-scripts-for-running-swift" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Copy the SAIO scripts for resetting the environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mkdir -p $HOME/bin
cd $HOME/swift/doc; cp saio/bin/* $HOME/bin; cd -
chmod +x $HOME/bin/*
</pre></div>
</div>
</li>
<li><p>Edit the <code class="docutils literal notranslate"><span class="pre">$HOME/bin/resetswift</span></code> script</p>
<p>The template <code class="docutils literal notranslate"><span class="pre">resetswift</span></code> script looks like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nb">set</span><span class="w"> </span>-e

swift-init<span class="w"> </span>all<span class="w"> </span><span class="nb">kill</span>
swift-orphans<span class="w"> </span>-a<span class="w"> </span><span class="m">0</span><span class="w"> </span>-k<span class="w"> </span>KILL

<span class="c1"># Remove the following line if you did not set up rsyslog for individual logging:</span>
sudo<span class="w"> </span>find<span class="w"> </span>/var/log/swift<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
<span class="k">if</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="s1">&#39; &#39;</span><span class="w"> </span>-f2<span class="w"> </span>/proc/mounts<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-q<span class="w"> </span>/mnt/sdb1<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>sudo<span class="w"> </span>umount<span class="w"> </span>/mnt/sdb1
<span class="k">fi</span>
<span class="c1"># If you are using a loopback device set SAIO_BLOCK_DEVICE to &quot;/srv/swift-disk&quot;</span>
sudo<span class="w"> </span>mkfs.xfs<span class="w"> </span>-f<span class="w"> </span><span class="si">${</span><span class="nv">SAIO_BLOCK_DEVICE</span><span class="k">:-</span><span class="p">/dev/sdb1</span><span class="si">}</span>
sudo<span class="w"> </span>mount<span class="w"> </span>/mnt/sdb1
sudo<span class="w"> </span>mkdir<span class="w"> </span>/mnt/sdb1/1<span class="w"> </span>/mnt/sdb1/2<span class="w"> </span>/mnt/sdb1/3<span class="w"> </span>/mnt/sdb1/4
sudo<span class="w"> </span>chown<span class="w"> </span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span>:<span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="w"> </span>/mnt/sdb1/*
mkdir<span class="w"> </span>-p<span class="w"> </span>/srv/1/node/sdb1<span class="w"> </span>/srv/1/node/sdb5<span class="w"> </span><span class="se">\</span>
<span class="w">         </span>/srv/2/node/sdb2<span class="w"> </span>/srv/2/node/sdb6<span class="w"> </span><span class="se">\</span>
<span class="w">         </span>/srv/3/node/sdb3<span class="w"> </span>/srv/3/node/sdb7<span class="w"> </span><span class="se">\</span>
<span class="w">         </span>/srv/4/node/sdb4<span class="w"> </span>/srv/4/node/sdb8
sudo<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/var/log/debug<span class="w"> </span>/var/log/messages<span class="w"> </span>/var/log/rsyncd.log<span class="w"> </span>/var/log/syslog
find<span class="w"> </span>/var/cache/swift*<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-name<span class="w"> </span>*.recon<span class="w"> </span>-exec<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;`type -t systemctl`&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;file&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>rsyslog
<span class="w">    </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>memcached
<span class="k">else</span>
<span class="w">    </span>sudo<span class="w"> </span>service<span class="w"> </span>rsyslog<span class="w"> </span>restart
<span class="w">    </span>sudo<span class="w"> </span>service<span class="w"> </span>memcached<span class="w"> </span>restart
<span class="k">fi</span>
</pre></div>
</div>
<p>If you did not set up rsyslog for individual logging, remove the <code class="docutils literal notranslate"><span class="pre">find</span>
<span class="pre">/var/log/swift...</span></code> line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sed -i &quot;/find \/var\/log\/swift/d&quot; $HOME/bin/resetswift
</pre></div>
</div>
</li>
<li><p>Install the sample configuration file for running tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cp $HOME/swift/test/sample.conf /etc/swift/test.conf
</pre></div>
</div>
<p>The template <code class="docutils literal notranslate"><span class="pre">test.conf</span></code> looks like the following:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[s3api_test]</span>
<span class="c1"># You just enable advanced compatibility features to pass all tests.  Add the</span>
<span class="c1"># following non-default options to the s3api section of your proxy-server.conf</span>
<span class="c1"># s3_acl = True</span>
<span class="c1"># check_bucket_owner = True</span>
<span class="na">endpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">http://127.0.0.1:8080</span>
<span class="c1">#ca_cert=/path/to/ca.crt</span>
<span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">us-east-1</span>
<span class="c1"># First and second users should be account owners</span>
<span class="na">access_key1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">test:tester</span>
<span class="na">secret_key1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing</span>
<span class="na">access_key2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">test:tester2</span>
<span class="na">secret_key2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing2</span>
<span class="c1"># Third user should be unprivileged</span>
<span class="na">access_key3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">test:tester3</span>
<span class="na">secret_key3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing3</span>

<span class="k">[func_test]</span>
<span class="c1"># Sample config for Swift with tempauth</span>
<span class="na">auth_uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">http://127.0.0.1:8080/auth/v1.0</span>
<span class="c1"># Sample config for Swift with Keystone v2 API.</span>
<span class="c1"># For keystone v2 change auth_version to 2 and auth_prefix to /v2.0/.</span>
<span class="c1"># And &quot;allow_account_management&quot; should not be set &quot;true&quot;.</span>
<span class="c1">#auth_version = 3</span>
<span class="c1">#auth_uri = http://localhost:5000/v3/</span>

<span class="c1"># Used by s3api functional tests, which don&#39;t contact auth directly</span>
<span class="c1">#s3_storage_url = http://127.0.0.1:8080/</span>
<span class="c1">#s3_region = us-east-1</span>

<span class="c1"># Primary functional test account (needs admin access to the account)</span>
<span class="na">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">test</span>
<span class="na">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">tester</span>
<span class="na">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing</span>
<span class="na">s3_access_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">test:tester</span>
<span class="na">s3_secret_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing</span>

<span class="c1"># User on a second account (needs admin access to the account)</span>
<span class="na">account2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">test2</span>
<span class="na">username2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">tester2</span>
<span class="na">password2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing2</span>

<span class="c1"># User on same account as first, but without admin access</span>
<span class="na">username3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">tester3</span>
<span class="na">password3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing3</span>
<span class="c1"># s3api requires the same account with the primary one and different users</span>
<span class="c1"># one swift owner:</span>
<span class="na">s3_access_key2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">test:tester2</span>
<span class="na">s3_secret_key2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing2</span>
<span class="c1"># one unprivileged:</span>
<span class="na">s3_access_key3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">test:tester3</span>
<span class="na">s3_secret_key3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing3</span>

<span class="c1"># Fourth user is required for keystone v3 specific tests.</span>
<span class="c1"># Account must be in a non-default domain.</span>
<span class="c1">#account4 = test4</span>
<span class="c1">#username4 = tester4</span>
<span class="c1">#password4 = testing4</span>
<span class="c1">#domain4 = test-domain</span>

<span class="c1"># Fifth user is required for service token-specific tests.</span>
<span class="c1"># The account must be different from the primary test account.</span>
<span class="c1"># The user must not have a group (tempauth) or role (keystoneauth) on</span>
<span class="c1"># the primary test account. The user must have a group/role that is unique</span>
<span class="c1"># and not given to the primary tester and is specified in the options</span>
<span class="c1"># &lt;prefix&gt;_require_group (tempauth) or &lt;prefix&gt;_service_roles (keystoneauth).</span>
<span class="c1">#account5 = test5</span>
<span class="c1">#username5 = tester5</span>
<span class="c1">#password5 = testing5</span>

<span class="c1"># The service_prefix option is used for service token-specific tests.</span>
<span class="c1"># If service_prefix or username5 above is not supplied, the tests are skipped.</span>
<span class="c1"># To set the value and enable the service token tests, look at the</span>
<span class="c1"># reseller_prefix option in /etc/swift/proxy-server.conf. There must be at</span>
<span class="c1"># least two prefixes. If not, add a prefix as follows (where we add SERVICE):</span>
<span class="c1">#     reseller_prefix = AUTH, SERVICE</span>
<span class="c1"># The service_prefix must match the &lt;prefix&gt; used in &lt;prefix&gt;_require_group</span>
<span class="c1"># (tempauth) or &lt;prefix&gt;_service_roles (keystoneauth); for example:</span>
<span class="c1">#    SERVICE_require_group = service</span>
<span class="c1">#    SERVICE_service_roles = service</span>
<span class="c1"># Note: Do not enable service token tests if the first prefix in</span>
<span class="c1"># reseller_prefix is the empty prefix AND the primary functional test</span>
<span class="c1"># account contains an underscore.</span>
<span class="c1">#service_prefix = SERVICE</span>

<span class="c1"># Sixth user is required for access control tests.</span>
<span class="c1"># Account must have a role for reseller_admin_role(keystoneauth).</span>
<span class="c1">#account6 = test</span>
<span class="c1">#username6 = tester6</span>
<span class="c1">#password6 = testing6</span>

<span class="na">collate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">C</span>

<span class="c1"># Only necessary if a pre-existing server uses self-signed certificate</span>
<span class="na">insecure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">no</span>

<span class="c1"># Tests that are dependent on domain_remap middleware being installed also</span>
<span class="c1"># require one of the domain_remap storage_domain values to be specified here,</span>
<span class="c1"># otherwise those tests will be skipped.</span>
<span class="na">storage_domain</span><span class="w"> </span><span class="o">=</span>

<span class="k">[unit_test]</span>
<span class="na">fake_syslog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">False</span>

<span class="k">[probe_test]</span>
<span class="c1"># check_server_timeout = 30</span>
<span class="c1"># validate_rsync = false</span>
<span class="c1"># proxy_base_url = http://localhost:8080</span>

<span class="k">[swift-constraints]</span>
<span class="c1"># The functional test runner will try to use the constraint values provided in</span>
<span class="c1"># the swift-constraints section of test.conf.</span>
<span class="c1">#</span>
<span class="c1"># If a constraint value does not exist in that section, or because the</span>
<span class="c1"># swift-constraints section does not exist, the constraints values found in</span>
<span class="c1"># the /info API call (if successful) will be used.</span>
<span class="c1">#</span>
<span class="c1"># If a constraint value cannot be found in the /info results, either because</span>
<span class="c1"># the /info API call failed, or a value is not present, the constraint value</span>
<span class="c1"># used will fall back to those loaded by the constraints module at time of</span>
<span class="c1"># import (which will attempt to load /etc/swift/swift.conf, see the</span>
<span class="c1"># swift.common.constraints module for more information).</span>
<span class="c1">#</span>
<span class="c1"># Note that the cluster must have &quot;sane&quot; values for the test suite to pass</span>
<span class="c1"># (for some definition of sane).</span>
<span class="c1">#</span>
<span class="c1">#max_file_size = 5368709122</span>
<span class="c1">#max_meta_name_length = 128</span>
<span class="c1">#max_meta_value_length = 256</span>
<span class="c1">#max_meta_count = 90</span>
<span class="c1">#max_meta_overall_size = 4096</span>
<span class="c1">#max_header_size = 8192</span>
<span class="c1">#extra_header_count = 0</span>
<span class="c1">#max_object_name_length = 1024</span>
<span class="c1">#container_listing_limit = 10000</span>
<span class="c1">#account_listing_limit = 10000</span>
<span class="c1">#max_account_name_length = 256</span>
<span class="c1">#max_container_name_length = 256</span>

<span class="c1"># Newer swift versions default to strict cors mode, but older ones were the</span>
<span class="c1"># opposite.</span>
<span class="c1">#strict_cors_mode = true</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="configure-environment-variables-for-swift">
<h2>Configure environment variables for Swift<a class="headerlink" href="#configure-environment-variables-for-swift" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Add an environment variable for running tests below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>echo &quot;export SWIFT_TEST_CONFIG_FILE=/etc/swift/test.conf&quot; &gt;&gt; $HOME/.bashrc
</pre></div>
</div>
</li>
<li><p>Be sure that your <code class="docutils literal notranslate"><span class="pre">PATH</span></code> includes the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>echo &quot;export PATH=${PATH}:$HOME/bin&quot; &gt;&gt; $HOME/.bashrc
</pre></div>
</div>
</li>
<li><p>If you are using a loopback device for Swift Storage, add an environment var
to substitute <code class="docutils literal notranslate"><span class="pre">/dev/sdb1</span></code> with <code class="docutils literal notranslate"><span class="pre">/srv/swift-disk</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>echo &quot;export SAIO_BLOCK_DEVICE=/srv/swift-disk&quot; &gt;&gt; $HOME/.bashrc
</pre></div>
</div>
</li>
<li><p>If you are using a device other than <code class="docutils literal notranslate"><span class="pre">/dev/sdb1</span></code> for Swift storage (for
example, <code class="docutils literal notranslate"><span class="pre">/dev/vdb1</span></code>), add an environment var to substitute it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>echo &quot;export SAIO_BLOCK_DEVICE=/dev/vdb1&quot; &gt;&gt; $HOME/.bashrc
</pre></div>
</div>
</li>
<li><p>If you are using a location other than <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> for Swift tmp data (for
example, <code class="docutils literal notranslate"><span class="pre">/mnt/tmp</span></code>), add <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code> environment var to set it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export TMPDIR=/mnt/tmp
echo &quot;export TMPDIR=/mnt/tmp&quot; &gt;&gt; $HOME/.bashrc
</pre></div>
</div>
</li>
<li><p>Source the above environment variables into your current environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>. $HOME/.bashrc
</pre></div>
</div>
</li>
</ol>
</section>
<section id="constructing-initial-rings">
<h2>Constructing initial rings<a class="headerlink" href="#constructing-initial-rings" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Construct the initial rings using the provided script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">remakerings</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">remakerings</span></code> script looks like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nb">set</span><span class="w"> </span>-e

<span class="nb">cd</span><span class="w"> </span>/etc/swift

rm<span class="w"> </span>-f<span class="w"> </span>*.builder<span class="w"> </span>*.ring.gz<span class="w"> </span>backups/*.builder<span class="w"> </span>backups/*.ring.gz

swift-ring-builder<span class="w"> </span>object.builder<span class="w"> </span>create<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object.builder<span class="w"> </span>add<span class="w"> </span>r1z1-127.0.0.1:6210/sdb1<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object.builder<span class="w"> </span>add<span class="w"> </span>r1z2-127.0.0.2:6220/sdb2<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object.builder<span class="w"> </span>add<span class="w"> </span>r1z3-127.0.0.3:6230/sdb3<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object.builder<span class="w"> </span>add<span class="w"> </span>r1z4-127.0.0.4:6240/sdb4<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object.builder<span class="w"> </span>rebalance
swift-ring-builder<span class="w"> </span>object-1.builder<span class="w"> </span>create<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-1.builder<span class="w"> </span>add<span class="w"> </span>r1z1-127.0.0.1:6210/sdb1<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-1.builder<span class="w"> </span>add<span class="w"> </span>r1z2-127.0.0.2:6220/sdb2<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-1.builder<span class="w"> </span>add<span class="w"> </span>r1z3-127.0.0.3:6230/sdb3<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-1.builder<span class="w"> </span>add<span class="w"> </span>r1z4-127.0.0.4:6240/sdb4<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-1.builder<span class="w"> </span>rebalance
swift-ring-builder<span class="w"> </span>object-2.builder<span class="w"> </span>create<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-2.builder<span class="w"> </span>add<span class="w"> </span>r1z1-127.0.0.1:6210/sdb1<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-2.builder<span class="w"> </span>add<span class="w"> </span>r1z1-127.0.0.1:6210/sdb5<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-2.builder<span class="w"> </span>add<span class="w"> </span>r1z2-127.0.0.2:6220/sdb2<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-2.builder<span class="w"> </span>add<span class="w"> </span>r1z2-127.0.0.2:6220/sdb6<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-2.builder<span class="w"> </span>add<span class="w"> </span>r1z3-127.0.0.3:6230/sdb3<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-2.builder<span class="w"> </span>add<span class="w"> </span>r1z3-127.0.0.3:6230/sdb7<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-2.builder<span class="w"> </span>add<span class="w"> </span>r1z4-127.0.0.4:6240/sdb4<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-2.builder<span class="w"> </span>add<span class="w"> </span>r1z4-127.0.0.4:6240/sdb8<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>object-2.builder<span class="w"> </span>rebalance
swift-ring-builder<span class="w"> </span>container.builder<span class="w"> </span>create<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>container.builder<span class="w"> </span>add<span class="w"> </span>r1z1-127.0.0.1:6211/sdb1<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>container.builder<span class="w"> </span>add<span class="w"> </span>r1z2-127.0.0.2:6221/sdb2<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>container.builder<span class="w"> </span>add<span class="w"> </span>r1z3-127.0.0.3:6231/sdb3<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>container.builder<span class="w"> </span>add<span class="w"> </span>r1z4-127.0.0.4:6241/sdb4<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>container.builder<span class="w"> </span>rebalance
swift-ring-builder<span class="w"> </span>account.builder<span class="w"> </span>create<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>account.builder<span class="w"> </span>add<span class="w"> </span>r1z1-127.0.0.1:6212/sdb1<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>account.builder<span class="w"> </span>add<span class="w"> </span>r1z2-127.0.0.2:6222/sdb2<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>account.builder<span class="w"> </span>add<span class="w"> </span>r1z3-127.0.0.3:6232/sdb3<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>account.builder<span class="w"> </span>add<span class="w"> </span>r1z4-127.0.0.4:6242/sdb4<span class="w"> </span><span class="m">1</span>
swift-ring-builder<span class="w"> </span>account.builder<span class="w"> </span>rebalance
</pre></div>
</div>
<p>You can expect the output from this command to produce the following.  Note
that 3 object rings are created in order to test storage policies and EC in
the SAIO environment.  The EC ring is the only one with all 8 devices.
There are also two replication rings, one for 3x replication and another
for 2x replication, but those rings only use 4 devices:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Device d0r1z1-127.0.0.1:6210R127.0.0.1:6210/sdb1_&quot;&quot; with 1.0 weight got id 0</span>
<span class="go">Device d1r1z2-127.0.0.2:6220R127.0.0.2:6220/sdb2_&quot;&quot; with 1.0 weight got id 1</span>
<span class="go">Device d2r1z3-127.0.0.3:6230R127.0.0.3:6230/sdb3_&quot;&quot; with 1.0 weight got id 2</span>
<span class="go">Device d3r1z4-127.0.0.4:6240R127.0.0.4:6240/sdb4_&quot;&quot; with 1.0 weight got id 3</span>
<span class="go">Reassigned 3072 (300.00%) partitions. Balance is now 0.00.  Dispersion is now 0.00</span>
<span class="go">Device d0r1z1-127.0.0.1:6210R127.0.0.1:6210/sdb1_&quot;&quot; with 1.0 weight got id 0</span>
<span class="go">Device d1r1z2-127.0.0.2:6220R127.0.0.2:6220/sdb2_&quot;&quot; with 1.0 weight got id 1</span>
<span class="go">Device d2r1z3-127.0.0.3:6230R127.0.0.3:6230/sdb3_&quot;&quot; with 1.0 weight got id 2</span>
<span class="go">Device d3r1z4-127.0.0.4:6240R127.0.0.4:6240/sdb4_&quot;&quot; with 1.0 weight got id 3</span>
<span class="go">Reassigned 2048 (200.00%) partitions. Balance is now 0.00.  Dispersion is now 0.00</span>
<span class="go">Device d0r1z1-127.0.0.1:6210R127.0.0.1:6210/sdb1_&quot;&quot; with 1.0 weight got id 0</span>
<span class="go">Device d1r1z1-127.0.0.1:6210R127.0.0.1:6210/sdb5_&quot;&quot; with 1.0 weight got id 1</span>
<span class="go">Device d2r1z2-127.0.0.2:6220R127.0.0.2:6220/sdb2_&quot;&quot; with 1.0 weight got id 2</span>
<span class="go">Device d3r1z2-127.0.0.2:6220R127.0.0.2:6220/sdb6_&quot;&quot; with 1.0 weight got id 3</span>
<span class="go">Device d4r1z3-127.0.0.3:6230R127.0.0.3:6230/sdb3_&quot;&quot; with 1.0 weight got id 4</span>
<span class="go">Device d5r1z3-127.0.0.3:6230R127.0.0.3:6230/sdb7_&quot;&quot; with 1.0 weight got id 5</span>
<span class="go">Device d6r1z4-127.0.0.4:6240R127.0.0.4:6240/sdb4_&quot;&quot; with 1.0 weight got id 6</span>
<span class="go">Device d7r1z4-127.0.0.4:6240R127.0.0.4:6240/sdb8_&quot;&quot; with 1.0 weight got id 7</span>
<span class="go">Reassigned 6144 (600.00%) partitions. Balance is now 0.00.  Dispersion is now 0.00</span>
<span class="go">Device d0r1z1-127.0.0.1:6211R127.0.0.1:6211/sdb1_&quot;&quot; with 1.0 weight got id 0</span>
<span class="go">Device d1r1z2-127.0.0.2:6221R127.0.0.2:6221/sdb2_&quot;&quot; with 1.0 weight got id 1</span>
<span class="go">Device d2r1z3-127.0.0.3:6231R127.0.0.3:6231/sdb3_&quot;&quot; with 1.0 weight got id 2</span>
<span class="go">Device d3r1z4-127.0.0.4:6241R127.0.0.4:6241/sdb4_&quot;&quot; with 1.0 weight got id 3</span>
<span class="go">Reassigned 3072 (300.00%) partitions. Balance is now 0.00.  Dispersion is now 0.00</span>
<span class="go">Device d0r1z1-127.0.0.1:6212R127.0.0.1:6212/sdb1_&quot;&quot; with 1.0 weight got id 0</span>
<span class="go">Device d1r1z2-127.0.0.2:6222R127.0.0.2:6222/sdb2_&quot;&quot; with 1.0 weight got id 1</span>
<span class="go">Device d2r1z3-127.0.0.3:6232R127.0.0.3:6232/sdb3_&quot;&quot; with 1.0 weight got id 2</span>
<span class="go">Device d3r1z4-127.0.0.4:6242R127.0.0.4:6242/sdb4_&quot;&quot; with 1.0 weight got id 3</span>
<span class="go">Reassigned 3072 (300.00%) partitions. Balance is now 0.00.  Dispersion is now 0.00</span>
</pre></div>
</div>
</li>
<li><p>Read more about Storage Policies and your SAIO <a class="reference internal" href="policies_saio.html"><span class="doc">Adding Storage Policies to an Existing SAIO</span></a></p></li>
</ol>
</section>
<section id="testing-swift">
<h2>Testing Swift<a class="headerlink" href="#testing-swift" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Verify the unit tests run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$HOME/swift/.unittests
</pre></div>
</div>
<p>Note that the unit tests do not require any Swift daemons running.</p>
</li>
<li><p>Start the “main” Swift daemon processes (proxy, account, container, and
object):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">startmain</span>
</pre></div>
</div>
<p>(The “<code class="docutils literal notranslate"><span class="pre">Unable</span> <span class="pre">to</span> <span class="pre">increase</span> <span class="pre">file</span> <span class="pre">descriptor</span> <span class="pre">limit.</span>&#160; <span class="pre">Running</span> <span class="pre">as</span> <span class="pre">non-root?</span></code>”
warnings are expected and ok.)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">startmain</span></code> script looks like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nb">set</span><span class="w"> </span>-e

swift-init<span class="w"> </span>main<span class="w"> </span>start
</pre></div>
</div>
</li>
<li><p>Get an <code class="docutils literal notranslate"><span class="pre">X-Storage-Url</span></code> and <code class="docutils literal notranslate"><span class="pre">X-Auth-Token</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Storage-User: test:tester&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Storage-Pass: testing&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">auth</span><span class="o">/</span><span class="n">v1</span><span class="mf">.0</span>
</pre></div>
</div>
</li>
<li><p>Check that you can <code class="docutils literal notranslate"><span class="pre">GET</span></code> account:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Auth-Token: &lt;token-from-x-auth-token-above&gt;&#39;</span> <span class="o">&lt;</span><span class="n">url</span><span class="o">-</span><span class="n">from</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">storage</span><span class="o">-</span><span class="n">url</span><span class="o">-</span><span class="n">above</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>Check that <code class="docutils literal notranslate"><span class="pre">swift</span></code> command provided by the python-swiftclient package works:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="o">-</span><span class="n">A</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">auth</span><span class="o">/</span><span class="n">v1</span><span class="mf">.0</span> <span class="o">-</span><span class="n">U</span> <span class="n">test</span><span class="p">:</span><span class="n">tester</span> <span class="o">-</span><span class="n">K</span> <span class="n">testing</span> <span class="n">stat</span>
</pre></div>
</div>
</li>
<li><p>Verify the functional tests run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$HOME/swift/.functests
</pre></div>
</div>
<p>(Note: functional tests will first delete everything in the configured
accounts.)</p>
</li>
<li><p>Verify the probe tests run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$HOME/swift/.probetests
</pre></div>
</div>
<p>(Note: probe tests will reset your environment as they call <code class="docutils literal notranslate"><span class="pre">resetswift</span></code>
for each test.)</p>
</li>
</ol>
</section>
<section id="debugging-issues">
<h2>Debugging Issues<a class="headerlink" href="#debugging-issues" title="Permalink to this heading">¶</a></h2>
<p>If all doesn’t go as planned, and tests fail, or you can’t auth, or something
doesn’t work, here are some good starting places to look for issues:</p>
<ol class="arabic simple">
<li><p>Everything is logged using system facilities – usually in <code class="docutils literal notranslate"><span class="pre">/var/log/syslog</span></code>,
but possibly in <code class="docutils literal notranslate"><span class="pre">/var/log/messages</span></code> on e.g. Fedora – so that is a good first
place to look for errors (most likely python tracebacks).</p></li>
<li><p>Make sure all of the server processes are running.  For the base
functionality, the Proxy, Account, Container, and Object servers
should be running.</p></li>
<li><p>If one of the servers are not running, and no errors are logged to syslog,
it may be useful to try to start the server manually, for example:
<code class="docutils literal notranslate"><span class="pre">swift-object-server</span> <span class="pre">/etc/swift/object-server/1.conf</span></code> will start the
object server.  If there are problems not showing up in syslog,
then you will likely see the traceback on startup.</p></li>
<li><p>If you need to, you can turn off syslog for unit tests. This can be
useful for environments where <code class="docutils literal notranslate"><span class="pre">/dev/log</span></code> is unavailable, or which
cannot rate limit (unit tests generate a lot of logs very quickly).
Open the file <code class="docutils literal notranslate"><span class="pre">SWIFT_TEST_CONFIG_FILE</span></code> points to, and change the
value of <code class="docutils literal notranslate"><span class="pre">fake_syslog</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p>If you encounter a <code class="docutils literal notranslate"><span class="pre">401</span> <span class="pre">Unauthorized</span></code> when following Step 12 where
you check that you can <code class="docutils literal notranslate"><span class="pre">GET</span></code> account, use <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">service</span> <span class="pre">memcached</span> <span class="pre">status</span></code>
and check if memcache is running. If memcache is not running, start it using
<code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">service</span> <span class="pre">memcached</span> <span class="pre">start</span></code>. Once memcache is running, rerun <code class="docutils literal notranslate"><span class="pre">GET</span></code> account.</p></li>
</ol>
</section>
<section id="known-issues">
<h2>Known Issues<a class="headerlink" href="#known-issues" title="Permalink to this heading">¶</a></h2>
<p>Listed here are some “gotcha’s” that you may run into when using or testing your SAIO:</p>
<ol class="arabic simple">
<li><p>fallocate_reserve - in most cases a SAIO doesn’t have a very large XFS partition
so having fallocate enabled and fallocate_reserve set can cause issues, specifically
when trying to run the functional tests. For this reason fallocate has been turned
off on the object-servers in the SAIO. If you want to play with the fallocate_reserve
settings then know that functional tests will fail unless you change the max_file_size
constraint to something more reasonable then the default (5G). Ideally you’d make
it 1/4 of your XFS file system size so the tests can pass.</p></li>
</ol>
</section>
</section>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="development_guidelines.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Development Guidelines"></i></a>
          
          
            <a href="first_contribution_swift.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: First Contribution to Swift"></i></a>
          
          <a id="pdfLink2" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">this page last updated: 2023-03-24 14:11:44</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="https://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the
                 document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="OpenStack Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/id/">Bahasa Indonesia (Indonesian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/it/">Italiano (Italian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/tr_TR/">Türkçe (Türkiye)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Swift 0.1.0.dev10162</h4></a>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/object_api_v1_overview.html">Object Storage API overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_architecture.html">Swift Architectural Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_ring.html">The Rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_policies.html">Storage Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_reaper.html">The Account Reaper</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_auth.html">The Auth System</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_acl.html">Access Control Lists (ACLs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_replication.html">Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="ratelimit.html">Rate Limiting</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_large_objects.html">Large Object Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_global_cluster.html">Global Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_container_sync.html">Container to Container Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_expiring_objects.html">Expiring Object Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="cors.html">CORS</a></li>
<li class="toctree-l1"><a class="reference internal" href="crossdomain.html">Cross-domain Policy File</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_erasure_code.html">Erasure Code Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_encryption.html">Object Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_backing_store.html">Using Swift as Backing Store for Service Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_container_sharding.html">Container Sharding</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_background.html">Building a Consistent Hashing Ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_partpower.html">Modifying Ring Partition Power</a></li>
<li class="toctree-l1"><a class="reference internal" href="associated_projects.html">Associated Projects</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html">Contributing to OpenStack Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#swift-design-principles">Swift Design Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#recommended-workflow">Recommended workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#notes-on-testing">Notes on Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#ideas">Ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#community">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/review_guidelines.html">Review Guidelines</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="development_guidelines.html">Development Guidelines</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SAIO (Swift All In One)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#instructions-for-setting-up-a-development-vm">Instructions for setting up a development VM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-s-in-a-your-user-name">What’s in a &lt;your-user-name&gt;</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-dependencies">Installing dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-storage">Configuring storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-the-code">Getting the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-rsync">Setting up rsync</a></li>
<li class="toctree-l2"><a class="reference internal" href="#starting-memcached">Starting memcached</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optional-setting-up-rsyslog-for-individual-logging">Optional: Setting up rsyslog for individual logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-each-node">Configuring each node</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-scripts-for-running-swift">Setting up scripts for running Swift</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-environment-variables-for-swift">Configure environment variables for Swift</a></li>
<li class="toctree-l2"><a class="reference internal" href="#constructing-initial-rings">Constructing initial rings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-swift">Testing Swift</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debugging-issues">Debugging Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="first_contribution_swift.html">First Contribution to Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies_saio.html">Adding Storage Policies to an Existing SAIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_auth.html">Auth Server and Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_middleware.html">Middleware and Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_ondisk_backends.html">Pluggable On-Disk Back-end APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_watchers.html">Auditor Watchers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deployment_guide.html">Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_deployment_guide.html">Apache Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin_guide.html">Administrator’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="replication_network.html">Dedicated replication network</a></li>
<li class="toctree-l1"><a class="reference internal" href="logs.html">Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops_runbook/index.html">Swift Ops Runbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin/index.html">OpenStack Swift Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="install/index.html">Object Storage Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="config/index.html">Configuration Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/object_api_v1_overview.html">Object Storage API overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/discoverability.html">Discoverability</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/container_quotas.html">Container quotas</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/object_versioning.html">Object versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/large_objects.html">Large objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/temporary_url_middleware.html">Temporary URL middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/form_post_middleware.html">Form POST middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/use_content-encoding_metadata.html">Use Content-Encoding metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/use_the_content-disposition_metadata.html">Use the Content-Disposition metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pseudo-hierarchical-folders-directories.html">Pseudo-hierarchical folders and directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pagination.html">Page through large lists of containers or objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/serialized-response-formats.html">Serialized response formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/static-website.html">Create static website</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/object-expiration.html">Object expiration</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/bulk-delete.html">Bulk delete</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="s3_compat.html">S3/Swift REST API Comparison Matrix</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ring.html">Partitioned Consistent Hash Ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy.html">Proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="account.html">Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="container.html">Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="db.html">Account DB and Container DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="object.html">Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="middleware.html">Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="audit_watchers.html">Object Audit Watchers</a></li>
</ul>

    </div>

  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="local-table-of-contents">
      <h4 class="docs-sidebar-section-title">Page Contents</h4>
      <ul>
<li><a class="reference internal" href="#">SAIO (Swift All In One)</a><ul>
<li><a class="reference internal" href="#instructions-for-setting-up-a-development-vm">Instructions for setting up a development VM</a></li>
<li><a class="reference internal" href="#what-s-in-a-your-user-name">What’s in a &lt;your-user-name&gt;</a></li>
<li><a class="reference internal" href="#installing-dependencies">Installing dependencies</a></li>
<li><a class="reference internal" href="#configuring-storage">Configuring storage</a><ul>
<li><a class="reference internal" href="#using-a-partition-for-storage">Using a partition for storage</a></li>
<li><a class="reference internal" href="#using-a-loopback-device-for-storage">Using a loopback device for storage</a></li>
<li><a class="reference internal" href="#common-post-device-setup">Common Post-Device Setup</a><ul>
<li><a class="reference internal" href="#creating-an-xfs-tmp-dir">Creating an XFS tmp dir</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#getting-the-code">Getting the code</a></li>
<li><a class="reference internal" href="#setting-up-rsync">Setting up rsync</a></li>
<li><a class="reference internal" href="#starting-memcached">Starting memcached</a></li>
<li><a class="reference internal" href="#optional-setting-up-rsyslog-for-individual-logging">Optional: Setting up rsyslog for individual logging</a></li>
<li><a class="reference internal" href="#configuring-each-node">Configuring each node</a></li>
<li><a class="reference internal" href="#setting-up-scripts-for-running-swift">Setting up scripts for running Swift</a></li>
<li><a class="reference internal" href="#configure-environment-variables-for-swift">Configure environment variables for Swift</a></li>
<li><a class="reference internal" href="#constructing-initial-rings">Constructing initial rings</a></li>
<li><a class="reference internal" href="#testing-swift">Testing Swift</a></li>
<li><a class="reference internal" href="#debugging-issues">Debugging Issues</a></li>
<li><a class="reference internal" href="#known-issues">Known Issues</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="https://openstack.org/projects/">Projects</a></li>
          <li><a href="https://www.openstack.org/software/security/">OpenStack Security</a></li>
          <li><a href="https://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="https://openstack.org/blog/">Blog</a></li>g
          <li><a href="https://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="https://openstack.org/community/">User Groups</a></li>
          <li><a href="https://openstack.org/community/events/">Events</a></li>
          <li><a href="https://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="https://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="https://docs.openstack.org/contributors">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="https://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="https://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="https://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="https://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="https://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="https://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="https://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-3.2.1.min.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- standard sphinx include libraries, which allow search highlighting -->
<script type="text/javascript" src="_static/underscore.js"></script>
<script type="text/javascript" src="_static/doctools.js"></script>
<script type="text/javascript" src="_static/searchtools.js"></script>
<script type="text/javascript" src="_static/language_data.js"></script>

<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.1.0.dev10162',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      LINK_SUFFIX: '.html',
      SOURCELINK_SUFFIX: '.txt',
      HAS_SOURCE:  true
    };
</script>

<!-- Javascript for page -->
<script language="JavaScript">
  /* Build a description of this page including SHA, source location on git
   * repo, build time and the project's launchpad bug tag. Set the HREF of the
   * bug buttons
   */
    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
    /* "giturl" is the URL of the source file on Git and is auto-generated by
     * openstackdocstheme.
     *
     * "pagename" is a standard sphinx parameter containing the name of
     * the source file, without extension.
     */

    var sourceFile = "development_saio" + ".rst";
    gitURL = "Source: https://opendev.org/openstack/swift/src/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: a7004f079a695309fcf8adab383f12c91fb86576";
    var repositoryName = "openstack/swift";
    var bugProject = "swift";
    var bugTitle = "SAIO (Swift All In One) in Swift";
    var fieldTags = "";
    var useStoryboard = "";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.1.0.dev10162 on 2023-03-24 14:11:44";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags, repositoryName, useStoryboard);
    var currentSourceFile = "development_saio";
    var pdfFileName = "doc-swift.pdf";
    pdfLink(currentSourceFile, pdfFileName);
</script>


  </body>
</html>