
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Container &#8212; Swift 0.1.0.dev10164 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/basic.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="canonical" href="/openstack-swift/container.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Account DB and Container DB" href="db.html" />
    <link rel="prev" title="Account" href="account.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">

<!-- Search CSS -->
<link href="_static/css/search.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/pygments.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


  </head><body>

<!-- SOURCE_FILE: https://opendev.org/openstack/swift/src/doc/source/container.rst -->

<script>
    (function (window, document) {
        var loader = function () {
            var script = document.createElement("script"), tag = document.getElementsByTagName("script")[0];
            script.src = "https://search.openstack.org/widget/embed.min.js?t="+Date.now();
            tag.parentNode.insertBefore(script, tag);
        };
        window.addEventListener ? window.addEventListener("load", loader, false) : window.attachEvent("onload", loader);
    })(window, document);
</script>

<nav class="navbar navbar-default" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="https://www.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</div>
      <ul class="nav navbar-nav navbar-main show">
        <li class="search-container-mobile">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</li>
        <li> <!--Software -->
          <a href="https://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/openstack-components">OpenStack Components</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/sdks">SDKs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/deployment-tools">Deployment Tools</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/assets/software/projectmap/openstack-map.pdf" target="_blank">OpenStack Map</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
          </ul>
        </li>
        <li> <!-- Use Cases -->
          <a href="https://www.openstack.org/use-cases/" class="drop" id="dropdownMenuUsers">Use Cases <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/">Users in Production</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/bare-metal/">Ironic Bare Metal</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/edge-computing/">Edge Computing</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/telecoms-and-nfv/">Telecom & NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/science/">Science and HPC</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/containers/">Containers</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/enterprise/">Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li> <!-- Events -->
          <a href="https://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">Open Infrastructure Summits</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/ptg/">Project Teams Gathering</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/opendev-2020/">OpenDev</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/community-events/">Community Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/openstackdays">OpenStack & OpenInfra Days</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
          </ul>
        </li>
        <li><!-- Community -->
          <a href="https://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/tech-committee">OpenStack Technical Committee</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/coa/">Get Certified (COA)</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketing/">Marketing Resources</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/news/">Community News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/supporting-organizations/">OpenInfra Foundation Supporting Organizations</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">Open Infrastructure Foundation (OpenInfra Foundation)</a></li>
          </ul>
        </li>
        <li><!-- Marketplace -->
          <a href="https://www.openstack.orgmarketplace/" class="drop" id="dropdownMenuLearn">Marketplace <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/distros/">Distros & Appliances</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/public-clouds/">Public Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/hosted-private-clouds/">Hosted Private Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/remotely-managed-private-clouds/">Remotely Managed Private Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/consulting/">Consulting & Integrators</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/drivers/">Drivers</a></li>
          </ul>
        </li>
        <li><!-- Blog -->
          <a href="https://www.openstack.org/blog/">Blog</a>
        </li>
        <li><!-- Docs -->
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
        <li> <!-- Join -->
            <li class="join-nav-section">
              <a href="https://openinfra.dev/join/" id="dropdownMenuJoin">Join <i class="fa fa-caret-down"></i></a>
              <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuJoin" style="display: none;">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sign up for Foundation Membership</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sponsor the Foundation</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">More about the Foundation</a></li>
              </ul>
            </li>
            <li>
              <a href="https://www.openstack.org/Security/login/?BackURL=/home/" class="sign-in-btn">Log In</a>
            </li>
        </li>
      </ul>
    </div>
  </div>
  <!-- /.container -->
</nav>

    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row docs-title">
  <div class="col-lg-8">
      <h1>Container</h1>
    
  </div>
  <div class="docs-actions">
    
    <a href="account.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Account"></i></a>
    
    
    <a href="db.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Account DB and Container DB"></i></a>
    
    <a id="pdfLink1" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
    
  </div>
</div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-body" role="main">

  <section id="container">
<span id="id1"></span><h1>Container<a class="headerlink" href="#container" title="Permalink to this heading">¶</a></h1>
<section id="module-swift.container.auditor">
<span id="id2"></span><span id="container-auditor"></span><h2>Container Auditor<a class="headerlink" href="#module-swift.container.auditor" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.container.auditor.ContainerAuditor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.auditor.</span></span><span class="sig-name descname"><span class="pre">ContainerAuditor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.auditor.ContainerAuditor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DatabaseAuditor</span></code></p>
<p>Audit containers.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.auditor.ContainerAuditor.broker_class">
<span class="sig-name descname"><span class="pre">broker_class</span></span><a class="headerlink" href="#swift.container.auditor.ContainerAuditor.broker_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#swift.container.backend.ContainerBroker" title="swift.container.backend.ContainerBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.auditor.ContainerAuditor.server_type">
<span class="sig-name descname"><span class="pre">server_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'container'</span></em><a class="headerlink" href="#swift.container.auditor.ContainerAuditor.server_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-swift.container.backend">
<span id="id3"></span><span id="container-backend"></span><h2>Container Backend<a class="headerlink" href="#module-swift.container.backend" title="Permalink to this heading">¶</a></h2>
<p>Pluggable Back-ends for Container Server</p>
<dl class="py class">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.backend.</span></span><span class="sig-name descname"><span class="pre">ContainerBroker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pending_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stale_reads_ok</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_commits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_db_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="db.html#swift.common.db.DatabaseBroker" title="swift.common.db.DatabaseBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatabaseBroker</span></code></a></p>
<p>Encapsulates working with a container database.</p>
<p>Note that this may involve multiple on-disk DB files if the container
becomes sharded:</p>
<ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">_db_file</span></code> is the path to the legacy container DB name, i.e.
<code class="docutils literal notranslate"><span class="pre">&lt;hash&gt;.db</span></code>. This file should exist for an initialised broker that
has never been sharded, but will not exist once a container has been
sharded.</p></li>
<li><p><a class="reference internal" href="#swift.container.backend.ContainerBroker.db_files" title="swift.container.backend.ContainerBroker.db_files"><code class="xref py py-attr docutils literal notranslate"><span class="pre">db_files</span></code></a> is a list of existing db files for the broker. This
list should have at least one entry for an initialised broker, and
should have two entries while a broker is in SHARDING state.</p></li>
<li><p><a class="reference internal" href="#swift.container.backend.ContainerBroker.db_file" title="swift.container.backend.ContainerBroker.db_file"><code class="xref py py-attr docutils literal notranslate"><span class="pre">db_file</span></code></a> is the path to whichever db is currently authoritative
for the container. Depending on the container’s state, this may not be
the same as the <code class="docutils literal notranslate"><span class="pre">db_file</span></code> argument given to <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>, unless
<code class="docutils literal notranslate"><span class="pre">force_db_file</span></code> is True in which case <a class="reference internal" href="#swift.container.backend.ContainerBroker.db_file" title="swift.container.backend.ContainerBroker.db_file"><code class="xref py py-attr docutils literal notranslate"><span class="pre">db_file</span></code></a> is always equal
to the <code class="docutils literal notranslate"><span class="pre">db_file</span></code> argument given to <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">pending_file</span></code> is always equal to <code class="xref py py-attr docutils literal notranslate"><span class="pre">_db_file</span></code> extended with
<code class="docutils literal notranslate"><span class="pre">.pending</span></code>, i.e. <code class="docutils literal notranslate"><span class="pre">&lt;hash&gt;.db.pending</span></code>.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.create_broker">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_broker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">put_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_policy_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.create_broker" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ContainerBroker instance. If the db doesn’t exist, initialize
the db file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device_path</strong> – device path</p></li>
<li><p><strong>part</strong> – partition number</p></li>
<li><p><strong>account</strong> – account name string</p></li>
<li><p><strong>container</strong> – container name string</p></li>
<li><p><strong>logger</strong> – a logger instance</p></li>
<li><p><strong>epoch</strong> – a timestamp to include in the db filename</p></li>
<li><p><strong>put_timestamp</strong> – initial timestamp if broker needs to be
initialized</p></li>
<li><p><strong>storage_policy_index</strong> – the storage policy index</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of (<code class="docutils literal notranslate"><span class="pre">broker</span></code>, <code class="docutils literal notranslate"><span class="pre">initialized</span></code>) where <code class="docutils literal notranslate"><span class="pre">broker</span></code> is
an instance of <a class="reference internal" href="#swift.container.backend.ContainerBroker" title="swift.container.backend.ContainerBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">swift.container.backend.ContainerBroker</span></code></a> and
<code class="docutils literal notranslate"><span class="pre">initialized</span></code> is True if the db file was initialized, False
otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.create_container_info_table">
<span class="sig-name descname"><span class="pre">create_container_info_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">put_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_policy_index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.create_container_info_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the container_info table which is specific to the container DB.
Not a part of Pluggable Back-ends, internal to the baseline code.
Also creates the container_stat view.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conn</strong> – DB connection object</p></li>
<li><p><strong>put_timestamp</strong> – put timestamp</p></li>
<li><p><strong>storage_policy_index</strong> – storage policy index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.create_object_table">
<span class="sig-name descname"><span class="pre">create_object_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.create_object_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the object table which is specific to the container DB.
Not a part of Pluggable Back-ends, internal to the baseline code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conn</strong> – DB connection object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.create_policy_stat_table">
<span class="sig-name descname"><span class="pre">create_policy_stat_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_policy_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.create_policy_stat_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create policy_stat table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conn</strong> – DB connection object</p></li>
<li><p><strong>storage_policy_index</strong> – the policy_index the container is
being created with</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.create_shard_range_table">
<span class="sig-name descname"><span class="pre">create_shard_range_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.create_shard_range_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the shard_range table which is specific to the container DB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conn</strong> – DB connection object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.db_contains_type">
<span class="sig-name descname"><span class="pre">db_contains_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'object'</span></em><a class="headerlink" href="#swift.container.backend.ContainerBroker.db_contains_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.db_epoch">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">db_epoch</span></span><a class="headerlink" href="#swift.container.backend.ContainerBroker.db_epoch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.db_file">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">db_file</span></span><a class="headerlink" href="#swift.container.backend.ContainerBroker.db_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path to the primary db file for this broker. This is typically
the db file for the most recent sharding epoch. However, if no db files
exist on disk, or if <code class="docutils literal notranslate"><span class="pre">force_db_file</span></code> was True when the broker was
constructed, then the primary db file is the file passed to the broker
constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A path to a db file; the file does not necessarily exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.db_files">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">db_files</span></span><a class="headerlink" href="#swift.container.backend.ContainerBroker.db_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the cached list of valid db files that exist on disk for this
broker.</p>
<dl class="simple">
<dt>The cached list may be refreshed by calling</dt><dd><p><a class="reference internal" href="#swift.container.backend.ContainerBroker.reload_db_files" title="swift.container.backend.ContainerBroker.reload_db_files"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reload_db_files()</span></code></a>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of paths to db files ordered by ascending epoch;
the list may be empty.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.db_reclaim_timestamp">
<span class="sig-name descname"><span class="pre">db_reclaim_timestamp</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'created_at'</span></em><a class="headerlink" href="#swift.container.backend.ContainerBroker.db_reclaim_timestamp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.db_type">
<span class="sig-name descname"><span class="pre">db_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'container'</span></em><a class="headerlink" href="#swift.container.backend.ContainerBroker.db_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.delete_meta_whitelist">
<span class="sig-name descname"><span class="pre">delete_meta_whitelist</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['x-container-sysmeta-shard-quoted-root',</span> <span class="pre">'x-container-sysmeta-shard-root',</span> <span class="pre">'x-container-sysmeta-sharding']</span></em><a class="headerlink" href="#swift.container.backend.ContainerBroker.delete_meta_whitelist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.delete_object">
<span class="sig-name descname"><span class="pre">delete_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_policy_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.delete_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark an object deleted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – object name to be deleted</p></li>
<li><p><strong>timestamp</strong> – timestamp when the object was marked as deleted</p></li>
<li><p><strong>storage_policy_index</strong> – the storage policy index for the object</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.empty">
<span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if container DB is empty.</p>
<p>This method uses more stringent checks on object count than
<code class="xref py py-meth docutils literal notranslate"><span class="pre">is_deleted()</span></code>: this method checks that there are no objects in any
policy; if the container is in the process of sharding then both fresh
and retiring databases are checked to be empty; if a root container has
shard ranges then they are checked to be empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the database has no active objects, False otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.enable_sharding">
<span class="sig-name descname"><span class="pre">enable_sharding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.enable_sharding" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates this broker’s own shard range with the given epoch, sets its
state to SHARDING and persists it in the DB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>epoch</strong> – a <code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the broker’s updated own shard range.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.find_shard_ranges">
<span class="sig-name descname"><span class="pre">find_shard_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shard_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">existing_ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_shard_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.find_shard_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Scans the container db for shard ranges. Scanning will start at the
upper bound of the any <code class="docutils literal notranslate"><span class="pre">existing_ranges</span></code> that are given, otherwise
at <code class="docutils literal notranslate"><span class="pre">ShardRange.MIN</span></code>. Scanning will stop when <code class="docutils literal notranslate"><span class="pre">limit</span></code> shard ranges
have been found or when no more shard ranges can be found. In the
latter case, the upper bound of the final shard range will be equal to
the upper bound of the container namespace.</p>
<p>This method does not modify the state of the db; callers are
responsible for persisting any shard range data in the db.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shard_size</strong> – the size of each shard range</p></li>
<li><p><strong>limit</strong> – the maximum number of shard points to be found; a
negative value (default) implies no limit.</p></li>
<li><p><strong>existing_ranges</strong> – an optional list of existing ShardRanges; if
given, this list should be sorted in order of upper bounds; the
scan for new shard ranges will start at the upper bound of the last
existing ShardRange.</p></li>
<li><p><strong>minimum_shard_size</strong> – Minimum size of the final shard range. If
this is greater than one then the final shard range may be extended
to more than shard_size in order to avoid a further shard range
with less minimum_shard_size rows.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple; the first value in the tuple is a list of
dicts each having keys {‘index’, ‘lower’, ‘upper’, ‘object_count’}
in order of ascending ‘upper’; the second value in the tuple is a
boolean which is True if the last shard range has been found, False
otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_all_shard_range_data">
<span class="sig-name descname"><span class="pre">get_all_shard_range_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_all_shard_range_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all shard range data, including own shard range and
deleted shard ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of dict representations of a ShardRange.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_brokers">
<span class="sig-name descname"><span class="pre">get_brokers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_brokers" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of brokers for component dbs. The list has two entries
while the db state is sharding: the first entry is a broker for the
retiring db with <code class="docutils literal notranslate"><span class="pre">skip_commits</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code>; the second entry is
a broker for the fresh db  with <code class="docutils literal notranslate"><span class="pre">skip_commits</span></code> set to <code class="docutils literal notranslate"><span class="pre">False</span></code>. For
any other db state the list has one entry.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of <a class="reference internal" href="#swift.container.backend.ContainerBroker" title="swift.container.backend.ContainerBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_db_state">
<span class="sig-name descname"><span class="pre">get_db_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_db_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current state of on disk db files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_db_version">
<span class="sig-name descname"><span class="pre">get_db_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_db_version" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_info">
<span class="sig-name descname"><span class="pre">get_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get global data for the container.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict with keys: account, container, created_at,
put_timestamp, delete_timestamp, status, status_changed_at,
object_count, bytes_used, reported_put_timestamp,
reported_delete_timestamp, reported_object_count,
reported_bytes_used, hash, id, x_container_sync_point1,
x_container_sync_point2, and storage_policy_index,
db_state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_info_is_deleted">
<span class="sig-name descname"><span class="pre">get_info_is_deleted</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_info_is_deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the is_deleted status and info for the container.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a tuple, in the form (info, is_deleted) info is a dict as
returned by get_info and is_deleted is a boolean.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_misplaced_since">
<span class="sig-name descname"><span class="pre">get_misplaced_since</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_misplaced_since" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of objects which are in a storage policy different
from the container’s storage policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> – last reconciler sync point</p></li>
<li><p><strong>count</strong> – maximum number of entries to get</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of dicts with keys: name, created_at, size,
content_type, etag, storage_policy_index</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_objects">
<span class="sig-name descname"><span class="pre">get_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_deleted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">since_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of objects, including deleted objects, in all policies.
Each object in the list is described by a dict with keys {‘name’,
‘created_at’, ‘size’, ‘content_type’, ‘etag’, ‘deleted’,
‘storage_policy_index’}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>limit</strong> – maximum number of entries to get</p></li>
<li><p><strong>marker</strong> – if set, objects with names less than or equal to this
value will not be included in the list.</p></li>
<li><p><strong>end_marker</strong> – if set, objects with names greater than or equal to
this value will not be included in the list.</p></li>
<li><p><strong>include_deleted</strong> – if True, include only deleted objects; if
False, include only undeleted objects; otherwise (default), include
both deleted and undeleted objects.</p></li>
<li><p><strong>since_row</strong> – include only items whose ROWID is greater than
the given row id; by default all rows are included.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of dicts, each describing an object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_own_shard_range">
<span class="sig-name descname"><span class="pre">get_own_shard_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_own_shard_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a shard range representing this broker’s own shard range. If no
such range has been persisted in the broker’s shard ranges table then a
default shard range representing the entire namespace will be returned.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">object_count</span></code> and <code class="docutils literal notranslate"><span class="pre">bytes_used</span></code> of the returned shard range are
not guaranteed to be up-to-date with the current object stats for this
broker. Callers that require up-to-date stats should use the
<code class="docutils literal notranslate"><span class="pre">get_info</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>no_default</strong> – if True and the broker’s own shard range is not
found in the shard ranges table then None is returned, otherwise a
default shard range is returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <a class="reference internal" href="misc.html#swift.common.utils.ShardRange" title="swift.common.utils.ShardRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRange</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_policy_stats">
<span class="sig-name descname"><span class="pre">get_policy_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_policy_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_reconciler_sync">
<span class="sig-name descname"><span class="pre">get_reconciler_sync</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_reconciler_sync" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_replication_info">
<span class="sig-name descname"><span class="pre">get_replication_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_replication_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the DB required for replication.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict containing keys from get_info plus max_row and metadata</p>
</dd>
</dl>
<dl class="simple">
<dt>Note:: get_info’s &lt;db_contains_type&gt;_count is translated to just</dt><dd><p>“count” and metadata is the raw string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_shard_ranges">
<span class="sig-name descname"><span class="pre">get_shard_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_deleted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_own</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_shard_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of persisted shard ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marker</strong> – restricts the returned list to shard ranges whose
namespace includes or is greater than the marker value.</p></li>
<li><p><strong>end_marker</strong> – restricts the returned list to shard ranges whose
namespace includes or is less than the end_marker value.</p></li>
<li><p><strong>includes</strong> – restricts the returned list to the shard range that
includes the given value; if <code class="docutils literal notranslate"><span class="pre">includes</span></code> is specified then
<code class="docutils literal notranslate"><span class="pre">marker</span></code> and <code class="docutils literal notranslate"><span class="pre">end_marker</span></code> are ignored.</p></li>
<li><p><strong>reverse</strong> – reverse the result order.</p></li>
<li><p><strong>include_deleted</strong> – include items that have the delete marker set</p></li>
<li><p><strong>states</strong> – if specified, restricts the returned list to shard
ranges that have the given state(s); can be a list of ints or a
single int.</p></li>
<li><p><strong>include_own</strong> – boolean that governs whether the row whose name
matches the broker’s path is included in the returned list. If
True, that row is included, otherwise it is not included. Default
is False.</p></li>
<li><p><strong>exclude_others</strong> – boolean that governs whether the rows whose
names do not match the broker’s path are included in the returned
list. If True, those rows are not included, otherwise they are
included. Default is False.</p></li>
<li><p><strong>fill_gaps</strong> – if True, insert a modified copy of own shard range to
fill any gap between the end of any found shard ranges and the
upper bound of own shard range. Gaps enclosed within the found
shard ranges are not filled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of instances of <a class="reference internal" href="misc.html#swift.common.utils.ShardRange" title="swift.common.utils.ShardRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">swift.common.utils.ShardRange</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_shard_usage">
<span class="sig-name descname"><span class="pre">get_shard_usage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_shard_usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the aggregate object stats for all shard ranges in states ACTIVE,
SHARDING or SHRINKING.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dict with keys {bytes_used, object_count}</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_sharding_sysmeta">
<span class="sig-name descname"><span class="pre">get_sharding_sysmeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_sharding_sysmeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns sharding specific info from the broker’s metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> – if given the value stored under <code class="docutils literal notranslate"><span class="pre">key</span></code> in the sharding
info will be returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>either a dict of sharding info or the value stored under
<code class="docutils literal notranslate"><span class="pre">key</span></code> in that dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.get_sharding_sysmeta_with_timestamps">
<span class="sig-name descname"><span class="pre">get_sharding_sysmeta_with_timestamps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_sharding_sysmeta_with_timestamps" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns sharding specific info from the broker’s metadata with
timestamps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> – if given the value stored under <code class="docutils literal notranslate"><span class="pre">key</span></code> in the sharding
info will be returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dict of sharding info with their timestamps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.has_multiple_policies">
<span class="sig-name descname"><span class="pre">has_multiple_policies</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.has_multiple_policies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.is_empty_enough_to_reclaim">
<span class="sig-name descname"><span class="pre">is_empty_enough_to_reclaim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.is_empty_enough_to_reclaim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.is_old_enough_to_reclaim">
<span class="sig-name descname"><span class="pre">is_old_enough_to_reclaim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">now</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reclaim_age</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.is_old_enough_to_reclaim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.is_own_shard_range">
<span class="sig-name descname"><span class="pre">is_own_shard_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shard_range</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.is_own_shard_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.is_reclaimable">
<span class="sig-name descname"><span class="pre">is_reclaimable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">now</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reclaim_age</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.is_reclaimable" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the broker abstraction is empty, and has been marked deleted
for at least a reclaim age.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.is_root_container">
<span class="sig-name descname"><span class="pre">is_root_container</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.is_root_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if this container is a root container, False otherwise.</p>
<p>A root container is a container that is not a shard of another
container.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.is_sharded">
<span class="sig-name descname"><span class="pre">is_sharded</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.is_sharded" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.list_objects_iter">
<span class="sig-name descname"><span class="pre">list_objects_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_marker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_policy_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_deleted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">since_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_policies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_reserved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.list_objects_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of objects sorted by name starting at marker onward, up
to limit entries.  Entries will begin with the prefix and will not
have the delimiter after the prefix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>limit</strong> – maximum number of entries to get</p></li>
<li><p><strong>marker</strong> – marker query</p></li>
<li><p><strong>end_marker</strong> – end marker query</p></li>
<li><p><strong>prefix</strong> – prefix query</p></li>
<li><p><strong>delimiter</strong> – delimiter for query</p></li>
<li><p><strong>path</strong> – if defined, will set the prefix and delimiter based on
the path</p></li>
<li><p><strong>storage_policy_index</strong> – storage policy index for query</p></li>
<li><p><strong>reverse</strong> – reverse the result order.</p></li>
<li><p><strong>include_deleted</strong> – if True, include only deleted objects; if
False (default), include only undeleted objects; otherwise, include
both deleted and undeleted objects.</p></li>
<li><p><strong>since_row</strong> – include only items whose ROWID is greater than
the given row id; by default all rows are included.</p></li>
<li><p><strong>transform_func</strong> – an optional function that if given will be
called for each object to get a transformed version of the object
to include in the listing; should have same signature as
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_transform_record()</span></code>; defaults to <code class="xref py py-meth docutils literal notranslate"><span class="pre">_transform_record()</span></code>.</p></li>
<li><p><strong>all_policies</strong> – if True, include objects for all storage policies
ignoring any value given for <code class="docutils literal notranslate"><span class="pre">storage_policy_index</span></code></p></li>
<li><p><strong>allow_reserved</strong> – exclude names with reserved-byte by default</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of tuples of (name, created_at, size, content_type,
etag, deleted)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.make_tuple_for_pickle">
<span class="sig-name descname"><span class="pre">make_tuple_for_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.make_tuple_for_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn this db record dict into the format this service uses for
pending pickles.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.merge_items">
<span class="sig-name descname"><span class="pre">merge_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.merge_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge items into the object table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item_list</strong> – list of dictionaries of {‘name’, ‘created_at’,
‘size’, ‘content_type’, ‘etag’, ‘deleted’,
‘storage_policy_index’, ‘ctype_timestamp’,
‘meta_timestamp’}</p></li>
<li><p><strong>source</strong> – if defined, update incoming_sync with the source</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.merge_shard_ranges">
<span class="sig-name descname"><span class="pre">merge_shard_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shard_ranges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.merge_shard_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge shard ranges into the shard range table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shard_ranges</strong> – a shard range or a list of shard ranges; each
shard range should be an instance of
<a class="reference internal" href="misc.html#swift.common.utils.ShardRange" title="swift.common.utils.ShardRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRange</span></code></a> or a dict representation of
a shard range having <code class="docutils literal notranslate"><span class="pre">SHARD_RANGE_KEYS</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.path">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">path</span></span><a class="headerlink" href="#swift.container.backend.ContainerBroker.path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.put_object">
<span class="sig-name descname"><span class="pre">put_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deleted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_policy_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctype_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.put_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an object in the DB with its metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – object name to be created</p></li>
<li><p><strong>timestamp</strong> – timestamp of when the object was created</p></li>
<li><p><strong>size</strong> – object size</p></li>
<li><p><strong>content_type</strong> – object content-type</p></li>
<li><p><strong>etag</strong> – object etag</p></li>
<li><p><strong>deleted</strong> – if True, marks the object as deleted and sets the
deleted_at timestamp to timestamp</p></li>
<li><p><strong>storage_policy_index</strong> – the storage policy index for the object</p></li>
<li><p><strong>ctype_timestamp</strong> – timestamp of when content_type was last
updated</p></li>
<li><p><strong>meta_timestamp</strong> – timestamp of when metadata was last updated</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.reload_db_files">
<span class="sig-name descname"><span class="pre">reload_db_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.reload_db_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads the cached list of valid on disk db files for this broker.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.remove_objects">
<span class="sig-name descname"><span class="pre">remove_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lower</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.remove_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes object records in the given namespace range from the object
table.</p>
<p>Note that objects are removed regardless of their storage_policy_index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lower</strong> – defines the lower bound of object names that will be
removed; names greater than this value will be removed; names less
than or equal to this value will not be removed.</p></li>
<li><p><strong>upper</strong> – defines the upper bound of object names that will be
removed; names less than or equal to this value will be removed;
names greater than this value will not be removed. The empty string
is interpreted as there being no upper bound.</p></li>
<li><p><strong>max_row</strong> – if specified only rows less than or equal to max_row
will be removed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.reported">
<span class="sig-name descname"><span class="pre">reported</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">put_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bytes_used</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.reported" title="Permalink to this definition">¶</a></dt>
<dd><p>Update reported stats, available with container’s <cite>get_info</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>put_timestamp</strong> – put_timestamp to update</p></li>
<li><p><strong>delete_timestamp</strong> – delete_timestamp to update</p></li>
<li><p><strong>object_count</strong> – object_count to update</p></li>
<li><p><strong>bytes_used</strong> – bytes_used to update</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.resolve_shard_range_states">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">resolve_shard_range_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.resolve_shard_range_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of values each of which may be the name of a state, the
number of a state, or an alias, return the set of state numbers
described by the list.</p>
<p>The following alias values are supported: ‘listing’ maps to all states
that are considered valid when listing objects; ‘updating’ maps to all
states that are considered valid for redirecting an object update;
‘auditing’ maps to all states that are considered valid for a shard
container that is updating its own shard range table from a root (this
currently maps to all states except FOUND).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>states</strong> – a list of values each of which may be the name of a
state, the number of a state, or an alias</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a set of integer state numbers, or None if no states are given</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if any value in the given list is neither a valid
state nor a valid alias</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.root_account">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">root_account</span></span><a class="headerlink" href="#swift.container.backend.ContainerBroker.root_account" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.root_container">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">root_container</span></span><a class="headerlink" href="#swift.container.backend.ContainerBroker.root_container" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.root_path">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">root_path</span></span><a class="headerlink" href="#swift.container.backend.ContainerBroker.root_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.set_sharded_state">
<span class="sig-name descname"><span class="pre">set_sharded_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.set_sharded_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Unlink’s the broker’s retiring DB file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the retiring DB was successfully unlinked, False
otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.set_sharding_state">
<span class="sig-name descname"><span class="pre">set_sharding_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.set_sharding_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and initializes a fresh DB file in preparation for sharding a
retiring DB. The broker’s own shard range must have an epoch timestamp
for this method to succeed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the fresh DB was successfully created, False
otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.set_sharding_sysmeta">
<span class="sig-name descname"><span class="pre">set_sharding_sysmeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.set_sharding_sysmeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the broker’s metadata stored under the given key
prefixed with a sharding specific namespace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – metadata key in the sharding metadata namespace.</p></li>
<li><p><strong>value</strong> – metadata value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.set_storage_policy_index">
<span class="sig-name descname"><span class="pre">set_storage_policy_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.set_storage_policy_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the container_stat policy_index and status_changed_at.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.set_x_container_sync_points">
<span class="sig-name descname"><span class="pre">set_x_container_sync_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sync_point1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_point2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.set_x_container_sync_points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.sharding_initiated">
<span class="sig-name descname"><span class="pre">sharding_initiated</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.sharding_initiated" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if a broker has shard range state that would be necessary
for sharding to have been initiated, False otherwise.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.sharding_required">
<span class="sig-name descname"><span class="pre">sharding_required</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.sharding_required" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if a broker has shard range state that would be necessary
for sharding to have been initiated but has not yet completed sharding,
False otherwise.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.storage_policy_index">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">storage_policy_index</span></span><a class="headerlink" href="#swift.container.backend.ContainerBroker.storage_policy_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.backend.ContainerBroker.update_reconciler_sync">
<span class="sig-name descname"><span class="pre">update_reconciler_sync</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.update_reconciler_sync" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.backend.merge_shards">
<span class="sig-prename descclassname"><span class="pre">swift.container.backend.</span></span><span class="sig-name descname"><span class="pre">merge_shards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shard_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">existing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.merge_shards" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares <code class="docutils literal notranslate"><span class="pre">shard_data</span></code> with <code class="docutils literal notranslate"><span class="pre">existing</span></code> and updates <code class="docutils literal notranslate"><span class="pre">shard_data</span></code> with
any items of <code class="docutils literal notranslate"><span class="pre">existing</span></code> that take precedence over the corresponding item
in <code class="docutils literal notranslate"><span class="pre">shard_data</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shard_data</strong> – a dict representation of shard range that may be
modified by this method.</p></li>
<li><p><strong>existing</strong> – a dict representation of shard range.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if <code class="docutils literal notranslate"><span class="pre">shard</span> <span class="pre">data</span></code> has any item(s) that are considered to
take precedence over the corresponding item in <code class="docutils literal notranslate"><span class="pre">existing</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.backend.sift_shard_ranges">
<span class="sig-prename descclassname"><span class="pre">swift.container.backend.</span></span><span class="sig-name descname"><span class="pre">sift_shard_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_shard_ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">existing_shard_ranges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.sift_shard_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares new and existing shard ranges, updating the new shard ranges with
any more recent state from the existing, and returns shard ranges sorted
into those that need adding because they contain new or updated state and
those that need deleting because their state has been superseded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_shard_ranges</strong> – a list of dicts, each of which represents a shard
range.</p></li>
<li><p><strong>existing_shard_ranges</strong> – a dict mapping shard range names to dicts
representing a shard range.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple (to_add, to_delete); to_add is a list of dicts, each of
which represents a shard range that is to be added to the existing
shard ranges; to_delete is a set of shard range names that are to be
deleted.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.backend.update_new_item_from_existing">
<span class="sig-prename descclassname"><span class="pre">swift.container.backend.</span></span><span class="sig-name descname"><span class="pre">update_new_item_from_existing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">existing</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.update_new_item_from_existing" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the data and meta related timestamps of a new object item with
the timestamps of an existing object record, and update the new item
with data and/or meta related attributes from the existing record if
their timestamps are newer.</p>
<p>The multiple timestamps are encoded into a single string for storing
in the ‘created_at’ column of the objects db table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_item</strong> – A dict of object update attributes</p></li>
<li><p><strong>existing</strong> – A dict of existing object attributes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if any attributes of the new item dict were found to be
newer than the existing and therefore not updated, otherwise
False implying that the updated item is equal to the existing.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-swift.container.replicator">
<span id="id4"></span><span id="container-replicator"></span><h2>Container Replicator<a class="headerlink" href="#module-swift.container.replicator" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.replicator.</span></span><span class="sig-name descname"><span class="pre">ContainerReplicator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="db.html#swift.common.db_replicator.Replicator" title="swift.common.db_replicator.Replicator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Replicator</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.brokerclass">
<span class="sig-name descname"><span class="pre">brokerclass</span></span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.brokerclass" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#swift.container.backend.ContainerBroker" title="swift.container.backend.ContainerBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.cleanup_post_replicate">
<span class="sig-name descname"><span class="pre">cleanup_post_replicate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">responses</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.cleanup_post_replicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleanup non primary database from disk if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>broker</strong> – the broker for the database we’re replicating</p></li>
<li><p><strong>orig_info</strong> – snapshot of the broker replication info dict taken
before replication</p></li>
<li><p><strong>responses</strong> – a list of boolean success values for each replication
request to other nodes</p></li>
</ul>
</dd>
<dt class="field-even">Return success<span class="colon">:</span></dt>
<dd class="field-even"><p>returns False if deletion of the database was
attempted but unsuccessful, otherwise returns True.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.datadir">
<span class="sig-name descname"><span class="pre">datadir</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'containers'</span></em><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.datadir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.default_port">
<span class="sig-name descname"><span class="pre">default_port</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6201</span></em><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.default_port" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.delete_db">
<span class="sig-name descname"><span class="pre">delete_db</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.delete_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that reconciler databases are only cleaned up at the end of the
replication run.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.dump_to_reconciler">
<span class="sig-name descname"><span class="pre">dump_to_reconciler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.dump_to_reconciler" title="Permalink to this definition">¶</a></dt>
<dd><p>Look for object rows for objects updates in the wrong storage policy
in broker with a <code class="docutils literal notranslate"><span class="pre">ROWID</span></code> greater than the rowid given as point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>broker</strong> – the container broker with misplaced objects</p></li>
<li><p><strong>point</strong> – the last verified <code class="docutils literal notranslate"><span class="pre">reconciler_sync_point</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the last successful enqueued rowid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.feed_reconciler">
<span class="sig-name descname"><span class="pre">feed_reconciler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.feed_reconciler" title="Permalink to this definition">¶</a></dt>
<dd><p>Add queue entries for rows in item_list to the local reconciler
container database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>container</strong> – the name of the reconciler container</p></li>
<li><p><strong>item_list</strong> – the list of rows to enqueue</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if successfully enqueued</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.find_local_handoff_for_part">
<span class="sig-name descname"><span class="pre">find_local_handoff_for_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.find_local_handoff_for_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a device in the ring that is on this node on which to place a
partition. Preference is given to a device that is a primary location
for the partition. If no such device is found then a local device with
weight is chosen, and failing that any local device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>part</strong> – a partition</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a node entry from the ring</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.get_reconciler_broker">
<span class="sig-name descname"><span class="pre">get_reconciler_broker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.get_reconciler_broker" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a local instance of the reconciler container broker that is
appropriate to enqueue the given timestamp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timestamp</strong> – the timestamp of the row to be enqueued</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a local reconciler broker</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.replicate_reconcilers">
<span class="sig-name descname"><span class="pre">replicate_reconcilers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.replicate_reconcilers" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure any items merged to reconciler containers during replication
are pushed out to correct nodes and any reconciler containers that do
not belong on this node are removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.report_up_to_date">
<span class="sig-name descname"><span class="pre">report_up_to_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.report_up_to_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.run_once">
<span class="sig-name descname"><span class="pre">run_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a replication pass once.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicator.server_type">
<span class="sig-name descname"><span class="pre">server_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'container'</span></em><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.server_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicatorRpc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.replicator.</span></span><span class="sig-name descname"><span class="pre">ContainerReplicatorRpc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datadir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broker_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mount_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicatorRpc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="db.html#swift.common.db_replicator.ReplicatorRpc" title="swift.common.db_replicator.ReplicatorRpc"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReplicatorRpc</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicatorRpc.get_shard_ranges">
<span class="sig-name descname"><span class="pre">get_shard_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicatorRpc.get_shard_ranges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.replicator.ContainerReplicatorRpc.merge_shard_ranges">
<span class="sig-name descname"><span class="pre">merge_shard_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicatorRpc.merge_shard_ranges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-swift.container.server">
<span id="id5"></span><span id="container-server"></span><h2>Container Server<a class="headerlink" href="#module-swift.container.server" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.container.server.ContainerController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.server.</span></span><span class="sig-name descname"><span class="pre">ContainerController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseStorageServer</span></code></p>
<p>WSGI Controller for the container server.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.DELETE">
<span class="sig-name descname"><span class="pre">DELETE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.DELETE" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP DELETE request.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP GET request.</p>
<p>The body of the response to a successful GET request contains a listing
of either objects or shard ranges. The exact content of the listing is
determined by a combination of request headers and query string
parameters, as follows:</p>
<ul>
<li><p>The type of the listing is determined by the
<code class="docutils literal notranslate"><span class="pre">X-Backend-Record-Type</span></code> header. If this header has value <code class="docutils literal notranslate"><span class="pre">shard</span></code>
then the response body will be a list of shard ranges; if this header
has value <code class="docutils literal notranslate"><span class="pre">auto</span></code>, and the container state is <code class="docutils literal notranslate"><span class="pre">sharding</span></code> or
<code class="docutils literal notranslate"><span class="pre">sharded</span></code>, then the listing will be a list of shard ranges;
otherwise the response body will be a list of objects.</p></li>
<li><p>Both shard range and object listings may be filtered according to
the constraints described below. However, the
<code class="docutils literal notranslate"><span class="pre">X-Backend-Ignore-Shard-Name-Filter</span></code> header may be used to override
the application of the <code class="docutils literal notranslate"><span class="pre">marker</span></code>, <code class="docutils literal notranslate"><span class="pre">end_marker</span></code>, <code class="docutils literal notranslate"><span class="pre">includes</span></code> and
<code class="docutils literal notranslate"><span class="pre">reverse</span></code> parameters to shard range listings. These parameters will
be ignored if the header has the value ‘sharded’ and the current db
sharding state is also ‘sharded’. Note that this header does not
override the <code class="docutils literal notranslate"><span class="pre">states</span></code> constraint on shard range listings.</p></li>
<li><p>The order of both shard range and object listings may be reversed by
using a <code class="docutils literal notranslate"><span class="pre">reverse</span></code> query string parameter with a
value in <code class="xref py py-attr docutils literal notranslate"><span class="pre">swift.common.utils.TRUE_VALUES</span></code>.</p></li>
<li><p>Both shard range and object listings may be constrained to a name
range by the <code class="docutils literal notranslate"><span class="pre">marker</span></code> and <code class="docutils literal notranslate"><span class="pre">end_marker</span></code> query string parameters.
Object listings will only contain objects whose names are greater
than any <code class="docutils literal notranslate"><span class="pre">marker</span></code> value and less than any <code class="docutils literal notranslate"><span class="pre">end_marker</span></code> value.
Shard range listings will only contain shard ranges whose namespace
is greater than or includes any <code class="docutils literal notranslate"><span class="pre">marker</span></code> value and is less than or
includes any <code class="docutils literal notranslate"><span class="pre">end_marker</span></code> value.</p></li>
<li><p>Shard range listings may also be constrained by an <code class="docutils literal notranslate"><span class="pre">includes</span></code> query
string parameter. If this parameter is present the listing will only
contain shard ranges whose namespace includes the value of the
parameter; any <code class="docutils literal notranslate"><span class="pre">marker</span></code> or <code class="docutils literal notranslate"><span class="pre">end_marker</span></code> parameters are ignored</p></li>
<li><p>The length of an object listing may be constrained by the <code class="docutils literal notranslate"><span class="pre">limit</span></code>
parameter. Object listings may also be constrained by <code class="docutils literal notranslate"><span class="pre">prefix</span></code>,
<code class="docutils literal notranslate"><span class="pre">delimiter</span></code> and <code class="docutils literal notranslate"><span class="pre">path</span></code> query string parameters.</p></li>
<li><p>Shard range listings will include deleted shard ranges if and only if
the <code class="docutils literal notranslate"><span class="pre">X-Backend-Include-Deleted</span></code> header value is one of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">swift.common.utils.TRUE_VALUES</span></code>. Object listings never
include deleted objects.</p></li>
<li><p>Shard range listings may be constrained to include only shard ranges
whose state is specified by a query string <code class="docutils literal notranslate"><span class="pre">states</span></code> parameter. If
present, the <code class="docutils literal notranslate"><span class="pre">states</span></code> parameter should be a comma separated list of
either the string or integer representation of
<code class="xref py py-data docutils literal notranslate"><span class="pre">STATES</span></code>.</p>
<p>Two alias values may be used in a <code class="docutils literal notranslate"><span class="pre">states</span></code> parameter value:
<code class="docutils literal notranslate"><span class="pre">listing</span></code> will cause the listing to include all shard ranges in a
state suitable for contributing to an object listing; <code class="docutils literal notranslate"><span class="pre">updating</span></code>
will cause the listing to include all shard ranges in a state
suitable to accept an object update.</p>
<p>If either of these aliases is used then the shard range listing will
if necessary be extended with a synthesised ‘filler’ range in order
to satisfy the requested name range when insufficient actual shard
ranges are found. Any ‘filler’ shard range will cover the otherwise
uncovered tail of the requested name range and will point back to the
same container.</p>
</li>
<li><p>Listings are not normally returned from a deleted container. However,
the <code class="docutils literal notranslate"><span class="pre">X-Backend-Override-Deleted</span></code> header may be used with a value in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">swift.common.utils.TRUE_VALUES</span></code> to force a shard range
listing to be returned from a deleted container whose DB file still
exists.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> – an instance of <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">swift.common.swob.Request</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an instance of <a class="reference internal" href="misc.html#swift.common.swob.Response" title="swift.common.swob.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">swift.common.swob.Response</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.HEAD">
<span class="sig-name descname"><span class="pre">HEAD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.HEAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP HEAD request.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.POST">
<span class="sig-name descname"><span class="pre">POST</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.POST" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP POST request.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.PUT">
<span class="sig-name descname"><span class="pre">PUT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.PUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP PUT request.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.REPLICATE">
<span class="sig-name descname"><span class="pre">REPLICATE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.REPLICATE" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP REPLICATE request (json-encoded RPC calls for replication.)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.UPDATE">
<span class="sig-name descname"><span class="pre">UPDATE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.UPDATE" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP UPDATE request (merge_items RPCs coming from the proxy.)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.account_update">
<span class="sig-name descname"><span class="pre">account_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broker</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.account_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the account server(s) with latest container info.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – swob.Request object</p></li>
<li><p><strong>account</strong> – account name</p></li>
<li><p><strong>container</strong> – container name</p></li>
<li><p><strong>broker</strong> – container DB broker object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>if all the account requests return a 404 error code,
HTTPNotFound response object,
if the account cannot be updated due to a malformed header,
an HTTPBadRequest response object,
otherwise None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.allowed_sync_hosts">
<span class="sig-name descname"><span class="pre">allowed_sync_hosts</span></span><a class="headerlink" href="#swift.container.server.ContainerController.allowed_sync_hosts" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of hosts we’re allowed to send syncs to. This can be
overridden by data in self.realms_conf</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.check_free_space">
<span class="sig-name descname"><span class="pre">check_free_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drive</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.check_free_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.create_listing">
<span class="sig-name descname"><span class="pre">create_listing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_content_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resp_headers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.create_listing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.get_and_validate_policy_index">
<span class="sig-name descname"><span class="pre">get_and_validate_policy_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.get_and_validate_policy_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate that the index supplied maps to a policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>policy index from request, or None if not present</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>HTTPBadRequest</strong> – if the supplied index is bogus</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.realms_conf">
<span class="sig-name descname"><span class="pre">realms_conf</span></span><a class="headerlink" href="#swift.container.server.ContainerController.realms_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>ContainerSyncCluster instance for validating sync-to values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.save_headers">
<span class="sig-name descname"><span class="pre">save_headers</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['x-container-read',</span> <span class="pre">'x-container-write',</span> <span class="pre">'x-container-sync-key',</span> <span class="pre">'x-container-sync-to']</span></em><a class="headerlink" href="#swift.container.server.ContainerController.save_headers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.server_type">
<span class="sig-name descname"><span class="pre">server_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'container-server'</span></em><a class="headerlink" href="#swift.container.server.ContainerController.server_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.server.ContainerController.update_data_record">
<span class="sig-name descname"><span class="pre">update_data_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.update_data_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform any mutations to container listing records that are common to
all serialization formats, and returns it as a dict.</p>
<p>Converts created time to iso timestamp.
Replaces size with ‘swift_bytes’ content type parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Params record<span class="colon">:</span></dt>
<dd class="field-odd"><p>object entry record</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>modified record</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.server.app_factory">
<span class="sig-prename descclassname"><span class="pre">swift.container.server.</span></span><span class="sig-name descname"><span class="pre">app_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.app_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>paste.deploy app factory for creating WSGI container server apps</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.server.gen_resp_headers">
<span class="sig-prename descclassname"><span class="pre">swift.container.server.</span></span><span class="sig-name descname"><span class="pre">gen_resp_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_deleted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.gen_resp_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert container info dict to headers.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.server.get_container_name_and_placement">
<span class="sig-prename descclassname"><span class="pre">swift.container.server.</span></span><span class="sig-name descname"><span class="pre">get_container_name_and_placement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.get_container_name_and_placement" title="Permalink to this definition">¶</a></dt>
<dd><p>Split and validate path for a container.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> – a swob request</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of path parts as strings</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.server.get_obj_name_and_placement">
<span class="sig-prename descclassname"><span class="pre">swift.container.server.</span></span><span class="sig-name descname"><span class="pre">get_obj_name_and_placement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.get_obj_name_and_placement" title="Permalink to this definition">¶</a></dt>
<dd><p>Split and validate path for an object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> – a swob request</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of path parts as strings</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-swift.container.reconciler">
<span id="id6"></span><span id="container-reconciler"></span><h2>Container Reconciler<a class="headerlink" href="#module-swift.container.reconciler" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">ContainerReconciler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Daemon</span></code></p>
<p>Move objects that are in the wrong storage policy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.can_reconcile_policy">
<span class="sig-name descname"><span class="pre">can_reconcile_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.can_reconcile_policy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.ensure_object_in_right_location">
<span class="sig-name descname"><span class="pre">ensure_object_in_right_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_policy_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_policy_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_obj_status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_obj_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_obj_iter</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.ensure_object_in_right_location" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate source object will satisfy the misplaced object queue entry
and move to destination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_policy_index</strong> – the policy_index for the source object</p></li>
<li><p><strong>account</strong> – the account name of the misplaced object</p></li>
<li><p><strong>container</strong> – the container name of the misplaced object</p></li>
<li><p><strong>obj</strong> – the name of the misplaced object</p></li>
<li><p><strong>q_ts</strong> – the timestamp of the misplaced object</p></li>
<li><p><strong>path</strong> – the full path of the misplaced object for logging</p></li>
<li><p><strong>container_policy_index</strong> – the policy_index of the destination</p></li>
<li><p><strong>source_ts</strong> – the timestamp of the source object</p></li>
<li><p><strong>source_obj_status</strong> – the HTTP status source object request</p></li>
<li><p><strong>source_obj_info</strong> – the HTTP headers of the source object request</p></li>
<li><p><strong>source_obj_iter</strong> – the body iter of the source object request</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.ensure_tombstone_in_right_location">
<span class="sig-name descname"><span class="pre">ensure_tombstone_in_right_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_policy_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_policy_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_ts</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.ensure_tombstone_in_right_location" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue a DELETE request against the destination to match the
misplaced DELETE against the source.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.log_route">
<span class="sig-name descname"><span class="pre">log_route</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'container-reconciler'</span></em><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.log_route" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.log_stats">
<span class="sig-name descname"><span class="pre">log_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.log_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump stats to logger, noop when stats have been already been
logged in the last minute.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.pop_queue">
<span class="sig-name descname"><span class="pre">pop_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_record</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.pop_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue a delete object request to the container for the misplaced
object queue entry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>container</strong> – the misplaced objects container</p></li>
<li><p><strong>obj</strong> – the name of the misplaced object</p></li>
<li><p><strong>q_ts</strong> – the timestamp of the misplaced object</p></li>
<li><p><strong>q_record</strong> – the timestamp of the queue entry</p></li>
</ul>
</dd>
</dl>
<p>N.B. q_ts will normally be the same time as q_record except when
an object was manually re-enqued.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.process_queue_item">
<span class="sig-name descname"><span class="pre">process_queue_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_entry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.process_queue_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Process an entry and remove from queue on success.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_container</strong> – the queue container</p></li>
<li><p><strong>q_entry</strong> – the raw_obj name from the q_container</p></li>
<li><p><strong>queue_item</strong> – a parsed entry from the queue</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.reconcile">
<span class="sig-name descname"><span class="pre">reconcile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.reconcile" title="Permalink to this definition">¶</a></dt>
<dd><p>Main entry point for concurrent processing of misplaced objects.</p>
<p>Iterate over all queue entries and delegate processing to spawned
workers in the pool.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.reconcile_object">
<span class="sig-name descname"><span class="pre">reconcile_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.reconcile_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Process a possibly misplaced object write request.  Determine correct
destination storage policy by checking with primary containers.  Check
source and destination, copying or deleting into destination and
cleaning up the source as needed.</p>
<p>This method wraps _reconcile_object for exception handling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>info</strong> – a queue entry dict</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True to indicate the request is fully processed
successfully, otherwise False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.run_forever">
<span class="sig-name descname"><span class="pre">run_forever</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.run_forever" title="Permalink to this definition">¶</a></dt>
<dd><p>Override this to run forever</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.run_once">
<span class="sig-name descname"><span class="pre">run_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Process every entry in the queue.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.should_process">
<span class="sig-name descname"><span class="pre">should_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queue_item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.should_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a given entry should be handled by this process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>container</strong> – the queue container</p></li>
<li><p><strong>queue_item</strong> – an entry from the queue</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.stats_log">
<span class="sig-name descname"><span class="pre">stats_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.stats_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Update stats tracking for metric and emit log message.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.reconciler.ContainerReconciler.throw_tombstones">
<span class="sig-name descname"><span class="pre">throw_tombstones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">account</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.ContainerReconciler.throw_tombstones" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue a delete object request to the given storage_policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>account</strong> – the account name</p></li>
<li><p><strong>container</strong> – the container name</p></li>
<li><p><strong>obj</strong> – the object name</p></li>
<li><p><strong>timestamp</strong> – the timestamp of the object to delete</p></li>
<li><p><strong>policy_index</strong> – the policy index to direct the request</p></li>
<li><p><strong>path</strong> – the path to be used for logging</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.add_to_reconciler_queue">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">add_to_reconciler_queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">container_ring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_policy_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.add_to_reconciler_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an object to the container reconciler’s queue. This will cause the
container reconciler to move it from its current storage policy index to
the correct storage policy index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>container_ring</strong> – container ring</p></li>
<li><p><strong>account</strong> – the misplaced object’s account</p></li>
<li><p><strong>container</strong> – the misplaced object’s container</p></li>
<li><p><strong>obj</strong> – the misplaced object</p></li>
<li><p><strong>obj_policy_index</strong> – the policy index where the misplaced object
currently is</p></li>
<li><p><strong>obj_timestamp</strong> – the misplaced object’s X-Timestamp. We need this to
ensure that the reconciler doesn’t overwrite a newer
object with an older one.</p></li>
<li><p><strong>op</strong> – the method of the operation (DELETE or PUT)</p></li>
<li><p><strong>force</strong> – over-write queue entries newer than obj_timestamp</p></li>
<li><p><strong>conn_timeout</strong> – max time to wait for connection to container server</p></li>
<li><p><strong>response_timeout</strong> – max time to wait for response from container
server</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>.misplaced_object container name, False on failure. “Success”
means a majority of containers got the update.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.best_policy_index">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">best_policy_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.best_policy_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.cmp_policy_info">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">cmp_policy_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remote_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.cmp_policy_info" title="Permalink to this definition">¶</a></dt>
<dd><p>You have to squint to see it, but the general strategy is just:</p>
<dl class="simple">
<dt>if either has been recreated:</dt><dd><p>return the newest (of the recreated)</p>
</dd>
<dt>else</dt><dd><p>return the oldest</p>
</dd>
</dl>
<p>I tried cleaning it up for awhile, but settled on just writing a bunch of
tests instead.  Once you get an intuitive sense for the nuance here you
can try and see there’s a better way to spell the boolean logic but it all
ends up looking sorta hairy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>-1 if info is correct, 1 if remote_info is better</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.direct_delete_container_entry">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">direct_delete_container_entry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">container_ring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.direct_delete_container_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Talk directly to the primary container servers to delete a particular
object listing. Does not talk to object servers; use this only when a
container entry does not actually have a corresponding object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.get_reconciler_container_name">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">get_reconciler_container_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_timestamp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.get_reconciler_container_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of a container into which a misplaced object should be
enqueued. The name is the object’s last modified time rounded down to the
nearest hour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_timestamp</strong> – a string representation of the object’s ‘created_at’
time from it’s container db row.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a container name</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.get_reconciler_content_type">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">get_reconciler_content_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.get_reconciler_content_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.get_reconciler_obj_name">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">get_reconciler_obj_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.get_reconciler_obj_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.get_row_to_q_entry_translator">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">get_row_to_q_entry_translator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.get_row_to_q_entry_translator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.incorrect_policy_index">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">incorrect_policy_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remote_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.incorrect_policy_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare remote_info to info and decide if the remote storage policy index
should be used instead of ours.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.parse_raw_obj">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">parse_raw_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.parse_raw_obj" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate a reconciler container listing entry to a dictionary
containing the parts of the misplaced object queue entry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj_info</strong> – an entry in an a container listing with the
required keys: name, content_type, and hash</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a queue entry dict with the keys: q_policy_index, account,
container, obj, q_op, q_ts, q_record, and path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.slightly_later_timestamp">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">slightly_later_timestamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.slightly_later_timestamp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.reconciler.translate_container_headers_to_info">
<span class="sig-prename descclassname"><span class="pre">swift.container.reconciler.</span></span><span class="sig-name descname"><span class="pre">translate_container_headers_to_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.reconciler.translate_container_headers_to_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-swift.container.sharder">
<span id="id7"></span><span id="container-sharder"></span><h2>Container Sharder<a class="headerlink" href="#module-swift.container.sharder" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">CleavingContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cursor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleave_to_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_cleave_to_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleaving_done</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">misplaced_done</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges_done</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges_todo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.CleavingContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Encapsulates metadata associated with the process of cleaving a retiring
DB. This metadata includes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ref</span></code>: The unique part of the key that is used when persisting a
serialized <code class="docutils literal notranslate"><span class="pre">CleavingContext</span></code> as sysmeta in the DB. The unique part of
the key is based off the DB id. This ensures that each context is
associated with a specific DB file. The unique part of the key is
included in the <code class="docutils literal notranslate"><span class="pre">CleavingContext</span></code> but should not be modified by any
caller.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cursor</span></code>: the upper bound of the last shard range to have been
cleaved from the retiring DB.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_row</span></code>: the retiring DB’s max row; this is updated to the value of
the retiring DB’s <code class="docutils literal notranslate"><span class="pre">max_row</span></code> every time a <code class="docutils literal notranslate"><span class="pre">CleavingContext</span></code> is
loaded for that DB, and may change during the process of cleaving the
DB.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cleave_to_row</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">max_row</span></code> at the moment when cleaving
starts for the DB. When cleaving completes (i.e. the cleave cursor has
reached the upper bound of the cleaving namespace), <code class="docutils literal notranslate"><span class="pre">cleave_to_row</span></code>
is compared to the current <code class="docutils literal notranslate"><span class="pre">max_row</span></code>: if the two values are not equal
then rows have been added to the DB which may not have been cleaved, in
which case the <code class="docutils literal notranslate"><span class="pre">CleavingContext</span></code> is <code class="docutils literal notranslate"><span class="pre">reset</span></code> and cleaving is
re-started.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last_cleave_to_row</span></code>: the minimum DB row from which cleaving should
select objects to cleave; this is initially set to None i.e. all rows
should be cleaved. If the <code class="docutils literal notranslate"><span class="pre">CleavingContext</span></code> is <code class="docutils literal notranslate"><span class="pre">reset</span></code> then the
<code class="docutils literal notranslate"><span class="pre">last_cleave_to_row</span></code> is set to the current value of
<code class="docutils literal notranslate"><span class="pre">cleave_to_row</span></code>, which in turn is set to the current value of
<code class="docutils literal notranslate"><span class="pre">max_row</span></code> by a subsequent call to <code class="docutils literal notranslate"><span class="pre">start</span></code>. The repeated cleaving
therefore only selects objects in rows greater than the
<code class="docutils literal notranslate"><span class="pre">last_cleave_to_row</span></code>, rather than cleaving the whole DB again.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ranges_done</span></code>: the number of shard ranges that have been cleaved from
the retiring DB.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ranges_todo</span></code>: the number of shard ranges that are yet to be
cleaved from the retiring DB.</p></li>
</ul>
<dl class="py property">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext.cursor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cursor</span></span><a class="headerlink" href="#swift.container.sharder.CleavingContext.cursor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext.delete">
<span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.CleavingContext.delete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext.done">
<span class="sig-name descname"><span class="pre">done</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.CleavingContext.done" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.CleavingContext.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a CleavingContext tracking the cleaving progress of the given
broker’s DB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>broker</strong> – an instances of <code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of <a class="reference internal" href="#swift.container.sharder.CleavingContext" title="swift.container.sharder.CleavingContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">CleavingContext</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext.load_all">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.CleavingContext.load_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all cleaving contexts stored in the broker’s DB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>broker</strong> – an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of tuples of (CleavingContext, timestamp)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext.marker">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">marker</span></span><a class="headerlink" href="#swift.container.sharder.CleavingContext.marker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext.range_done">
<span class="sig-name descname"><span class="pre">range_done</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_cursor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.CleavingContext.range_done" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.CleavingContext.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext.start">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.CleavingContext.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.CleavingContext.store">
<span class="sig-name descname"><span class="pre">store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.CleavingContext.store" title="Permalink to this definition">¶</a></dt>
<dd><p>Persists the serialized <code class="docutils literal notranslate"><span class="pre">CleavingContext</span></code> as sysmeta in the given
broker’s DB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>broker</strong> – an instances of <code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">ContainerSharder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.container.sharder.ContainerSharderConf" title="swift.container.sharder.ContainerSharderConf"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerSharderConf</span></code></a>, <a class="reference internal" href="#swift.container.replicator.ContainerReplicator" title="swift.container.replicator.ContainerReplicator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerReplicator</span></code></a></p>
<p>Shards containers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharder.debug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder.error">
<span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharder.error" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder.exception">
<span class="sig-name descname"><span class="pre">exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharder.exception" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharder.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder.log_route">
<span class="sig-name descname"><span class="pre">log_route</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'container-sharder'</span></em><a class="headerlink" href="#swift.container.sharder.ContainerSharder.log_route" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder.run_forever">
<span class="sig-name descname"><span class="pre">run_forever</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharder.run_forever" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the container sharder until stopped.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder.run_once">
<span class="sig-name descname"><span class="pre">run_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharder.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the container sharder once.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder.warning">
<span class="sig-name descname"><span class="pre">warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharder.warning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder.yield_objects">
<span class="sig-name descname"><span class="pre">yield_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_shard_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">since_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharder.yield_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterates through all object rows in <code class="docutils literal notranslate"><span class="pre">src_shard_range</span></code> in name order
yielding them in lists of up to <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> in length. All batches
of rows that are not marked deleted are yielded before all batches of
rows that are marked deleted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>broker</strong> – A <a class="reference internal" href="#swift.container.backend.ContainerBroker" title="swift.container.backend.ContainerBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></a>.</p></li>
<li><p><strong>src_shard_range</strong> – A <a class="reference internal" href="misc.html#swift.common.utils.ShardRange" title="swift.common.utils.ShardRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRange</span></code></a>
describing the source range.</p></li>
<li><p><strong>since_row</strong> – include only object rows whose ROWID is greater than
the given row id; by default all object rows are included.</p></li>
<li><p><strong>batch_size</strong> – The maximum number of object rows to include in each
yielded batch; defaults to cleave_row_batch_size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a generator of tuples of (list of rows, broker info dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharder.yield_objects_to_shard_range">
<span class="sig-name descname"><span class="pre">yield_objects_to_shard_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_shard_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_shard_ranges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharder.yield_objects_to_shard_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterates through all object rows in <code class="docutils literal notranslate"><span class="pre">src_shard_range</span></code> to place them
in destination shard ranges provided by the <code class="docutils literal notranslate"><span class="pre">dest_shard_ranges</span></code>
function. Yields tuples of <code class="docutils literal notranslate"><span class="pre">(batch</span> <span class="pre">of</span> <span class="pre">object</span> <span class="pre">rows,</span> <span class="pre">destination</span> <span class="pre">shard</span>
<span class="pre">range</span> <span class="pre">in</span> <span class="pre">which</span> <span class="pre">those</span> <span class="pre">object</span> <span class="pre">rows</span> <span class="pre">belong,</span> <span class="pre">broker</span> <span class="pre">info)</span></code>.</p>
<p>If no destination shard range exists for a batch of object rows then
tuples are yielded of <code class="docutils literal notranslate"><span class="pre">(batch</span> <span class="pre">of</span> <span class="pre">object</span> <span class="pre">rows,</span> <span class="pre">None,</span> <span class="pre">broker</span> <span class="pre">info)</span></code>.
This indicates to the caller that there are a non-zero number of object
rows for which no destination shard range was found.</p>
<p>Note that the same destination shard range may be referenced in more
than one yielded tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>broker</strong> – A <a class="reference internal" href="#swift.container.backend.ContainerBroker" title="swift.container.backend.ContainerBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></a>.</p></li>
<li><p><strong>src_shard_range</strong> – A <a class="reference internal" href="misc.html#swift.common.utils.ShardRange" title="swift.common.utils.ShardRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRange</span></code></a>
describing the source range.</p></li>
<li><p><strong>dest_shard_ranges</strong> – A function which should return a list of
destination shard ranges sorted in the order defined by
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sort_key()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a generator of tuples of <code class="docutils literal notranslate"><span class="pre">(object</span> <span class="pre">row</span> <span class="pre">list,</span> <span class="pre">shard</span> <span class="pre">range,</span>
<span class="pre">broker</span> <span class="pre">info</span> <span class="pre">dict)</span></code>  where <code class="docutils literal notranslate"><span class="pre">shard_range</span></code> may be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharderConf">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">ContainerSharderConf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharderConf" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharderConf.percent_of_threshold">
<span class="sig-name descname"><span class="pre">percent_of_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharderConf.percent_of_threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sharder.ContainerSharderConf.validate_conf">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_conf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">namespace</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.ContainerSharderConf.validate_conf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.combine_shard_ranges">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">combine_shard_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_shard_ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">existing_shard_ranges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.combine_shard_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines new and existing shard ranges based on most recent state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_shard_ranges</strong> – a list of ShardRange instances.</p></li>
<li><p><strong>existing_shard_ranges</strong> – a list of ShardRange instances.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of ShardRange instances.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.finalize_shrinking">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">finalize_shrinking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptor_ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">donor_ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.finalize_shrinking" title="Permalink to this definition">¶</a></dt>
<dd><p>Update donor shard ranges to shrinking state and merge donors and acceptors
to broker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>broker</strong> – A <a class="reference internal" href="#swift.container.backend.ContainerBroker" title="swift.container.backend.ContainerBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></a>.</p></li>
<li><p><strong>acceptor_ranges</strong> – A list of <a class="reference internal" href="misc.html#swift.common.utils.ShardRange" title="swift.common.utils.ShardRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRange</span></code></a>
that are to be acceptors.</p></li>
<li><p><strong>donor_ranges</strong> – A list of <a class="reference internal" href="misc.html#swift.common.utils.ShardRange" title="swift.common.utils.ShardRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRange</span></code></a>
that are to be donors; these will have their state and timestamp
updated.</p></li>
<li><p><strong>timestamp</strong> – timestamp to use when updating donor state</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.find_compactible_shard_sequences">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">find_compactible_shard_sequences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion_limit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_shrinking</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_expanding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_shrinking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.find_compactible_shard_sequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Find sequences of shard ranges that could be compacted into a single
acceptor shard range.</p>
<p>This function does not modify shard ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>broker</strong> – A <a class="reference internal" href="#swift.container.backend.ContainerBroker" title="swift.container.backend.ContainerBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></a>.</p></li>
<li><p><strong>shrink_threshold</strong> – the number of rows below which a shard may be
considered for shrinking into another shard</p></li>
<li><p><strong>expansion_limit</strong> – the maximum number of rows that an acceptor shard
range should have after other shard ranges have been compacted into it</p></li>
<li><p><strong>max_shrinking</strong> – the maximum number of shard ranges that should be
compacted into each acceptor; -1 implies unlimited.</p></li>
<li><p><strong>max_expanding</strong> – the maximum number of acceptors to be found (i.e. the
maximum number of sequences to be returned); -1 implies unlimited.</p></li>
<li><p><strong>include_shrinking</strong> – if True then existing compactible sequences are
included in the results; default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of <a class="reference internal" href="misc.html#swift.common.utils.ShardRangeList" title="swift.common.utils.ShardRangeList"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRangeList</span></code></a> each
containing a sequence of neighbouring shard ranges that may be
compacted; the final shard range in the list is the acceptor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.find_overlapping_ranges">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">find_overlapping_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shard_ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_parent_child</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.find_overlapping_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all pairs of overlapping ranges in the given list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shard_ranges</strong> – A list of <code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRange</span></code></p></li>
<li><p><strong>exclude_parent_child</strong> – If True then overlapping pairs that have a
parent-child relationship within the past time period
<code class="docutils literal notranslate"><span class="pre">time_period</span></code> are excluded from the returned set. Default is
False.</p></li>
<li><p><strong>time_period</strong> – the specified past time period in seconds. Value of
0 means all time in the past.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a set of tuples, each tuple containing ranges that overlap with
each other.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.find_paths">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">find_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shard_ranges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.find_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all continuous paths through the shard ranges. An
individual path may not necessarily span the entire namespace, but it will
span a continuous namespace without gaps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shard_ranges</strong> – A list of <a class="reference internal" href="misc.html#swift.common.utils.ShardRange" title="swift.common.utils.ShardRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRange</span></code></a>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of <a class="reference internal" href="misc.html#swift.common.utils.ShardRangeList" title="swift.common.utils.ShardRangeList"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRangeList</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.find_paths_with_gaps">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">find_paths_with_gaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shard_ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">within_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.find_paths_with_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Find gaps in the shard ranges and pairs of shard range paths that lead to
and from those gaps. For each gap a single pair of adjacent paths is
selected. The concatenation of all selected paths and gaps will span the
entire namespace with no overlaps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shard_ranges</strong> – a list of instances of ShardRange.</p></li>
<li><p><strong>within_range</strong> – an optional ShardRange that constrains the search
space; the method will only return gaps within this range. The default
is the entire namespace.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of tuples of <code class="docutils literal notranslate"><span class="pre">(start_path,</span> <span class="pre">gap_range,</span> <span class="pre">end_path)</span></code> where
<code class="docutils literal notranslate"><span class="pre">start_path</span></code> is a list of ShardRanges leading to the gap,
<code class="docutils literal notranslate"><span class="pre">gap_range</span></code> is a ShardRange synthesized to describe the namespace
gap, and <code class="docutils literal notranslate"><span class="pre">end_path</span></code> is a list of ShardRanges leading from the gap.
When gaps start or end at the namespace minimum or maximum bounds,
<code class="docutils literal notranslate"><span class="pre">start_path</span></code> and <code class="docutils literal notranslate"><span class="pre">end_path</span></code> may be ‘null’ paths that contain a
single ShardRange covering either the minimum or maximum of the
namespace.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.find_sharding_candidates">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">find_sharding_candidates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.find_sharding_candidates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.find_shrinking_candidates">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">find_shrinking_candidates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion_limit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.find_shrinking_candidates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.is_sharding_candidate">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">is_sharding_candidate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shard_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.is_sharding_candidate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.is_shrinking_candidate">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">is_shrinking_candidate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shard_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion_limit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.is_shrinking_candidate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.make_shard_ranges">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">make_shard_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shards_account_prefix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.make_shard_ranges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.process_compactible_shard_sequences">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">process_compactible_shard_sequences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequences</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.process_compactible_shard_sequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform the given sequences of shard ranges into a list of acceptors and
a list of shrinking donors. For each given sequence the final ShardRange in
the sequence (the acceptor) is expanded to accommodate the other
ShardRanges in the sequence (the donors). The donors and acceptors are then
merged into the broker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>broker</strong> – A <a class="reference internal" href="#swift.container.backend.ContainerBroker" title="swift.container.backend.ContainerBroker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContainerBroker</span></code></a>.</p></li>
<li><p><strong>sequences</strong> – A list of <a class="reference internal" href="misc.html#swift.common.utils.ShardRangeList" title="swift.common.utils.ShardRangeList"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRangeList</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.random">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">x</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">interval</span> <span class="pre">[0,</span> <span class="pre">1).</span></span></span><a class="headerlink" href="#swift.container.sharder.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.rank_paths">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">rank_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_range_to_span</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.rank_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts the given list of paths such that the most preferred path is the
first item in the list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>paths</strong> – A list of <a class="reference internal" href="misc.html#swift.common.utils.ShardRangeList" title="swift.common.utils.ShardRangeList"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRangeList</span></code></a>.</p></li>
<li><p><strong>shard_range_to_span</strong> – An instance of
<a class="reference internal" href="misc.html#swift.common.utils.ShardRange" title="swift.common.utils.ShardRange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRange</span></code></a> that describes the namespace
that would ideally be spanned by a path. Paths that include this
namespace will be preferred over those that do not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sorted list of <a class="reference internal" href="misc.html#swift.common.utils.ShardRangeList" title="swift.common.utils.ShardRangeList"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardRangeList</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.sharding_enabled">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">sharding_enabled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.sharding_enabled" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sharder.update_own_shard_range_stats">
<span class="sig-prename descclassname"><span class="pre">swift.container.sharder.</span></span><span class="sig-name descname"><span class="pre">update_own_shard_range_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">own_shard_range</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sharder.update_own_shard_range_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the <code class="docutils literal notranslate"><span class="pre">own_shard_range</span></code> with the up-to-date object stats from
the <code class="docutils literal notranslate"><span class="pre">broker</span></code>.</p>
<p>Note: this method does not persist the updated <code class="docutils literal notranslate"><span class="pre">own_shard_range</span></code>;
callers should use <code class="docutils literal notranslate"><span class="pre">broker.merge_shard_ranges</span></code> if the updated stats
need to be persisted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>broker</strong> – an instance of <code class="docutils literal notranslate"><span class="pre">ContainerBroker</span></code>.</p></li>
<li><p><strong>own_shard_range</strong> – and instance of <code class="docutils literal notranslate"><span class="pre">ShardRange</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">own_shard_range</span></code> with up-to-date <code class="docutils literal notranslate"><span class="pre">object_count</span></code>
and <code class="docutils literal notranslate"><span class="pre">bytes_used</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-swift.container.sync">
<span id="container-sync"></span><span id="container-sync-daemon"></span><h2>Container Sync<a class="headerlink" href="#module-swift.container.sync" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.sync.</span></span><span class="sig-name descname"><span class="pre">ContainerSync</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_ring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Daemon</span></code></p>
<p>Daemon to sync syncable containers.</p>
<p>This is done by scanning the local devices for container databases and
checking for x-container-sync-to and x-container-sync-key metadata values.
If they exist, newer rows since the last sync will trigger PUTs or DELETEs
to the other container.</p>
<p>The actual syncing is slightly more complicated to make use of the three
(or number-of-replicas) main nodes for a container without each trying to
do the exact same work but also without missing work if one node happens to
be down.</p>
<p>Two sync points are kept per container database. All rows between the two
sync points trigger updates. Any rows newer than both sync points cause
updates depending on the node’s position for the container (primary nodes
do one third, etc. depending on the replica count of course). After a sync
run, the first sync point is set to the newest ROWID known and the second
sync point is set to newest ROWID for which all updates have been sent.</p>
<p>An example may help. Assume replica count is 3 and perfectly matching
ROWIDs starting at 1.</p>
<blockquote>
<div><p>First sync run, database has 6 rows:</p>
<ul class="simple">
<li><p>SyncPoint1 starts as -1.</p></li>
<li><p>SyncPoint2 starts as -1.</p></li>
<li><p>No rows between points, so no “all updates” rows.</p></li>
<li><p>Six rows newer than SyncPoint1, so a third of the rows are sent
by node 1, another third by node 2, remaining third by node 3.</p></li>
<li><p>SyncPoint1 is set as 6 (the newest ROWID known).</p></li>
<li><p>SyncPoint2 is left as -1 since no “all updates” rows were synced.</p></li>
</ul>
<p>Next sync run, database has 12 rows:</p>
<ul class="simple">
<li><p>SyncPoint1 starts as 6.</p></li>
<li><p>SyncPoint2 starts as -1.</p></li>
<li><p>The rows between -1 and 6 all trigger updates (most of which
should short-circuit on the remote end as having already been
done).</p></li>
<li><p>Six more rows newer than SyncPoint1, so a third of the rows are
sent by node 1, another third by node 2, remaining third by node
3.</p></li>
<li><p>SyncPoint1 is set as 12 (the newest ROWID known).</p></li>
<li><p>SyncPoint2 is set as 6 (the newest “all updates” ROWID).</p></li>
</ul>
</div></blockquote>
<p>In this way, under normal circumstances each node sends its share of
updates each run and just sends a batch of older updates to ensure nothing
was missed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conf</strong> – The dict of configuration values from the [container-sync]
section of the container-server.conf</p></li>
<li><p><strong>container_ring</strong> – If None, the &lt;swift_dir&gt;/container.ring.gz will be
loaded. This is overridden by unit tests.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.allowed_sync_hosts">
<span class="sig-name descname"><span class="pre">allowed_sync_hosts</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.allowed_sync_hosts" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of hosts we’re allowed to send syncs to. This can be
overridden by data in self.realms_conf</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.conf">
<span class="sig-name descname"><span class="pre">conf</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.conf" title="Permalink to this definition">¶</a></dt>
<dd><p>The dict of configuration values from the [container-sync] section
of the container-server.conf.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_deletes">
<span class="sig-name descname"><span class="pre">container_deletes</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_deletes" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of successful DELETEs triggered.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_failures">
<span class="sig-name descname"><span class="pre">container_failures</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_failures" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of containers that had a failure of some type.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_puts">
<span class="sig-name descname"><span class="pre">container_puts</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_puts" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of successful PUTs triggered.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_report">
<span class="sig-name descname"><span class="pre">container_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_point1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_point2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_row</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_report" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_ring">
<span class="sig-name descname"><span class="pre">container_ring</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>swift.common.ring.Ring for locating containers.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_skips">
<span class="sig-name descname"><span class="pre">container_skips</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_skips" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of containers whose sync has been turned off, but
are not yet cleared from the sync store.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_stats">
<span class="sig-name descname"><span class="pre">container_stats</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Per container stats. These are collected per container.
puts - the number of puts that were done for the container
deletes - the number of deletes that were fot the container
bytes - the total number of bytes transferred per the container</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_sync">
<span class="sig-name descname"><span class="pre">container_sync</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_sync" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the given path for a container database, determines if syncing
is turned on for that database and, if so, sends any updates to the
other container.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> – the path to a container db</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_sync_row">
<span class="sig-name descname"><span class="pre">container_sync_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_to</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">realm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">realm_key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_sync_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends the update the row indicates to the sync_to container.
Update can be either delete or put.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row</strong> – The updated row in the local database triggering the sync
update.</p></li>
<li><p><strong>sync_to</strong> – The URL to the remote container.</p></li>
<li><p><strong>user_key</strong> – The X-Container-Sync-Key to use when sending requests
to the other container.</p></li>
<li><p><strong>broker</strong> – The local container database broker.</p></li>
<li><p><strong>info</strong> – The get_info result from the local container database
broker.</p></li>
<li><p><strong>realm</strong> – The realm from self.realms_conf, if there is one.
If None, fallback to using the older allowed_sync_hosts
way of syncing.</p></li>
<li><p><strong>realm_key</strong> – The realm key from self.realms_conf, if there
is one. If None, fallback to using the older
allowed_sync_hosts way of syncing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True on success</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_syncs">
<span class="sig-name descname"><span class="pre">container_syncs</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_syncs" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of containers with sync turned on that were successfully
synced.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.container_time">
<span class="sig-name descname"><span class="pre">container_time</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum amount of time to spend syncing a container before moving on
to the next one. If a container sync hasn’t finished in this time,
it’ll just be resumed next scan.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.devices">
<span class="sig-name descname"><span class="pre">devices</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.devices" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the local device mount points.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.interval">
<span class="sig-name descname"><span class="pre">interval</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum time between full scans. This is to keep the daemon from
running wild on near empty systems.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.log_route">
<span class="sig-name descname"><span class="pre">log_route</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'container-sync'</span></em><a class="headerlink" href="#swift.container.sync.ContainerSync.log_route" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Logger to use for container-sync log lines.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.mount_check">
<span class="sig-name descname"><span class="pre">mount_check</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.mount_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether mount points should be verified as actual mount
points (normally true, false for tests and SAIO).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.realms_conf">
<span class="sig-name descname"><span class="pre">realms_conf</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.realms_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>ContainerSyncCluster instance for validating sync-to values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.report">
<span class="sig-name descname"><span class="pre">report</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a report of the stats to the logger and resets the stats for the
next report.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.reported">
<span class="sig-name descname"><span class="pre">reported</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.reported" title="Permalink to this definition">¶</a></dt>
<dd><p>Time of last stats report.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.run_forever">
<span class="sig-name descname"><span class="pre">run_forever</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.run_forever" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs container sync scans until stopped.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.run_once">
<span class="sig-name descname"><span class="pre">run_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a single container sync scan.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.select_http_proxy">
<span class="sig-name descname"><span class="pre">select_http_proxy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.select_http_proxy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.container.sync.ContainerSync.sync_store">
<span class="sig-name descname"><span class="pre">sync_store</span></span><a class="headerlink" href="#swift.container.sync.ContainerSync.sync_store" title="Permalink to this definition">¶</a></dt>
<dd><p>ContainerSyncStore instance for iterating over synced containers</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.sync.random">
<span class="sig-prename descclassname"><span class="pre">swift.container.sync.</span></span><span class="sig-name descname"><span class="pre">random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">x</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">interval</span> <span class="pre">[0,</span> <span class="pre">1).</span></span></span><a class="headerlink" href="#swift.container.sync.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-swift.container.updater">
<span id="id8"></span><span id="container-updater"></span><h2>Container Updater<a class="headerlink" href="#module-swift.container.updater" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.container.updater.ContainerUpdater">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.container.updater.</span></span><span class="sig-name descname"><span class="pre">ContainerUpdater</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Daemon</span></code></p>
<p>Update container information in account listings.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.container.updater.ContainerUpdater.container_report">
<span class="sig-name descname"><span class="pre">container_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">put_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bytes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_policy_index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.container_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Report container info to an account server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – node dictionary from the account ring</p></li>
<li><p><strong>part</strong> – partition the account is on</p></li>
<li><p><strong>container</strong> – container name</p></li>
<li><p><strong>put_timestamp</strong> – put timestamp</p></li>
<li><p><strong>delete_timestamp</strong> – delete timestamp</p></li>
<li><p><strong>count</strong> – object count in the container</p></li>
<li><p><strong>bytes</strong> – bytes used in the container</p></li>
<li><p><strong>storage_policy_index</strong> – the policy index for the container</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.updater.ContainerUpdater.container_sweep">
<span class="sig-name descname"><span class="pre">container_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.container_sweep" title="Permalink to this definition">¶</a></dt>
<dd><p>Walk the path looking for container DBs and process them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> – path to walk</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.updater.ContainerUpdater.get_account_ring">
<span class="sig-name descname"><span class="pre">get_account_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.get_account_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the account ring.  Load it if it hasn’t been yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.updater.ContainerUpdater.get_paths">
<span class="sig-name descname"><span class="pre">get_paths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.get_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Get paths to all of the partitions on each drive to be processed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of paths</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.updater.ContainerUpdater.process_container">
<span class="sig-name descname"><span class="pre">process_container</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.process_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Process a container, and update the information in the account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dbfile</strong> – container DB to process</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.updater.ContainerUpdater.run_forever">
<span class="sig-name descname"><span class="pre">run_forever</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.run_forever" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the updater continuously.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.container.updater.ContainerUpdater.run_once">
<span class="sig-name descname"><span class="pre">run_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the updater once.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.container.updater.random">
<span class="sig-prename descclassname"><span class="pre">swift.container.updater.</span></span><span class="sig-name descname"><span class="pre">random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">x</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">interval</span> <span class="pre">[0,</span> <span class="pre">1).</span></span></span><a class="headerlink" href="#swift.container.updater.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</section>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="account.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Account"></i></a>
          
          
            <a href="db.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Account DB and Container DB"></i></a>
          
          <a id="pdfLink2" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">this page last updated: 2018-05-02 09:33:17</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="https://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the
                 document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="OpenStack Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/id/">Bahasa Indonesia (Indonesian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/it/">Italiano (Italian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/tr_TR/">Türkçe (Türkiye)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Swift 0.1.0.dev10164</h4></a>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/object_api_v1_overview.html">Object Storage API overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_architecture.html">Swift Architectural Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_ring.html">The Rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_policies.html">Storage Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_reaper.html">The Account Reaper</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_auth.html">The Auth System</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_acl.html">Access Control Lists (ACLs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_replication.html">Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="ratelimit.html">Rate Limiting</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_large_objects.html">Large Object Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_global_cluster.html">Global Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_container_sync.html">Container to Container Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_expiring_objects.html">Expiring Object Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="cors.html">CORS</a></li>
<li class="toctree-l1"><a class="reference internal" href="crossdomain.html">Cross-domain Policy File</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_erasure_code.html">Erasure Code Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_encryption.html">Object Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_backing_store.html">Using Swift as Backing Store for Service Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_container_sharding.html">Container Sharding</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_background.html">Building a Consistent Hashing Ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_partpower.html">Modifying Ring Partition Power</a></li>
<li class="toctree-l1"><a class="reference internal" href="associated_projects.html">Associated Projects</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html">Contributing to OpenStack Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#swift-design-principles">Swift Design Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#recommended-workflow">Recommended workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#notes-on-testing">Notes on Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#ideas">Ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#community">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/review_guidelines.html">Review Guidelines</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development_guidelines.html">Development Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_saio.html">SAIO (Swift All In One)</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_contribution_swift.html">First Contribution to Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies_saio.html">Adding Storage Policies to an Existing SAIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_auth.html">Auth Server and Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_middleware.html">Middleware and Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_ondisk_backends.html">Pluggable On-Disk Back-end APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_watchers.html">Auditor Watchers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deployment_guide.html">Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_deployment_guide.html">Apache Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin_guide.html">Administrator’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="replication_network.html">Dedicated replication network</a></li>
<li class="toctree-l1"><a class="reference internal" href="logs.html">Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops_runbook/index.html">Swift Ops Runbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin/index.html">OpenStack Swift Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="install/index.html">Object Storage Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="config/index.html">Configuration Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/object_api_v1_overview.html">Object Storage API overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/discoverability.html">Discoverability</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/container_quotas.html">Container quotas</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/object_versioning.html">Object versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/large_objects.html">Large objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/temporary_url_middleware.html">Temporary URL middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/form_post_middleware.html">Form POST middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/use_content-encoding_metadata.html">Use Content-Encoding metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/use_the_content-disposition_metadata.html">Use the Content-Disposition metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pseudo-hierarchical-folders-directories.html">Pseudo-hierarchical folders and directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pagination.html">Page through large lists of containers or objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/serialized-response-formats.html">Serialized response formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/static-website.html">Create static website</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/object-expiration.html">Object expiration</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/bulk-delete.html">Bulk delete</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="s3_compat.html">S3/Swift REST API Comparison Matrix</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ring.html">Partitioned Consistent Hash Ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy.html">Proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="account.html">Account</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Container</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.container.auditor">Container Auditor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.container.backend">Container Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.container.replicator">Container Replicator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.container.server">Container Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.container.reconciler">Container Reconciler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.container.sharder">Container Sharder</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.container.sync">Container Sync</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.container.updater">Container Updater</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="db.html">Account DB and Container DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="object.html">Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="middleware.html">Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="audit_watchers.html">Object Audit Watchers</a></li>
</ul>

    </div>

  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="local-table-of-contents">
      <h4 class="docs-sidebar-section-title">Page Contents</h4>
      <ul>
<li><a class="reference internal" href="#">Container</a><ul>
<li><a class="reference internal" href="#module-swift.container.auditor">Container Auditor</a><ul>
<li><a class="reference internal" href="#swift.container.auditor.ContainerAuditor"><code class="docutils literal notranslate"><span class="pre">ContainerAuditor</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.auditor.ContainerAuditor.broker_class"><code class="docutils literal notranslate"><span class="pre">ContainerAuditor.broker_class</span></code></a></li>
<li><a class="reference internal" href="#swift.container.auditor.ContainerAuditor.server_type"><code class="docutils literal notranslate"><span class="pre">ContainerAuditor.server_type</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.container.backend">Container Backend</a><ul>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker"><code class="docutils literal notranslate"><span class="pre">ContainerBroker</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.create_broker"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.create_broker()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.create_container_info_table"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.create_container_info_table()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.create_object_table"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.create_object_table()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.create_policy_stat_table"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.create_policy_stat_table()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.create_shard_range_table"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.create_shard_range_table()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.db_contains_type"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.db_contains_type</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.db_epoch"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.db_epoch</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.db_file"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.db_file</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.db_files"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.db_files</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.db_reclaim_timestamp"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.db_reclaim_timestamp</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.db_type"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.db_type</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.delete_meta_whitelist"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.delete_meta_whitelist</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.delete_object"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.delete_object()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.empty"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.empty()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.enable_sharding"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.enable_sharding()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.find_shard_ranges"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.find_shard_ranges()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_all_shard_range_data"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_all_shard_range_data()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_brokers"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_brokers()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_db_state"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_db_state()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_db_version"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_db_version()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_info"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_info_is_deleted"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_info_is_deleted()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_misplaced_since"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_misplaced_since()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_objects"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_objects()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_own_shard_range"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_own_shard_range()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_policy_stats"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_policy_stats()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_reconciler_sync"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_reconciler_sync()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_replication_info"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_replication_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_shard_ranges"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_shard_ranges()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_shard_usage"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_shard_usage()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_sharding_sysmeta"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_sharding_sysmeta()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.get_sharding_sysmeta_with_timestamps"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.get_sharding_sysmeta_with_timestamps()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.has_multiple_policies"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.has_multiple_policies()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.is_empty_enough_to_reclaim"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.is_empty_enough_to_reclaim()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.is_old_enough_to_reclaim"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.is_old_enough_to_reclaim()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.is_own_shard_range"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.is_own_shard_range()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.is_reclaimable"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.is_reclaimable()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.is_root_container"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.is_root_container()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.is_sharded"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.is_sharded()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.list_objects_iter"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.list_objects_iter()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.make_tuple_for_pickle"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.make_tuple_for_pickle()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.merge_items"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.merge_items()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.merge_shard_ranges"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.merge_shard_ranges()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.path"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.path</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.put_object"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.put_object()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.reload_db_files"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.reload_db_files()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.remove_objects"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.remove_objects()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.reported"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.reported()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.resolve_shard_range_states"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.resolve_shard_range_states()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.root_account"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.root_account</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.root_container"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.root_container</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.root_path"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.root_path</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.set_sharded_state"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.set_sharded_state()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.set_sharding_state"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.set_sharding_state()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.set_sharding_sysmeta"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.set_sharding_sysmeta()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.set_storage_policy_index"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.set_storage_policy_index()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.set_x_container_sync_points"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.set_x_container_sync_points()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.sharding_initiated"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.sharding_initiated()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.sharding_required"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.sharding_required()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.storage_policy_index"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.storage_policy_index</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.ContainerBroker.update_reconciler_sync"><code class="docutils literal notranslate"><span class="pre">ContainerBroker.update_reconciler_sync()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.container.backend.merge_shards"><code class="docutils literal notranslate"><span class="pre">merge_shards()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.sift_shard_ranges"><code class="docutils literal notranslate"><span class="pre">sift_shard_ranges()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.backend.update_new_item_from_existing"><code class="docutils literal notranslate"><span class="pre">update_new_item_from_existing()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.container.replicator">Container Replicator</a><ul>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.brokerclass"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.brokerclass</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.cleanup_post_replicate"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.cleanup_post_replicate()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.datadir"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.datadir</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.default_port"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.default_port</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.delete_db"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.delete_db()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.dump_to_reconciler"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.dump_to_reconciler()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.feed_reconciler"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.feed_reconciler()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.find_local_handoff_for_part"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.find_local_handoff_for_part()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.get_reconciler_broker"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.get_reconciler_broker()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.replicate_reconcilers"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.replicate_reconcilers()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.report_up_to_date"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.report_up_to_date()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.run_once"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.run_once()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicator.server_type"><code class="docutils literal notranslate"><span class="pre">ContainerReplicator.server_type</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicatorRpc"><code class="docutils literal notranslate"><span class="pre">ContainerReplicatorRpc</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicatorRpc.get_shard_ranges"><code class="docutils literal notranslate"><span class="pre">ContainerReplicatorRpc.get_shard_ranges()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.replicator.ContainerReplicatorRpc.merge_shard_ranges"><code class="docutils literal notranslate"><span class="pre">ContainerReplicatorRpc.merge_shard_ranges()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.container.server">Container Server</a><ul>
<li><a class="reference internal" href="#swift.container.server.ContainerController"><code class="docutils literal notranslate"><span class="pre">ContainerController</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.server.ContainerController.DELETE"><code class="docutils literal notranslate"><span class="pre">ContainerController.DELETE()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.GET"><code class="docutils literal notranslate"><span class="pre">ContainerController.GET()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.HEAD"><code class="docutils literal notranslate"><span class="pre">ContainerController.HEAD()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.POST"><code class="docutils literal notranslate"><span class="pre">ContainerController.POST()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.PUT"><code class="docutils literal notranslate"><span class="pre">ContainerController.PUT()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.REPLICATE"><code class="docutils literal notranslate"><span class="pre">ContainerController.REPLICATE()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.UPDATE"><code class="docutils literal notranslate"><span class="pre">ContainerController.UPDATE()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.account_update"><code class="docutils literal notranslate"><span class="pre">ContainerController.account_update()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.allowed_sync_hosts"><code class="docutils literal notranslate"><span class="pre">ContainerController.allowed_sync_hosts</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.check_free_space"><code class="docutils literal notranslate"><span class="pre">ContainerController.check_free_space()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.create_listing"><code class="docutils literal notranslate"><span class="pre">ContainerController.create_listing()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.get_and_validate_policy_index"><code class="docutils literal notranslate"><span class="pre">ContainerController.get_and_validate_policy_index()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.realms_conf"><code class="docutils literal notranslate"><span class="pre">ContainerController.realms_conf</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.save_headers"><code class="docutils literal notranslate"><span class="pre">ContainerController.save_headers</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.server_type"><code class="docutils literal notranslate"><span class="pre">ContainerController.server_type</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.ContainerController.update_data_record"><code class="docutils literal notranslate"><span class="pre">ContainerController.update_data_record()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.container.server.app_factory"><code class="docutils literal notranslate"><span class="pre">app_factory()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.gen_resp_headers"><code class="docutils literal notranslate"><span class="pre">gen_resp_headers()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.get_container_name_and_placement"><code class="docutils literal notranslate"><span class="pre">get_container_name_and_placement()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.server.get_obj_name_and_placement"><code class="docutils literal notranslate"><span class="pre">get_obj_name_and_placement()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.container.reconciler">Container Reconciler</a><ul>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.can_reconcile_policy"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.can_reconcile_policy()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.ensure_object_in_right_location"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.ensure_object_in_right_location()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.ensure_tombstone_in_right_location"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.ensure_tombstone_in_right_location()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.log_route"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.log_route</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.log_stats"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.log_stats()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.pop_queue"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.pop_queue()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.process_queue_item"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.process_queue_item()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.reconcile"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.reconcile()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.reconcile_object"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.reconcile_object()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.run_forever"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.run_forever()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.run_once"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.run_once()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.should_process"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.should_process()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.stats_log"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.stats_log()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.ContainerReconciler.throw_tombstones"><code class="docutils literal notranslate"><span class="pre">ContainerReconciler.throw_tombstones()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.container.reconciler.add_to_reconciler_queue"><code class="docutils literal notranslate"><span class="pre">add_to_reconciler_queue()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.best_policy_index"><code class="docutils literal notranslate"><span class="pre">best_policy_index()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.cmp_policy_info"><code class="docutils literal notranslate"><span class="pre">cmp_policy_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.direct_delete_container_entry"><code class="docutils literal notranslate"><span class="pre">direct_delete_container_entry()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.get_reconciler_container_name"><code class="docutils literal notranslate"><span class="pre">get_reconciler_container_name()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.get_reconciler_content_type"><code class="docutils literal notranslate"><span class="pre">get_reconciler_content_type()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.get_reconciler_obj_name"><code class="docutils literal notranslate"><span class="pre">get_reconciler_obj_name()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.get_row_to_q_entry_translator"><code class="docutils literal notranslate"><span class="pre">get_row_to_q_entry_translator()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.incorrect_policy_index"><code class="docutils literal notranslate"><span class="pre">incorrect_policy_index()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.parse_raw_obj"><code class="docutils literal notranslate"><span class="pre">parse_raw_obj()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.slightly_later_timestamp"><code class="docutils literal notranslate"><span class="pre">slightly_later_timestamp()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.reconciler.translate_container_headers_to_info"><code class="docutils literal notranslate"><span class="pre">translate_container_headers_to_info()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.container.sharder">Container Sharder</a><ul>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext"><code class="docutils literal notranslate"><span class="pre">CleavingContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext.cursor"><code class="docutils literal notranslate"><span class="pre">CleavingContext.cursor</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext.delete"><code class="docutils literal notranslate"><span class="pre">CleavingContext.delete()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext.done"><code class="docutils literal notranslate"><span class="pre">CleavingContext.done()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext.load"><code class="docutils literal notranslate"><span class="pre">CleavingContext.load()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext.load_all"><code class="docutils literal notranslate"><span class="pre">CleavingContext.load_all()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext.marker"><code class="docutils literal notranslate"><span class="pre">CleavingContext.marker</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext.range_done"><code class="docutils literal notranslate"><span class="pre">CleavingContext.range_done()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext.reset"><code class="docutils literal notranslate"><span class="pre">CleavingContext.reset()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext.start"><code class="docutils literal notranslate"><span class="pre">CleavingContext.start()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.CleavingContext.store"><code class="docutils literal notranslate"><span class="pre">CleavingContext.store()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder"><code class="docutils literal notranslate"><span class="pre">ContainerSharder</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder.debug"><code class="docutils literal notranslate"><span class="pre">ContainerSharder.debug()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder.error"><code class="docutils literal notranslate"><span class="pre">ContainerSharder.error()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder.exception"><code class="docutils literal notranslate"><span class="pre">ContainerSharder.exception()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder.info"><code class="docutils literal notranslate"><span class="pre">ContainerSharder.info()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder.log_route"><code class="docutils literal notranslate"><span class="pre">ContainerSharder.log_route</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder.run_forever"><code class="docutils literal notranslate"><span class="pre">ContainerSharder.run_forever()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder.run_once"><code class="docutils literal notranslate"><span class="pre">ContainerSharder.run_once()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder.warning"><code class="docutils literal notranslate"><span class="pre">ContainerSharder.warning()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder.yield_objects"><code class="docutils literal notranslate"><span class="pre">ContainerSharder.yield_objects()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharder.yield_objects_to_shard_range"><code class="docutils literal notranslate"><span class="pre">ContainerSharder.yield_objects_to_shard_range()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharderConf"><code class="docutils literal notranslate"><span class="pre">ContainerSharderConf</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharderConf.percent_of_threshold"><code class="docutils literal notranslate"><span class="pre">ContainerSharderConf.percent_of_threshold()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.ContainerSharderConf.validate_conf"><code class="docutils literal notranslate"><span class="pre">ContainerSharderConf.validate_conf()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.container.sharder.combine_shard_ranges"><code class="docutils literal notranslate"><span class="pre">combine_shard_ranges()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.finalize_shrinking"><code class="docutils literal notranslate"><span class="pre">finalize_shrinking()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.find_compactible_shard_sequences"><code class="docutils literal notranslate"><span class="pre">find_compactible_shard_sequences()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.find_overlapping_ranges"><code class="docutils literal notranslate"><span class="pre">find_overlapping_ranges()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.find_paths"><code class="docutils literal notranslate"><span class="pre">find_paths()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.find_paths_with_gaps"><code class="docutils literal notranslate"><span class="pre">find_paths_with_gaps()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.find_sharding_candidates"><code class="docutils literal notranslate"><span class="pre">find_sharding_candidates()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.find_shrinking_candidates"><code class="docutils literal notranslate"><span class="pre">find_shrinking_candidates()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.is_sharding_candidate"><code class="docutils literal notranslate"><span class="pre">is_sharding_candidate()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.is_shrinking_candidate"><code class="docutils literal notranslate"><span class="pre">is_shrinking_candidate()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.make_shard_ranges"><code class="docutils literal notranslate"><span class="pre">make_shard_ranges()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.process_compactible_shard_sequences"><code class="docutils literal notranslate"><span class="pre">process_compactible_shard_sequences()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.random"><code class="docutils literal notranslate"><span class="pre">random()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.rank_paths"><code class="docutils literal notranslate"><span class="pre">rank_paths()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.sharding_enabled"><code class="docutils literal notranslate"><span class="pre">sharding_enabled()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sharder.update_own_shard_range_stats"><code class="docutils literal notranslate"><span class="pre">update_own_shard_range_stats()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.container.sync">Container Sync</a><ul>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync"><code class="docutils literal notranslate"><span class="pre">ContainerSync</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.allowed_sync_hosts"><code class="docutils literal notranslate"><span class="pre">ContainerSync.allowed_sync_hosts</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.conf"><code class="docutils literal notranslate"><span class="pre">ContainerSync.conf</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_deletes"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_deletes</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_failures"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_failures</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_puts"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_puts</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_report"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_report()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_ring"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_ring</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_skips"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_skips</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_stats"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_stats</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_sync"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_sync()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_sync_row"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_sync_row()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_syncs"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_syncs</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.container_time"><code class="docutils literal notranslate"><span class="pre">ContainerSync.container_time</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.devices"><code class="docutils literal notranslate"><span class="pre">ContainerSync.devices</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.interval"><code class="docutils literal notranslate"><span class="pre">ContainerSync.interval</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.log_route"><code class="docutils literal notranslate"><span class="pre">ContainerSync.log_route</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.logger"><code class="docutils literal notranslate"><span class="pre">ContainerSync.logger</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.mount_check"><code class="docutils literal notranslate"><span class="pre">ContainerSync.mount_check</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.realms_conf"><code class="docutils literal notranslate"><span class="pre">ContainerSync.realms_conf</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.report"><code class="docutils literal notranslate"><span class="pre">ContainerSync.report()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.reported"><code class="docutils literal notranslate"><span class="pre">ContainerSync.reported</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.run_forever"><code class="docutils literal notranslate"><span class="pre">ContainerSync.run_forever()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.run_once"><code class="docutils literal notranslate"><span class="pre">ContainerSync.run_once()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.select_http_proxy"><code class="docutils literal notranslate"><span class="pre">ContainerSync.select_http_proxy()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.sync.ContainerSync.sync_store"><code class="docutils literal notranslate"><span class="pre">ContainerSync.sync_store</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.container.sync.random"><code class="docutils literal notranslate"><span class="pre">random()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.container.updater">Container Updater</a><ul>
<li><a class="reference internal" href="#swift.container.updater.ContainerUpdater"><code class="docutils literal notranslate"><span class="pre">ContainerUpdater</span></code></a><ul>
<li><a class="reference internal" href="#swift.container.updater.ContainerUpdater.container_report"><code class="docutils literal notranslate"><span class="pre">ContainerUpdater.container_report()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.updater.ContainerUpdater.container_sweep"><code class="docutils literal notranslate"><span class="pre">ContainerUpdater.container_sweep()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.updater.ContainerUpdater.get_account_ring"><code class="docutils literal notranslate"><span class="pre">ContainerUpdater.get_account_ring()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.updater.ContainerUpdater.get_paths"><code class="docutils literal notranslate"><span class="pre">ContainerUpdater.get_paths()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.updater.ContainerUpdater.process_container"><code class="docutils literal notranslate"><span class="pre">ContainerUpdater.process_container()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.updater.ContainerUpdater.run_forever"><code class="docutils literal notranslate"><span class="pre">ContainerUpdater.run_forever()</span></code></a></li>
<li><a class="reference internal" href="#swift.container.updater.ContainerUpdater.run_once"><code class="docutils literal notranslate"><span class="pre">ContainerUpdater.run_once()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.container.updater.random"><code class="docutils literal notranslate"><span class="pre">random()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
  </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="https://openstack.org/projects/">Projects</a></li>
          <li><a href="https://www.openstack.org/software/security/">OpenStack Security</a></li>
          <li><a href="https://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="https://openstack.org/blog/">Blog</a></li>g
          <li><a href="https://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="https://openstack.org/community/">User Groups</a></li>
          <li><a href="https://openstack.org/community/events/">Events</a></li>
          <li><a href="https://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="https://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="https://docs.openstack.org/contributors">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="https://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="https://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="https://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="https://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="https://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="https://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="https://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-3.2.1.min.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- standard sphinx include libraries, which allow search highlighting -->
<script type="text/javascript" src="_static/underscore.js"></script>
<script type="text/javascript" src="_static/doctools.js"></script>
<script type="text/javascript" src="_static/searchtools.js"></script>
<script type="text/javascript" src="_static/language_data.js"></script>

<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.1.0.dev10164',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      LINK_SUFFIX: '.html',
      SOURCELINK_SUFFIX: '.txt',
      HAS_SOURCE:  true
    };
</script>

<!-- Javascript for page -->
<script language="JavaScript">
  /* Build a description of this page including SHA, source location on git
   * repo, build time and the project's launchpad bug tag. Set the HREF of the
   * bug buttons
   */
    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
    /* "giturl" is the URL of the source file on Git and is auto-generated by
     * openstackdocstheme.
     *
     * "pagename" is a standard sphinx parameter containing the name of
     * the source file, without extension.
     */

    var sourceFile = "container" + ".rst";
    gitURL = "Source: https://opendev.org/openstack/swift/src/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: c7afe681fd119752e66a8e9032e8782641fec3ff";
    var repositoryName = "openstack/swift";
    var bugProject = "swift";
    var bugTitle = "Container in Swift";
    var fieldTags = "";
    var useStoryboard = "";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.1.0.dev10164 on 2018-05-02 09:33:17";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags, repositoryName, useStoryboard);
    var currentSourceFile = "container";
    var pdfFileName = "doc-swift.pdf";
    pdfLink(currentSourceFile, pdfFileName);
</script>


  </body>
</html>