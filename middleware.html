
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Middleware &#8212; Swift 0.1.0.dev10164 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/basic.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="canonical" href="/openstack-swift/middleware.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Object Audit Watchers" href="audit_watchers.html" />
    <link rel="prev" title="Misc" href="misc.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">

<!-- Search CSS -->
<link href="_static/css/search.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/pygments.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


  </head><body>

<!-- SOURCE_FILE: https://opendev.org/openstack/swift/src/doc/source/middleware.rst -->

<script>
    (function (window, document) {
        var loader = function () {
            var script = document.createElement("script"), tag = document.getElementsByTagName("script")[0];
            script.src = "https://search.openstack.org/widget/embed.min.js?t="+Date.now();
            tag.parentNode.insertBefore(script, tag);
        };
        window.addEventListener ? window.addEventListener("load", loader, false) : window.attachEvent("onload", loader);
    })(window, document);
</script>

<nav class="navbar navbar-default" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="https://www.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</div>
      <ul class="nav navbar-nav navbar-main show">
        <li class="search-container-mobile">
    <div class="openstack-search-bar" data-baseUrl="search.openstack.org" data-context="docs-openstack"></div>
</li>
        <li> <!--Software -->
          <a href="https://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/openstack-components">OpenStack Components</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/sdks">SDKs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/project-navigator/deployment-tools">Deployment Tools</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/assets/software/projectmap/openstack-map.pdf" target="_blank">OpenStack Map</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
          </ul>
        </li>
        <li> <!-- Use Cases -->
          <a href="https://www.openstack.org/use-cases/" class="drop" id="dropdownMenuUsers">Use Cases <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/">Users in Production</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/bare-metal/">Ironic Bare Metal</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/edge-computing/">Edge Computing</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/telecoms-and-nfv/">Telecom & NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/science/">Science and HPC</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/containers/">Containers</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/use-cases/enterprise/">Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li> <!-- Events -->
          <a href="https://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">Open Infrastructure Summits</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/ptg/">Project Teams Gathering</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/opendev-2020/">OpenDev</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/community-events/">Community Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/events/openstackdays">OpenStack & OpenInfra Days</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
          </ul>
        </li>
        <li><!-- Community -->
          <a href="https://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/tech-committee">OpenStack Technical Committee</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/coa/">Get Certified (COA)</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketing/">Marketing Resources</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/news/">Community News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/supporting-organizations/">OpenInfra Foundation Supporting Organizations</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">Open Infrastructure Foundation (OpenInfra Foundation)</a></li>
          </ul>
        </li>
        <li><!-- Marketplace -->
          <a href="https://www.openstack.orgmarketplace/" class="drop" id="dropdownMenuLearn">Marketplace <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/distros/">Distros & Appliances</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/public-clouds/">Public Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/hosted-private-clouds/">Hosted Private Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/remotely-managed-private-clouds/">Remotely Managed Private Clouds</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/consulting/">Consulting & Integrators</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/drivers/">Drivers</a></li>
          </ul>
        </li>
        <li><!-- Blog -->
          <a href="https://www.openstack.org/blog/">Blog</a>
        </li>
        <li><!-- Docs -->
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
        <li> <!-- Join -->
            <li class="join-nav-section">
              <a href="https://openinfra.dev/join/" id="dropdownMenuJoin">Join <i class="fa fa-caret-down"></i></a>
              <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuJoin" style="display: none;">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sign up for Foundation Membership</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev/join/">Sponsor the Foundation</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="https://openinfra.dev">More about the Foundation</a></li>
              </ul>
            </li>
            <li>
              <a href="https://www.openstack.org/Security/login/?BackURL=/home/" class="sign-in-btn">Log In</a>
            </li>
        </li>
      </ul>
    </div>
  </div>
  <!-- /.container -->
</nav>

    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row docs-title">
  <div class="col-lg-8">
      <h1>Middleware</h1>
    
  </div>
  <div class="docs-actions">
    
    <a href="misc.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Misc"></i></a>
    
    
    <a href="audit_watchers.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Object Audit Watchers"></i></a>
    
    <a id="pdfLink1" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
    
  </div>
</div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-body" role="main">

  <section id="middleware">
<span id="common-middleware"></span><h1>Middleware<a class="headerlink" href="#middleware" title="Permalink to this heading">¶</a></h1>
<section id="module-swift.common.middleware.account_quotas">
<span id="id1"></span><span id="account-quotas"></span><h2>Account Quotas<a class="headerlink" href="#module-swift.common.middleware.account_quotas" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">account_quotas</span></code> is a middleware which blocks write requests (PUT, POST) if a
given account quota (in bytes) is exceeded while DELETE requests are still
allowed.</p>
<p><code class="docutils literal notranslate"><span class="pre">account_quotas</span></code> uses the <code class="docutils literal notranslate"><span class="pre">x-account-meta-quota-bytes</span></code> metadata entry to
store the quota. Write requests to this metadata entry are only permitted for
resellers. There is no quota limit if <code class="docutils literal notranslate"><span class="pre">x-account-meta-quota-bytes</span></code> is not
set.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">account_quotas</span></code> middleware should be added to the pipeline in your
<code class="docutils literal notranslate"><span class="pre">/etc/swift/proxy-server.conf</span></code> file just after any auth middleware.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">pipeline</span><span class="p">:</span><span class="n">main</span><span class="p">]</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">catch_errors</span> <span class="n">cache</span> <span class="n">tempauth</span> <span class="n">account_quotas</span> <span class="n">proxy</span><span class="o">-</span><span class="n">server</span>

<span class="p">[</span><span class="nb">filter</span><span class="p">:</span><span class="n">account_quotas</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#account_quotas</span>
</pre></div>
</div>
<p>To set the quota on an account:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="o">-</span><span class="n">A</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">auth</span><span class="o">/</span><span class="n">v1</span><span class="mf">.0</span> <span class="o">-</span><span class="n">U</span> <span class="n">account</span><span class="p">:</span><span class="n">reseller</span> <span class="o">-</span><span class="n">K</span> <span class="n">secret</span> <span class="n">post</span> <span class="o">-</span><span class="n">m</span> <span class="n">quota</span><span class="o">-</span><span class="nb">bytes</span><span class="p">:</span><span class="mi">10000</span>
</pre></div>
</div>
<p>Remove the quota:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="o">-</span><span class="n">A</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">auth</span><span class="o">/</span><span class="n">v1</span><span class="mf">.0</span> <span class="o">-</span><span class="n">U</span> <span class="n">account</span><span class="p">:</span><span class="n">reseller</span> <span class="o">-</span><span class="n">K</span> <span class="n">secret</span> <span class="n">post</span> <span class="o">-</span><span class="n">m</span> <span class="n">quota</span><span class="o">-</span><span class="nb">bytes</span><span class="p">:</span>
</pre></div>
</div>
<p>The same limitations apply for the account quotas as for the container quotas.</p>
<p>For example, when uploading an object without a content-length header the proxy
server doesn’t know the final size of the currently uploaded object and the
upload will be allowed if the current account size is within the quota.
Due to the eventual consistency further uploads might be possible until the
account size has been updated.</p>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.account_quotas.AccountQuotaMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.account_quotas.</span></span><span class="sig-name descname"><span class="pre">AccountQuotaMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.account_quotas.AccountQuotaMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Account quota middleware</p>
<p>See above for a full description.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.account_quotas.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.account_quotas.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.account_quotas.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a WSGI filter app for use with paste.deploy.</p>
</dd></dl>

</section>
<section id="module-swift.common.middleware.s3api.s3api">
<span id="aws-s3-api"></span><span id="s3api"></span><h2>AWS S3 Api<a class="headerlink" href="#module-swift.common.middleware.s3api.s3api" title="Permalink to this heading">¶</a></h2>
<p>The s3api middleware will emulate the S3 REST api on top of swift.</p>
<p>To enable this middleware to your configuration, add the s3api middleware
in front of the auth middleware. See <code class="docutils literal notranslate"><span class="pre">proxy-server.conf-sample</span></code> for more
detail and configurable options.</p>
<p>To set up your client, ensure you are using the tempauth or keystone auth
system for swift project.
When your swift on a SAIO environment, make sure you have setting the tempauth
middleware configuration in <code class="docutils literal notranslate"><span class="pre">proxy-server.conf</span></code>, and the access key will be
the concatenation of the account and user strings that should look like
test:tester, and the secret access key is the account password. The host should
also point to the swift storage hostname.</p>
<p>The tempauth option example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[filter:tempauth]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#tempauth</span>
<span class="na">user_admin_admin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">admin .admin .reseller_admin</span>
<span class="na">user_test_tester</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">testing</span>
</pre></div>
</div>
<p>An example client using tempauth with the python boto library is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">boto.s3.connection</span> <span class="kn">import</span> <span class="n">S3Connection</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">S3Connection</span><span class="p">(</span>
    <span class="n">aws_access_key_id</span><span class="o">=</span><span class="s1">&#39;test:tester&#39;</span><span class="p">,</span>
    <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s1">&#39;testing&#39;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span>
    <span class="n">is_secure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">calling_format</span><span class="o">=</span><span class="n">boto</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">OrdinaryCallingFormat</span><span class="p">())</span>
</pre></div>
</div>
<p>And if you using keystone auth, you need the ec2 credentials, which can
be downloaded from the API Endpoints tab of the dashboard or by openstack
ec2 command.</p>
<p>Here is showing to create an EC2 credential:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>openstack<span class="w"> </span>ec2<span class="w"> </span>credentials<span class="w"> </span>create
<span class="go">+------------+---------------------------------------------------+</span>
<span class="go">| Field      | Value                                             |</span>
<span class="go">+------------+---------------------------------------------------+</span>
<span class="go">| access     | c2e30f2cd5204b69a39b3f1130ca8f61                  |</span>
<span class="go">| links      | {u&#39;self&#39;: u&#39;http://controller:5000/v3/......&#39;}    |</span>
<span class="go">| project_id | 407731a6c2d0425c86d1e7f12a900488                  |</span>
<span class="go">| secret     | baab242d192a4cd6b68696863e07ed59                  |</span>
<span class="go">| trust_id   | None                                              |</span>
<span class="go">| user_id    | 00f0ee06afe74f81b410f3fe03d34fbc                  |</span>
<span class="go">+------------+---------------------------------------------------+</span>
</pre></div>
</div>
<p>An example client using keystone auth with the python boto library will be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">boto.s3.connection</span> <span class="kn">import</span> <span class="n">S3Connection</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">S3Connection</span><span class="p">(</span>
    <span class="n">aws_access_key_id</span><span class="o">=</span><span class="s1">&#39;c2e30f2cd5204b69a39b3f1130ca8f61&#39;</span><span class="p">,</span>
    <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="s1">&#39;baab242d192a4cd6b68696863e07ed59&#39;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span>
    <span class="n">is_secure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">calling_format</span><span class="o">=</span><span class="n">boto</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">OrdinaryCallingFormat</span><span class="p">())</span>
</pre></div>
</div>
<section id="deployment">
<h3>Deployment<a class="headerlink" href="#deployment" title="Permalink to this heading">¶</a></h3>
<section id="proxy-server-setting">
<h4>Proxy-Server Setting<a class="headerlink" href="#proxy-server-setting" title="Permalink to this heading">¶</a></h4>
<p>Set s3api before your auth in your pipeline in <code class="docutils literal notranslate"><span class="pre">proxy-server.conf</span></code> file.
To enable all compatibility currently supported, you should make sure that
bulk, slo, and your auth middleware are also included in your proxy
pipeline setting.</p>
<p>Using tempauth, the minimum example config is:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">proxy-logging cache s3api tempauth bulk slo proxy-logging proxy-server</span>
</pre></div>
</div>
<p>When using keystone, the config will be:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pipeline:main]</span>
<span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">proxy-logging cache authtoken s3api s3token keystoneauth bulk slo proxy-logging proxy-server</span>
</pre></div>
</div>
<p>Finally, add the s3api middleware section:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[filter:s3api]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#s3api</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">keystonemiddleware.authtoken</span></code> can be located before/after s3api but
we recommend to put it before s3api because when authtoken is after s3api,
both authtoken and s3token will issue the acceptable token to keystone
(i.e. authenticate twice). And in the <code class="docutils literal notranslate"><span class="pre">keystonemiddleware.authtoken</span></code>
middleware , you should set <code class="docutils literal notranslate"><span class="pre">delay_auth_decision</span></code> option to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
</section>
</section>
<section id="constraints">
<h3>Constraints<a class="headerlink" href="#constraints" title="Permalink to this heading">¶</a></h3>
<p>Currently, the s3api is being ported from <a class="reference external" href="https://github.com/openstack/swift3">https://github.com/openstack/swift3</a>
so any existing issues in swift3 are still remaining. Please make sure
descriptions in the example <code class="docutils literal notranslate"><span class="pre">proxy-server.conf</span></code> and what happens with the
config, before enabling the options.</p>
</section>
<section id="supported-api">
<h3>Supported API<a class="headerlink" href="#supported-api" title="Permalink to this heading">¶</a></h3>
<p>The compatibility will continue to be improved upstream, you can keep and
eye on compatibility via a check tool build by SwiftStack. See
<a class="reference external" href="https://github.com/swiftstack/s3compat">https://github.com/swiftstack/s3compat</a> in detail.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3api.S3ApiMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3api.</span></span><span class="sig-name descname"><span class="pre">S3ApiMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wsgi_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3api.S3ApiMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>S3Api: S3 compatibility middleware</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3api.S3ApiMiddleware.check_filter_order">
<span class="sig-name descname"><span class="pre">check_filter_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required_filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3api.S3ApiMiddleware.check_filter_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that required filters are present in order in the pipeline.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3api.S3ApiMiddleware.check_pipeline">
<span class="sig-name descname"><span class="pre">check_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wsgi_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3api.S3ApiMiddleware.check_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that proxy-server.conf has an appropriate pipeline for s3api.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3api.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3api.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3api.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Standard filter factory to use the middleware with paste.deploy</p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.s3token"></span><section id="s3-token-middleware">
<h3>S3 Token Middleware<a class="headerlink" href="#s3-token-middleware" title="Permalink to this heading">¶</a></h3>
<p>s3token middleware is for authentication with s3api + keystone.
This middleware:</p>
<ul class="simple">
<li><p>Gets a request from the s3api middleware with an S3 Authorization
access key.</p></li>
<li><p>Validates s3 token with Keystone.</p></li>
<li><p>Transforms the account name to AUTH_%(tenant_name).</p></li>
<li><p>Optionally can retrieve and cache secret from keystone
to validate signature locally</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If upgrading from swift3, the <code class="docutils literal notranslate"><span class="pre">auth_version</span></code> config option has been
removed, and the <code class="docutils literal notranslate"><span class="pre">auth_uri</span></code> option now includes the Keystone API
version. If you previously had a configuration like</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[filter:s3token]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift3</span><span class="c1">#s3token</span>
<span class="na">auth_uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">https://keystonehost:35357</span>
<span class="na">auth_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">3</span>
</pre></div>
</div>
<p>you should now use</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[filter:s3token]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:swift</span><span class="c1">#s3token</span>
<span class="na">auth_uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">https://keystonehost:35357/v3</span>
</pre></div>
</div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3token.S3Token">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3token.</span></span><span class="sig-name descname"><span class="pre">S3Token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3token.S3Token" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Middleware that handles S3 authentication.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3token.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3token.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3token.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a WSGI filter app for use with paste.deploy.</p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.s3request"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.HashingInput">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3request.</span></span><span class="sig-name descname"><span class="pre">HashingInput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hasher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_hex_hash</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.HashingInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>wsgi.input wrapper to verify the hash of the input as it’s read.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3AclRequest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3request.</span></span><span class="sig-name descname"><span class="pre">S3AclRequest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3AclRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request" title="swift.common.middleware.s3api.s3request.S3Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">S3Request</span></code></a></p>
<p>S3Acl request object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3AclRequest.authenticate">
<span class="sig-name descname"><span class="pre">authenticate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3AclRequest.authenticate" title="Permalink to this definition">¶</a></dt>
<dd><p>authenticate method will run pre-authenticate request and retrieve
account information.
Note that it currently supports only keystone and tempauth.
(no support for the third party authentication middleware)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3AclRequest.get_acl_response">
<span class="sig-name descname"><span class="pre">get_acl_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3AclRequest.get_acl_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper method of _get_response to add s3 acl information
from response sysmeta headers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3AclRequest.get_response">
<span class="sig-name descname"><span class="pre">get_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3AclRequest.get_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap up get_response call to hook with acl handling method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3AclRequest.to_swift_req">
<span class="sig-name descname"><span class="pre">to_swift_req</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3AclRequest.to_swift_req" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Swift request based on this request’s environment.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3Request">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3request.</span></span><span class="sig-name descname"><span class="pre">S3Request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3Request" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a></p>
<p>S3 request object.</p>
<dl class="py property">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3Request.body">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">body</span></span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3Request.body" title="Permalink to this definition">¶</a></dt>
<dd><p>swob.Request.body is not secure against malicious input.  It consumes
too much memory without any check when the request body is excessively
large.  Use xml() instead.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3Request.bucket_acl">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bucket_acl</span></span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3Request.bucket_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the container acl property</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3Request.check_copy_source">
<span class="sig-name descname"><span class="pre">check_copy_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3Request.check_copy_source" title="Permalink to this definition">¶</a></dt>
<dd><p>check_copy_source checks the copy source existence and if copying an
object to itself, for illegal request parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the source HEAD response</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3Request.get_container_info">
<span class="sig-name descname"><span class="pre">get_container_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3Request.get_container_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get_container_info will return a result dict of get_container_info
from the backend Swift.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dictionary of container info from
swift.controllers.base.get_container_info</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p>NoSuchBucket when the container doesn’t exist</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p>InternalError when the request failed without 404</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3Request.get_response">
<span class="sig-name descname"><span class="pre">get_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3Request.get_response" title="Permalink to this definition">¶</a></dt>
<dd><p>get_response is an entry point to be extended for child classes.
If additional tasks needed at that time of getting swift response,
we can override this method.
swift.common.middleware.s3api.s3request.S3Request need to just call
_get_response to get pure swift response.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3Request.object_acl">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">object_acl</span></span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3Request.object_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the object acl property</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3Request.timestamp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">timestamp</span></span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3Request.timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>S3Timestamp from Date header. If X-Amz-Date header specified, it
will be prior to Date header.</p>
<p>:return : S3Timestamp instance</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3Request.to_swift_req">
<span class="sig-name descname"><span class="pre">to_swift_req</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3Request.to_swift_req" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Swift request based on this request’s environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.S3Request.xml">
<span class="sig-name descname"><span class="pre">xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.S3Request.xml" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to swob.Request.body, but it checks the content length before
creating a body string.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.SigV4Mixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3request.</span></span><span class="sig-name descname"><span class="pre">SigV4Mixin</span></span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.SigV4Mixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A request class mixin to provide S3 signature v4 functionality</p>
<dl class="py property">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.SigV4Mixin.timestamp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">timestamp</span></span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.SigV4Mixin.timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return timestamp string according to the auth type
The difference from v2 is v4 have to see ‘X-Amz-Date’ even though
it’s query auth type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.SigV4Request">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3request.</span></span><span class="sig-name descname"><span class="pre">SigV4Request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.SigV4Request" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3request.SigV4Mixin" title="swift.common.middleware.s3api.s3request.SigV4Mixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigV4Mixin</span></code></a>, <a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request" title="swift.common.middleware.s3api.s3request.S3Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">S3Request</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.SigV4S3AclRequest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3request.</span></span><span class="sig-name descname"><span class="pre">SigV4S3AclRequest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.SigV4S3AclRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3request.SigV4Mixin" title="swift.common.middleware.s3api.s3request.SigV4Mixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigV4Mixin</span></code></a>, <a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3AclRequest" title="swift.common.middleware.s3api.s3request.S3AclRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">S3AclRequest</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3request.get_request_class">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3request.</span></span><span class="sig-name descname"><span class="pre">get_request_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s3_acl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3request.get_request_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to find a request class to use from Map</p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.s3response"></span><dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.AccessDenied">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">AccessDenied</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.AccessDenied" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.AccountProblem">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">AccountProblem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.AccountProblem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.AmbiguousGrantByEmailAddress">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">AmbiguousGrantByEmailAddress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.AmbiguousGrantByEmailAddress" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.AuthorizationHeaderMalformed">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">AuthorizationHeaderMalformed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.AuthorizationHeaderMalformed" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.AuthorizationQueryParametersError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">AuthorizationQueryParametersError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.AuthorizationQueryParametersError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.BadDigest">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">BadDigest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.BadDigest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.BrokenMPU">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">BrokenMPU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.BrokenMPU" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.BucketAlreadyExists">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">BucketAlreadyExists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.BucketAlreadyExists" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.BucketAlreadyOwnedByYou">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">BucketAlreadyOwnedByYou</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.BucketAlreadyOwnedByYou" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.BucketNotEmpty">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">BucketNotEmpty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.BucketNotEmpty" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.CredentialsNotSupported">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">CredentialsNotSupported</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.CredentialsNotSupported" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.CrossLocationLoggingProhibited">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">CrossLocationLoggingProhibited</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.CrossLocationLoggingProhibited" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.EntityTooLarge">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">EntityTooLarge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.EntityTooLarge" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.EntityTooSmall">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">EntityTooSmall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.EntityTooSmall" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.ErrorResponse">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">ErrorResponse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.S3ResponseBase" title="swift.common.middleware.s3api.s3response.S3ResponseBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">S3ResponseBase</span></code></a>, <a class="reference internal" href="misc.html#swift.common.swob.HTTPException" title="swift.common.swob.HTTPException"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTPException</span></code></a></p>
<p>S3 error object.</p>
<p>Reference information about S3 errors is available at:
<a class="reference external" href="http://docs.aws.amazon.com/AmazonS3/latest/API/ErrorResponses.html">http://docs.aws.amazon.com/AmazonS3/latest/API/ErrorResponses.html</a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.ExpiredToken">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">ExpiredToken</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.ExpiredToken" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.HeaderKeyDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">HeaderKeyDict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.HeaderKeyDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">HeaderKeyDict</span></code></p>
<p>Similar to the Swift’s normal HeaderKeyDict class, but its key name is
normalized as S3 clients expect.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.IllegalVersioningConfigurationException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">IllegalVersioningConfigurationException</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.IllegalVersioningConfigurationException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.IncompleteBody">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">IncompleteBody</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.IncompleteBody" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.IncorrectNumberOfFilesInPostRequest">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">IncorrectNumberOfFilesInPostRequest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.IncorrectNumberOfFilesInPostRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InlineDataTooLarge">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InlineDataTooLarge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InlineDataTooLarge" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InternalError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InternalError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InternalError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidAccessKeyId">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidAccessKeyId</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidAccessKeyId" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidArgument">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidArgument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidArgument" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidBucketName">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidBucketName</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidBucketName" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidBucketState">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidBucketState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidBucketState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidDigest">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidDigest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidDigest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidLocationConstraint">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidLocationConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidLocationConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidObjectState">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidObjectState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidObjectState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidPart">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidPart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidPart" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidPartOrder">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidPartOrder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidPartOrder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidPayer">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidPayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidPayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidPolicyDocument">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidPolicyDocument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidPolicyDocument" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidRange">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidRange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidRange" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidRequest">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidRequest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidSOAPRequest">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidSOAPRequest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidSOAPRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidSecurity">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidSecurity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidSecurity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidStorageClass">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidStorageClass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidStorageClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidTargetBucketForLogging">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidTargetBucketForLogging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidTargetBucketForLogging" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidToken">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidToken</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidToken" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.InvalidURI">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">InvalidURI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.InvalidURI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.KeyTooLongError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">KeyTooLongError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.KeyTooLongError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MalformedACLError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MalformedACLError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MalformedACLError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MalformedPOSTRequest">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MalformedPOSTRequest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MalformedPOSTRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MalformedXML">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MalformedXML</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MalformedXML" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MaxMessageLengthExceeded">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MaxMessageLengthExceeded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MaxMessageLengthExceeded" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MaxPostPreDataLengthExceededError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MaxPostPreDataLengthExceededError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MaxPostPreDataLengthExceededError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MetadataTooLarge">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MetadataTooLarge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MetadataTooLarge" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MethodNotAllowed">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MethodNotAllowed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MethodNotAllowed" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MissingContentLength">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MissingContentLength</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MissingContentLength" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MissingRequestBodyError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MissingRequestBodyError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MissingRequestBodyError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MissingSecurityElement">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MissingSecurityElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MissingSecurityElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.MissingSecurityHeader">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">MissingSecurityHeader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.MissingSecurityHeader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.NoLoggingStatusForKey">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">NoLoggingStatusForKey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.NoLoggingStatusForKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.NoSuchBucket">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">NoSuchBucket</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.NoSuchBucket" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.NoSuchKey">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">NoSuchKey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.NoSuchKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.NoSuchLifecycleConfiguration">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">NoSuchLifecycleConfiguration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.NoSuchLifecycleConfiguration" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.NoSuchUpload">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">NoSuchUpload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.NoSuchUpload" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.NoSuchVersion">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">NoSuchVersion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.NoSuchVersion" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.NotSignedUp">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">NotSignedUp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.NotSignedUp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.NotSuchBucketPolicy">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">NotSuchBucketPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.NotSuchBucketPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.OperationAborted">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">OperationAborted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.OperationAborted" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.PermanentRedirect">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">PermanentRedirect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.PermanentRedirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.PreconditionFailed">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">PreconditionFailed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.PreconditionFailed" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.Redirect">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">Redirect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.Redirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.RequestIsNotMultiPartContent">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">RequestIsNotMultiPartContent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.RequestIsNotMultiPartContent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.RequestTimeTooSkewed">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">RequestTimeTooSkewed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.RequestTimeTooSkewed" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.RequestTimeout">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">RequestTimeout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.RequestTimeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.RequestTorrentOfBucketError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">RequestTorrentOfBucketError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.RequestTorrentOfBucketError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.RestoreAlreadyInProgress">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">RestoreAlreadyInProgress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.RestoreAlreadyInProgress" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.S3NotImplemented">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">S3NotImplemented</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.S3NotImplemented" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.S3Response">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">S3Response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.S3Response" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.S3ResponseBase" title="swift.common.middleware.s3api.s3response.S3ResponseBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">S3ResponseBase</span></code></a>, <a class="reference internal" href="misc.html#swift.common.swob.Response" title="swift.common.swob.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a></p>
<p>Similar to the Response class in Swift, but uses our HeaderKeyDict for
headers instead of Swift’s HeaderKeyDict.  This also translates Swift
specific headers to S3 headers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.S3Response.from_swift_resp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_swift_resp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sw_resp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.S3Response.from_swift_resp" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new S3 response object based on the given Swift response.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.S3ResponseBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">S3ResponseBase</span></span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.S3ResponseBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for swift3 responses.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.ServiceUnavailable">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">ServiceUnavailable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.ServiceUnavailable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.SignatureDoesNotMatch">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">SignatureDoesNotMatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.SignatureDoesNotMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.SlowDown">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">SlowDown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.SlowDown" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.TemporaryRedirect">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">TemporaryRedirect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.TemporaryRedirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.TokenRefreshRequired">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">TokenRefreshRequired</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.TokenRefreshRequired" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.TooManyBuckets">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">TooManyBuckets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.TooManyBuckets" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.UnexpectedContent">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">UnexpectedContent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.UnexpectedContent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.UnresolvableGrantByEmailAddress">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">UnresolvableGrantByEmailAddress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.UnresolvableGrantByEmailAddress" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.UserKeyMustBeSpecified">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">UserKeyMustBeSpecified</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.UserKeyMustBeSpecified" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse" title="swift.common.middleware.s3api.s3response.ErrorResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.s3response.VersionedBucketNotEmpty">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.s3response.</span></span><span class="sig-name descname"><span class="pre">VersionedBucketNotEmpty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.s3response.VersionedBucketNotEmpty" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.s3response.BucketNotEmpty" title="swift.common.middleware.s3api.s3response.BucketNotEmpty"><code class="xref py py-class docutils literal notranslate"><span class="pre">BucketNotEmpty</span></code></a></p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.exception"></span><dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.exception.ACLError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.exception.</span></span><span class="sig-name descname"><span class="pre">ACLError</span></span><a class="headerlink" href="#swift.common.middleware.s3api.exception.ACLError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.exception.S3Exception" title="swift.common.middleware.s3api.exception.S3Exception"><code class="xref py py-class docutils literal notranslate"><span class="pre">S3Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.exception.InvalidSubresource">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.exception.</span></span><span class="sig-name descname"><span class="pre">InvalidSubresource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cause</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.exception.InvalidSubresource" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.exception.S3Exception" title="swift.common.middleware.s3api.exception.S3Exception"><code class="xref py py-class docutils literal notranslate"><span class="pre">S3Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.exception.NotS3Request">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.exception.</span></span><span class="sig-name descname"><span class="pre">NotS3Request</span></span><a class="headerlink" href="#swift.common.middleware.s3api.exception.NotS3Request" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.exception.S3Exception" title="swift.common.middleware.s3api.exception.S3Exception"><code class="xref py py-class docutils literal notranslate"><span class="pre">S3Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.exception.S3Exception">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.exception.</span></span><span class="sig-name descname"><span class="pre">S3Exception</span></span><a class="headerlink" href="#swift.common.middleware.s3api.exception.S3Exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.etree"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.etree._Element">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.etree.</span></span><span class="sig-name descname"><span class="pre">_Element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.etree._Element" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ElementBase</span></code></p>
<p>Wrapper Element class of lxml.etree.Element to support
a utf-8 encoded non-ascii string as a text.</p>
<p>Why we need this?:
Original lxml.etree.Element supports only unicode for the text.
It declines maintainability because we have to call a lot of encode/decode
methods to apply account/container/object name (i.e. PATH_INFO) to each
Element instance. When using this class, we can remove such a redundant
codes from swift.common.middleware.s3api middleware.</p>
<dl class="py property">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.etree._Element.text">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">text</span></span><a class="headerlink" href="#swift.common.middleware.s3api.etree._Element.text" title="Permalink to this definition">¶</a></dt>
<dd><p>utf-8 wrapper property of lxml.etree.Element.text</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.utils"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.utils.Config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.utils.</span></span><span class="sig-name descname"><span class="pre">Config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.utils.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.utils.Config.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <span class="optional">]</span><em class="sig-param"><span class="n"><span class="pre">**F</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None.</span>&#160; <span class="pre">Update</span> <span class="pre">D</span> <span class="pre">from</span> <span class="pre">dict/iterable</span> <span class="pre">E</span> <span class="pre">and</span> <span class="pre">F.</span></span></span><a class="headerlink" href="#swift.common.middleware.s3api.utils.Config.update" title="Permalink to this definition">¶</a></dt>
<dd><p>If E is present and has a .keys() method, then does:  for k in E: D[k] = E[k]
If E is present and lacks a .keys() method, then does:  for k, v in E: D[k] = v
In either case, this is followed by: for k in F:  D[k] = F[k]</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.utils.S3Timestamp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.utils.</span></span><span class="sig-name descname"><span class="pre">S3Timestamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.utils.S3Timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.utils.Timestamp" title="swift.common.utils.Timestamp"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.utils.S3Timestamp.amz_date_format">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">amz_date_format</span></span><a class="headerlink" href="#swift.common.middleware.s3api.utils.S3Timestamp.amz_date_format" title="Permalink to this definition">¶</a></dt>
<dd><p>this format should be like ‘YYYYMMDDThhmmssZ’</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.utils.mktime">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.utils.</span></span><span class="sig-name descname"><span class="pre">mktime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamp_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%Y-%m-%dT%H:%M:%S'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.utils.mktime" title="Permalink to this definition">¶</a></dt>
<dd><p>mktime creates a float instance in epoch time really like as time.mktime</p>
<p>the difference from time.mktime is allowing to 2 formats string for the
argument for the S3 testing usage.
TODO: support</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timestamp_str</strong> – a string of timestamp formatted as
(a) RFC2822 (e.g. date header)
(b) %Y-%m-%dT%H:%M:%S (e.g. copy result)</p></li>
<li><p><strong>time_format</strong> – a string of format to parse in (b) process</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a float instance in epoch time</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.utils.sysmeta_header">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.utils.</span></span><span class="sig-name descname"><span class="pre">sysmeta_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.utils.sysmeta_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the system metadata header for given resource type and name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.utils.sysmeta_prefix">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.utils.</span></span><span class="sig-name descname"><span class="pre">sysmeta_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.utils.sysmeta_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the system metadata prefix for given resource type.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.utils.validate_bucket_name">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.utils.</span></span><span class="sig-name descname"><span class="pre">validate_bucket_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dns_compliant_bucket_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.utils.validate_bucket_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates the name of the bucket against S3 criteria,
<a class="reference external" href="http://docs.amazonwebservices.com/AmazonS3/latest/BucketRestrictions.html">http://docs.amazonwebservices.com/AmazonS3/latest/BucketRestrictions.html</a>
True is valid, False is invalid.</p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.subresource"></span><section id="s3api-s-acls-implementation">
<h3>s3api’s ACLs implementation<a class="headerlink" href="#s3api-s-acls-implementation" title="Permalink to this heading">¶</a></h3>
<p>s3api uses a different implementation approach to achieve S3 ACLs.</p>
<p>First, we should understand what we have to design to achieve real S3 ACLs.
Current s3api(real S3)’s ACLs Model is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AccessControlPolicy</span><span class="p">:</span>
    <span class="n">Owner</span><span class="p">:</span>
    <span class="n">AccessControlList</span><span class="p">:</span>
        <span class="n">Grant</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
            <span class="p">(</span><span class="n">Grantee</span><span class="p">,</span> <span class="n">Permission</span><span class="p">)</span>
</pre></div>
</div>
<p>Each bucket or object has its own acl consisting of Owner and
AcessControlList. AccessControlList can contain some Grants.
By default, AccessControlList has only one Grant to allow FULL
CONTROLL to owner. Each Grant includes single pair with Grantee,
Permission. Grantee is the user (or user group) allowed the given permission.</p>
<p>This module defines the groups and the relation tree.</p>
<p>If you wanna get more information about S3’s ACLs model in detail,
please see official documentation here,</p>
<p><a class="reference external" href="http://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html">http://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html</a></p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.ACL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">ACL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s3_acl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_no_owner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.ACL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>S3 ACL class.</p>
<dl class="simple">
<dt>Refs (S3 API - acl-overview:</dt><dd><p><a class="reference external" href="http://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html">http://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html</a>):</p>
</dd>
</dl>
<p>The sample ACL includes an Owner element identifying the owner via the
AWS account’s canonical user ID. The Grant element identifies the grantee
(either an AWS account or a predefined group), and the permission granted.
This default ACL has one Grant element for the owner. You grant permissions
by adding Grant elements, each grant identifying the grantee and the
permission.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.ACL.check_owner">
<span class="sig-name descname"><span class="pre">check_owner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.ACL.check_owner" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the user is an owner.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.ACL.check_permission">
<span class="sig-name descname"><span class="pre">check_permission</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permission</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.ACL.check_permission" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the user has a permission.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.ACL.elem">
<span class="sig-name descname"><span class="pre">elem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.ACL.elem" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode the value to an ACL instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.ACL.from_elem">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_elem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s3_acl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_no_owner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.ACL.from_elem" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an ElementTree to an ACL instance</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.ACL.from_headers">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket_owner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_owner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_private</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.ACL.from_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert HTTP headers to an ACL instance.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.AllUsers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">AllUsers</span></span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.AllUsers" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.subresource.Group" title="swift.common.middleware.s3api.subresource.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code></a></p>
<p>Access permission to this group allows anyone to access the resource.  The
requests can be signed (authenticated) or unsigned (anonymous).  Unsigned
requests omit the Authentication header in the request.</p>
<p>Note: s3api regards unsigned requests as Swift API accesses, and bypasses
them to Swift.  As a result, AllUsers behaves completely same as
AuthenticatedUsers.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.AuthenticatedUsers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">AuthenticatedUsers</span></span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.AuthenticatedUsers" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.subresource.Group" title="swift.common.middleware.s3api.subresource.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code></a></p>
<p>This group represents all AWS accounts.  Access permission to this group
allows any AWS account to access the resource.  However, all requests must
be signed (authenticated).</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.CannedACL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">CannedACL</span></span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.CannedACL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A dict-like object that returns canned ACL.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.Grant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">Grant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grantee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permission</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.Grant" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Grant Class which includes both Grantee and Permission</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.Grant.elem">
<span class="sig-name descname"><span class="pre">elem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.Grant.elem" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an etree element.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.Grant.from_elem">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_elem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.Grant.from_elem" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an ElementTree to an ACL instance</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.Grantee">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">Grantee</span></span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.Grantee" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for grantee.</p>
<p>Methods:</p>
<ul class="simple">
<li><p>init: create a Grantee instance</p></li>
<li><p>elem: create an ElementTree from itself</p></li>
</ul>
<p>Static Methods:</p>
<ul class="simple">
<li><dl class="simple">
<dt>from_header: convert a grantee string in the HTTP header</dt><dd><p>to an Grantee instance.</p>
</dd>
</dl>
</li>
<li><p>from_elem: convert a ElementTree to an Grantee instance.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.Grantee.elem">
<span class="sig-name descname"><span class="pre">elem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.Grantee.elem" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an etree element of this instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.Grantee.from_header">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grantee</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.Grantee.from_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a grantee string in the HTTP header to an Grantee instance.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.Group">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">Group</span></span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.Group" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.subresource.Grantee" title="swift.common.middleware.s3api.subresource.Grantee"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grantee</span></code></a></p>
<p>Base class for Amazon S3 Predefined Groups</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.Group.elem">
<span class="sig-name descname"><span class="pre">elem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.Group.elem" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an etree element of this instance.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.LogDelivery">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">LogDelivery</span></span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.LogDelivery" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.subresource.Group" title="swift.common.middleware.s3api.subresource.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code></a></p>
<p>WRITE and READ_ACP permissions on a bucket enables this group to write
server access logs to the bucket.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.Owner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">Owner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.Owner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Owner class for S3 accounts</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.User">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">User</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.User" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.subresource.Grantee" title="swift.common.middleware.s3api.subresource.Grantee"><code class="xref py py-class docutils literal notranslate"><span class="pre">Grantee</span></code></a></p>
<p>Canonical user class for S3 accounts.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.User.elem">
<span class="sig-name descname"><span class="pre">elem</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.User.elem" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an etree element of this instance.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.canned_acl_grantees">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">canned_acl_grantees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bucket_owner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_owner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.canned_acl_grantees" title="Permalink to this definition">¶</a></dt>
<dd><p>A set of predefined grants supported by AWS S3.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.decode_acl">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">decode_acl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_no_owner</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.decode_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode Swift metadata to an ACL instance.</p>
<p>Given a resource type and HTTP headers, this method returns an ACL
instance.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.encode_acl">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">encode_acl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.encode_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode an ACL instance to Swift metadata.</p>
<p>Given a resource type and an ACL instance, this method returns HTTP
headers, which can be used for Swift metadata.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.subresource.get_group_subclass_from_uri">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.subresource.</span></span><span class="sig-name descname"><span class="pre">get_group_subclass_from_uri</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uri</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.subresource.get_group_subclass_from_uri" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a URI to one of the predefined groups.</p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.acl_handlers"></span><section id="acl-handlers">
<h3>Acl Handlers<a class="headerlink" href="#acl-handlers" title="Permalink to this heading">¶</a></h3>
<section id="why-do-we-need-this">
<h4>Why do we need this<a class="headerlink" href="#why-do-we-need-this" title="Permalink to this heading">¶</a></h4>
<p>To make controller classes clean, we need these handlers.
It is really useful for customizing acl checking algorithms for
each controller.</p>
</section>
<section id="basic-information">
<h4>Basic Information<a class="headerlink" href="#basic-information" title="Permalink to this heading">¶</a></h4>
<p>BaseAclHandler wraps basic Acl handling.
(i.e. it will check acl from ACL_MAP by using HEAD)</p>
</section>
<section id="how-to-extend">
<h4>How to extend<a class="headerlink" href="#how-to-extend" title="Permalink to this heading">¶</a></h4>
<p>Make a handler with the name of the controller.
(e.g. BucketAclHandler is for BucketController)
It consists of method(s) for actual S3 method on controllers as follows.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BucketAclHandler</span><span class="p">(</span><span class="n">BaseAclHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">PUT</span><span class="p">:</span>
        <span class="o">&lt;&lt;</span> <span class="n">put</span> <span class="n">acl</span> <span class="n">handling</span> <span class="n">algorithms</span> <span class="n">here</span> <span class="k">for</span> <span class="n">PUT</span> <span class="n">bucket</span> <span class="o">&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the method DON’T need to recall _get_response in outside of
acl checking, the method have to return the response it needs at
the end of method.</p>
</div>
</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_handlers.BaseAclHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_handlers.</span></span><span class="sig-name descname"><span class="pre">BaseAclHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_handlers.BaseAclHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>BaseAclHandler: Handling ACL for basic requests mapped on ACL_MAP</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_handlers.BaseAclHandler.get_acl">
<span class="sig-name descname"><span class="pre">get_acl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket_owner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_owner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_handlers.BaseAclHandler.get_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Get ACL instance from S3 (e.g. x-amz-grant) headers or S3 acl xml body.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_handlers.BucketAclHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_handlers.</span></span><span class="sig-name descname"><span class="pre">BucketAclHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_handlers.BucketAclHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.BaseAclHandler" title="swift.common.middleware.s3api.acl_handlers.BaseAclHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAclHandler</span></code></a></p>
<p>BucketAclHandler: Handler for BucketController</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_handlers.MultiObjectDeleteAclHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_handlers.</span></span><span class="sig-name descname"><span class="pre">MultiObjectDeleteAclHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_handlers.MultiObjectDeleteAclHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.BaseAclHandler" title="swift.common.middleware.s3api.acl_handlers.BaseAclHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAclHandler</span></code></a></p>
<p>MultiObjectDeleteAclHandler: Handler for MultiObjectDeleteController</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_handlers.MultiUploadAclHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_handlers.</span></span><span class="sig-name descname"><span class="pre">MultiUploadAclHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_handlers.MultiUploadAclHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.BaseAclHandler" title="swift.common.middleware.s3api.acl_handlers.BaseAclHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAclHandler</span></code></a></p>
<p>MultiUpload stuff requires acl checking just once for BASE container
so that MultiUploadAclHandler extends BaseAclHandler to check acl only
when the verb defined. We should define the verb as the first step to
request to backend Swift at incoming request.</p>
<dl class="simple">
<dt>Basic Rules:</dt><dd><ul class="simple">
<li><p>BASE container name is always w/o ‘MULTIUPLOAD_SUFFIX’</p></li>
<li><p>Any check timing is ok but we should check it as soon as possible.</p></li>
</ul>
</dd>
</dl>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Controller</p></th>
<th class="head"><p>Verb</p></th>
<th class="head"><p>CheckResource</p></th>
<th class="head"><p>Permission</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Part</p></td>
<td><p>PUT</p></td>
<td><p>Container</p></td>
<td><p>WRITE</p></td>
</tr>
<tr class="row-odd"><td><p>Uploads</p></td>
<td><p>GET</p></td>
<td><p>Container</p></td>
<td><p>READ</p></td>
</tr>
<tr class="row-even"><td><p>Uploads</p></td>
<td><p>POST</p></td>
<td><p>Container</p></td>
<td><p>WRITE</p></td>
</tr>
<tr class="row-odd"><td><p>Upload</p></td>
<td><p>GET</p></td>
<td><p>Container</p></td>
<td><p>READ</p></td>
</tr>
<tr class="row-even"><td><p>Upload</p></td>
<td><p>DELETE</p></td>
<td><p>Container</p></td>
<td><p>WRITE</p></td>
</tr>
<tr class="row-odd"><td><p>Upload</p></td>
<td><p>POST</p></td>
<td><p>Container</p></td>
<td><p>WRITE</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_handlers.ObjectAclHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_handlers.</span></span><span class="sig-name descname"><span class="pre">ObjectAclHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_handlers.ObjectAclHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.BaseAclHandler" title="swift.common.middleware.s3api.acl_handlers.BaseAclHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAclHandler</span></code></a></p>
<p>ObjectAclHandler: Handler for ObjectController</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_handlers.PartAclHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_handlers.</span></span><span class="sig-name descname"><span class="pre">PartAclHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_handlers.PartAclHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.MultiUploadAclHandler" title="swift.common.middleware.s3api.acl_handlers.MultiUploadAclHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiUploadAclHandler</span></code></a></p>
<p>PartAclHandler: Handler for PartController</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_handlers.S3AclHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_handlers.</span></span><span class="sig-name descname"><span class="pre">S3AclHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_handlers.S3AclHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.BaseAclHandler" title="swift.common.middleware.s3api.acl_handlers.BaseAclHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAclHandler</span></code></a></p>
<p>S3AclHandler: Handler for S3AclController</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_handlers.UploadAclHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_handlers.</span></span><span class="sig-name descname"><span class="pre">UploadAclHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_handlers.UploadAclHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.MultiUploadAclHandler" title="swift.common.middleware.s3api.acl_handlers.MultiUploadAclHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiUploadAclHandler</span></code></a></p>
<p>UploadAclHandler: Handler for UploadController</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_handlers.UploadsAclHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_handlers.</span></span><span class="sig-name descname"><span class="pre">UploadsAclHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_handlers.UploadsAclHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.MultiUploadAclHandler" title="swift.common.middleware.s3api.acl_handlers.MultiUploadAclHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiUploadAclHandler</span></code></a></p>
<p>UploadsAclHandler: Handler for UploadsController</p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.acl_utils"></span><dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_utils.handle_acl_header">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_utils.</span></span><span class="sig-name descname"><span class="pre">handle_acl_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_utils.handle_acl_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle the x-amz-acl header.
Note that this header currently used for only normal-acl
(not implemented) on s3acl.
TODO: add translation to swift acl like as x-container-read to s3acl</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.acl_utils.swift_acl_translate">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.acl_utils.</span></span><span class="sig-name descname"><span class="pre">swift_acl_translate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.acl_utils.swift_acl_translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an S3 style ACL and returns a list of header/value pairs that
implement that ACL in Swift, or “NotImplemented” if there isn’t a way to do
that yet.</p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.base"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.base.Controller">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.base.</span></span><span class="sig-name descname"><span class="pre">Controller</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.base.Controller" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base WSGI controller class for the middleware</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.base.Controller.resource_type">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">resource_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.base.Controller.resource_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the target resource type of this controller.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.base.UnsupportedController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.base.</span></span><span class="sig-name descname"><span class="pre">UnsupportedController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.base.UnsupportedController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles unsupported requests.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.base.bucket_operation">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.base.</span></span><span class="sig-name descname"><span class="pre">bucket_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_resp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.base.bucket_operation" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator to ensure that the request is a bucket operation.  If the
target resource is an object, this decorator updates the request by default
so that the controller handles it as a bucket operation.  If ‘err_resp’ is
specified, this raises it on error instead.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.base.check_container_existence">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.base.</span></span><span class="sig-name descname"><span class="pre">check_container_existence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.base.check_container_existence" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator to ensure the container existence.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.base.object_operation">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.base.</span></span><span class="sig-name descname"><span class="pre">object_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.base.object_operation" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator to ensure that the request is an object operation.  If the
target resource is not an object, this raises an error response.</p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.service"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.service.ServiceController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.service.</span></span><span class="sig-name descname"><span class="pre">ServiceController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.service.ServiceController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles account level requests.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.service.ServiceController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.service.ServiceController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle GET Service request</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.bucket"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.bucket.BucketController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.bucket.</span></span><span class="sig-name descname"><span class="pre">BucketController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.bucket.BucketController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles bucket request.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.bucket.BucketController.DELETE">
<span class="sig-name descname"><span class="pre">DELETE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.bucket.BucketController.DELETE" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle DELETE Bucket request</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.bucket.BucketController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.bucket.BucketController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle GET Bucket (List Objects) request</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.bucket.BucketController.HEAD">
<span class="sig-name descname"><span class="pre">HEAD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.bucket.BucketController.HEAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HEAD Bucket (Get Metadata) request</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.bucket.BucketController.POST">
<span class="sig-name descname"><span class="pre">POST</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.bucket.BucketController.POST" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle POST Bucket request</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.bucket.BucketController.PUT">
<span class="sig-name descname"><span class="pre">PUT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.bucket.BucketController.PUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle PUT Bucket request</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.obj"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.obj.ObjectController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.obj.</span></span><span class="sig-name descname"><span class="pre">ObjectController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.obj.ObjectController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles requests on objects</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.obj.ObjectController.DELETE">
<span class="sig-name descname"><span class="pre">DELETE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.obj.ObjectController.DELETE" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle DELETE Object request</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.obj.ObjectController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.obj.ObjectController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle GET Object request</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.obj.ObjectController.HEAD">
<span class="sig-name descname"><span class="pre">HEAD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.obj.ObjectController.HEAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HEAD Object request</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.obj.ObjectController.PUT">
<span class="sig-name descname"><span class="pre">PUT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.obj.ObjectController.PUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle PUT Object and PUT Object (Copy) request</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.acl"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.acl.AclController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.acl.</span></span><span class="sig-name descname"><span class="pre">AclController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.acl.AclController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles the following APIs:</p>
<ul class="simple">
<li><p>GET Bucket acl</p></li>
<li><p>PUT Bucket acl</p></li>
<li><p>GET Object acl</p></li>
<li><p>PUT Object acl</p></li>
</ul>
<p>Those APIs are logged as ACL operations in the S3 server log.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.acl.AclController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.acl.AclController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles GET Bucket acl and GET Object acl.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.acl.AclController.PUT">
<span class="sig-name descname"><span class="pre">PUT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.acl.AclController.PUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles PUT Bucket acl and PUT Object acl.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.acl.get_acl">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.acl.</span></span><span class="sig-name descname"><span class="pre">get_acl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">account_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.acl.get_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to construct an S3 ACL based on what is found in the swift headers</p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.s3_acl"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.s3_acl.S3AclController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.s3_acl.</span></span><span class="sig-name descname"><span class="pre">S3AclController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.s3_acl.S3AclController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles the following APIs:</p>
<ul class="simple">
<li><p>GET Bucket acl</p></li>
<li><p>PUT Bucket acl</p></li>
<li><p>GET Object acl</p></li>
<li><p>PUT Object acl</p></li>
</ul>
<p>Those APIs are logged as ACL operations in the S3 server log.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.s3_acl.S3AclController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.s3_acl.S3AclController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles GET Bucket acl and GET Object acl.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.s3_acl.S3AclController.PUT">
<span class="sig-name descname"><span class="pre">PUT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.s3_acl.S3AclController.PUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles PUT Bucket acl and PUT Object acl.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.multi_upload"></span><p>Implementation of S3 Multipart Upload.</p>
<p>This module implements S3 Multipart Upload APIs with the Swift SLO feature.
The following explains how S3api uses swift container and objects to store S3
upload information:</p>
<section id="bucket-segments">
<h3>[bucket]+segments<a class="headerlink" href="#bucket-segments" title="Permalink to this heading">¶</a></h3>
<p>A container to store upload information. [bucket] is the original bucket
where multipart upload is initiated.</p>
</section>
<section id="bucket-segments-upload-id">
<h3>[bucket]+segments/[upload_id]<a class="headerlink" href="#bucket-segments-upload-id" title="Permalink to this heading">¶</a></h3>
<p>An object of the ongoing upload id. The object is empty and used for
checking the target upload status. If the object exists, it means that the
upload is initiated but not either completed or aborted.</p>
</section>
<section id="bucket-segments-upload-id-part-number">
<h3>[bucket]+segments/[upload_id]/[part_number]<a class="headerlink" href="#bucket-segments-upload-id-part-number" title="Permalink to this heading">¶</a></h3>
<p>The last suffix is the part number under the upload id. When the client uploads
the parts, they will be stored in the namespace with
[bucket]+segments/[upload_id]/[part_number].</p>
<p>Example listing result in the [bucket]+segments container:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">bucket</span><span class="p">]</span><span class="o">+</span><span class="n">segments</span><span class="o">/</span><span class="p">[</span><span class="n">upload_id1</span><span class="p">]</span>  <span class="c1"># upload id object for upload_id1</span>
<span class="p">[</span><span class="n">bucket</span><span class="p">]</span><span class="o">+</span><span class="n">segments</span><span class="o">/</span><span class="p">[</span><span class="n">upload_id1</span><span class="p">]</span><span class="o">/</span><span class="mi">1</span>  <span class="c1"># part object for upload_id1</span>
<span class="p">[</span><span class="n">bucket</span><span class="p">]</span><span class="o">+</span><span class="n">segments</span><span class="o">/</span><span class="p">[</span><span class="n">upload_id1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span>  <span class="c1"># part object for upload_id1</span>
<span class="p">[</span><span class="n">bucket</span><span class="p">]</span><span class="o">+</span><span class="n">segments</span><span class="o">/</span><span class="p">[</span><span class="n">upload_id1</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span>  <span class="c1"># part object for upload_id1</span>
<span class="p">[</span><span class="n">bucket</span><span class="p">]</span><span class="o">+</span><span class="n">segments</span><span class="o">/</span><span class="p">[</span><span class="n">upload_id2</span><span class="p">]</span>  <span class="c1"># upload id object for upload_id2</span>
<span class="p">[</span><span class="n">bucket</span><span class="p">]</span><span class="o">+</span><span class="n">segments</span><span class="o">/</span><span class="p">[</span><span class="n">upload_id2</span><span class="p">]</span><span class="o">/</span><span class="mi">1</span>  <span class="c1"># part object for upload_id2</span>
<span class="p">[</span><span class="n">bucket</span><span class="p">]</span><span class="o">+</span><span class="n">segments</span><span class="o">/</span><span class="p">[</span><span class="n">upload_id2</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span>  <span class="c1"># part object for upload_id2</span>
   <span class="o">.</span>
   <span class="o">.</span>
</pre></div>
</div>
<p>Those part objects are directly used as segments of a Swift
Static Large Object when the multipart upload is completed.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_upload.PartController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.multi_upload.</span></span><span class="sig-name descname"><span class="pre">PartController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_upload.PartController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles the following APIs:</p>
<ul class="simple">
<li><p>Upload Part</p></li>
<li><p>Upload Part - Copy</p></li>
</ul>
<p>Those APIs are logged as PART operations in the S3 server log.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_upload.PartController.PUT">
<span class="sig-name descname"><span class="pre">PUT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_upload.PartController.PUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles Upload Part and Upload Part Copy.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_upload.UploadController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.multi_upload.</span></span><span class="sig-name descname"><span class="pre">UploadController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles the following APIs:</p>
<ul class="simple">
<li><p>List Parts</p></li>
<li><p>Abort Multipart Upload</p></li>
<li><p>Complete Multipart Upload</p></li>
</ul>
<p>Those APIs are logged as UPLOAD operations in the S3 server log.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_upload.UploadController.DELETE">
<span class="sig-name descname"><span class="pre">DELETE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadController.DELETE" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles Abort Multipart Upload.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_upload.UploadController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles List Parts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_upload.UploadController.POST">
<span class="sig-name descname"><span class="pre">POST</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadController.POST" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles Complete Multipart Upload.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_upload.UploadsController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.multi_upload.</span></span><span class="sig-name descname"><span class="pre">UploadsController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadsController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles the following APIs:</p>
<ul class="simple">
<li><p>List Multipart Uploads</p></li>
<li><p>Initiate Multipart Upload</p></li>
</ul>
<p>Those APIs are logged as UPLOADS operations in the S3 server log.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_upload.UploadsController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadsController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles List Multipart Uploads</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_upload.UploadsController.POST">
<span class="sig-name descname"><span class="pre">POST</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadsController.POST" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles Initiate Multipart Upload.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.multi_delete"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_delete.MultiObjectDeleteController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.multi_delete.</span></span><span class="sig-name descname"><span class="pre">MultiObjectDeleteController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_delete.MultiObjectDeleteController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles Delete Multiple Objects, which is logged as a MULTI_OBJECT_DELETE
operation in the S3 server log.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.multi_delete.MultiObjectDeleteController.POST">
<span class="sig-name descname"><span class="pre">POST</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.multi_delete.MultiObjectDeleteController.POST" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles Delete Multiple Objects.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.versioning"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.versioning.VersioningController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.versioning.</span></span><span class="sig-name descname"><span class="pre">VersioningController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.versioning.VersioningController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles the following APIs:</p>
<ul class="simple">
<li><p>GET Bucket versioning</p></li>
<li><p>PUT Bucket versioning</p></li>
</ul>
<p>Those APIs are logged as VERSIONING operations in the S3 server log.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.versioning.VersioningController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.versioning.VersioningController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles GET Bucket versioning.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.versioning.VersioningController.PUT">
<span class="sig-name descname"><span class="pre">PUT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.versioning.VersioningController.PUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles PUT Bucket versioning.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.location"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.location.LocationController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.location.</span></span><span class="sig-name descname"><span class="pre">LocationController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.location.LocationController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles GET Bucket location, which is logged as a LOCATION operation in the
S3 server log.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.location.LocationController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.location.LocationController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles GET Bucket location.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-swift.common.middleware.s3api.controllers.logging"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.logging.LoggingStatusController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.s3api.controllers.logging.</span></span><span class="sig-name descname"><span class="pre">LoggingStatusController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.logging.LoggingStatusController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller" title="swift.common.middleware.s3api.controllers.base.Controller"><code class="xref py py-class docutils literal notranslate"><span class="pre">Controller</span></code></a></p>
<p>Handles the following APIs:</p>
<ul class="simple">
<li><p>GET Bucket logging</p></li>
<li><p>PUT Bucket logging</p></li>
</ul>
<p>Those APIs are logged as LOGGING_STATUS operations in the S3 server log.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.logging.LoggingStatusController.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.logging.LoggingStatusController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles GET Bucket logging.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.s3api.controllers.logging.LoggingStatusController.PUT">
<span class="sig-name descname"><span class="pre">PUT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.s3api.controllers.logging.LoggingStatusController.PUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles PUT Bucket logging.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-swift.common.middleware.backend_ratelimit">
<span id="backend-ratelimit"></span><h2>Backend Ratelimit<a class="headerlink" href="#module-swift.common.middleware.backend_ratelimit" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.backend_ratelimit.BackendRateLimitMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.backend_ratelimit.</span></span><span class="sig-name descname"><span class="pre">BackendRateLimitMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.backend_ratelimit.BackendRateLimitMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Backend rate-limiting middleware.</p>
<p>Rate-limits requests to backend storage node devices. Each device is
independently rate-limited. All requests with a ‘GET’, ‘HEAD’, ‘PUT’,
‘POST’, ‘DELETE’, ‘UPDATE’ or ‘REPLICATE’ method are included in a device’s
rate limit.</p>
<p>If a request would cause the rate-limit to be exceeded then a response with
a 529 status code is returned.</p>
</dd></dl>

</section>
<section id="module-swift.common.middleware.bulk">
<span id="bulk-operations-delete-and-archive-auto-extraction"></span><span id="bulk"></span><h2>Bulk Operations (Delete and Archive Auto Extraction)<a class="headerlink" href="#module-swift.common.middleware.bulk" title="Permalink to this heading">¶</a></h2>
<p>Middleware that will perform many operations on a single request.</p>
<section id="extract-archive">
<h3>Extract Archive<a class="headerlink" href="#extract-archive" title="Permalink to this heading">¶</a></h3>
<p>Expand tar files into a Swift account. Request must be a PUT with the
query parameter <code class="docutils literal notranslate"><span class="pre">?extract-archive=format</span></code> specifying the format of archive
file. Accepted formats are tar, tar.gz, and tar.bz2.</p>
<p>For a PUT to the following url:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/v1/AUTH_Account/$UPLOAD_PATH?extract-archive=tar.gz
</pre></div>
</div>
<p>UPLOAD_PATH is where the files will be expanded to. UPLOAD_PATH can be a
container, a pseudo-directory within a container, or an empty string. The
destination of a file in the archive will be built as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/v1/AUTH_Account/$UPLOAD_PATH/$FILE_PATH
</pre></div>
</div>
<p>Where FILE_PATH is the file name from the listing in the tar file.</p>
<p>If the UPLOAD_PATH is an empty string, containers will be auto created
accordingly and files in the tar that would not map to any container (files
in the base directory) will be ignored.</p>
<p>Only regular files will be uploaded. Empty directories, symlinks, etc will
not be uploaded.</p>
</section>
<section id="content-type">
<h3>Content Type<a class="headerlink" href="#content-type" title="Permalink to this heading">¶</a></h3>
<p>If the content-type header is set in the extract-archive call, Swift will
assign that content-type to all the underlying files. The bulk middleware
will extract the archive file and send the internal files using PUT
operations using the same headers from the original request
(e.g. auth-tokens, content-Type, etc.). Notice that any middleware call
that follows the bulk middleware does not know if this was a bulk request
or if these were individual requests sent by the user.</p>
<p>In order to make Swift detect the content-type for the files based on the
file extension, the content-type in the extract-archive call should not be
set. Alternatively, it is possible to explicitly tell Swift to detect the
content type using this header:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">-</span><span class="n">Detect</span><span class="o">-</span><span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">true</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -X PUT http://127.0.0.1/v1/AUTH_acc/cont/$?extract-archive=tar
 -T backup.tar
 -H &quot;Content-Type: application/x-tar&quot;
 -H &quot;X-Auth-Token: xxx&quot;
 -H &quot;X-Detect-Content-Type: true&quot;
</pre></div>
</div>
</section>
<section id="assigning-metadata">
<h3>Assigning Metadata<a class="headerlink" href="#assigning-metadata" title="Permalink to this heading">¶</a></h3>
<p>The tar file format (1) allows for UTF-8 key/value pairs to be associated
with each file in an archive. If a file has extended attributes, then tar
will store those as key/value pairs. The bulk middleware can read those
extended attributes and convert them to Swift object metadata. Attributes
starting with “user.meta” are converted to object metadata, and
“user.mime_type” is converted to Content-Type.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setfattr</span> <span class="o">-</span><span class="n">n</span> <span class="n">user</span><span class="o">.</span><span class="n">mime_type</span> <span class="o">-</span><span class="n">v</span> <span class="s2">&quot;application/python-setup&quot;</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span>
<span class="n">setfattr</span> <span class="o">-</span><span class="n">n</span> <span class="n">user</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">lunch</span> <span class="o">-</span><span class="n">v</span> <span class="s2">&quot;burger and fries&quot;</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span>
<span class="n">setfattr</span> <span class="o">-</span><span class="n">n</span> <span class="n">user</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">dinner</span> <span class="o">-</span><span class="n">v</span> <span class="s2">&quot;baked ziti&quot;</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span>
<span class="n">setfattr</span> <span class="o">-</span><span class="n">n</span> <span class="n">user</span><span class="o">.</span><span class="n">stuff</span> <span class="o">-</span><span class="n">v</span> <span class="s2">&quot;whee&quot;</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Will get translated to headers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">setup</span>
<span class="n">X</span><span class="o">-</span><span class="n">Object</span><span class="o">-</span><span class="n">Meta</span><span class="o">-</span><span class="n">Lunch</span><span class="p">:</span> <span class="n">burger</span> <span class="ow">and</span> <span class="n">fries</span>
<span class="n">X</span><span class="o">-</span><span class="n">Object</span><span class="o">-</span><span class="n">Meta</span><span class="o">-</span><span class="n">Dinner</span><span class="p">:</span> <span class="n">baked</span> <span class="n">ziti</span>
</pre></div>
</div>
<p>The bulk middleware  will handle xattrs stored by both GNU and BSD tar (2).
Only xattrs <code class="docutils literal notranslate"><span class="pre">user.mime_type</span></code> and <code class="docutils literal notranslate"><span class="pre">user.meta.*</span></code> are processed. Other
attributes are ignored.</p>
<p>In addition to the extended attributes, the object metadata and the
x-delete-at/x-delete-after headers set in the request are also assigned to the
extracted objects.</p>
<p>Notes:</p>
<p>(1) The POSIX 1003.1-2001 (pax) format. The default format on GNU tar
1.27.1 or later.</p>
<p>(2) Even with pax-format tarballs, different encoders store xattrs slightly
differently; for example, GNU tar stores the xattr “user.userattribute” as
pax header “SCHILY.xattr.user.userattribute”, while BSD tar (which uses
libarchive) stores it as “LIBARCHIVE.xattr.user.userattribute”.</p>
</section>
<section id="response">
<h3>Response<a class="headerlink" href="#response" title="Permalink to this heading">¶</a></h3>
<p>The response from bulk operations functions differently from other Swift
responses. This is because a short request body sent from the client could
result in many operations on the proxy server and precautions need to be
made to prevent the request from timing out due to lack of activity. To
this end, the client will always receive a 200 OK response, regardless of
the actual success of the call.  The body of the response must be parsed to
determine the actual success of the operation. In addition to this the
client may receive zero or more whitespace characters prepended to the
actual response body while the proxy server is completing the request.</p>
<p>The format of the response body defaults to text/plain but can be either
json or xml depending on the <code class="docutils literal notranslate"><span class="pre">Accept</span></code> header. Acceptable formats are
<code class="docutils literal notranslate"><span class="pre">text/plain</span></code>, <code class="docutils literal notranslate"><span class="pre">application/json</span></code>, <code class="docutils literal notranslate"><span class="pre">application/xml</span></code>, and <code class="docutils literal notranslate"><span class="pre">text/xml</span></code>.
An example body is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Response Status&quot;</span><span class="p">:</span> <span class="s2">&quot;201 Created&quot;</span><span class="p">,</span>
 <span class="s2">&quot;Response Body&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
 <span class="s2">&quot;Errors&quot;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s2">&quot;Number Files Created&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
</pre></div>
</div>
<p>If all valid files were uploaded successfully the Response Status will be
201 Created.  If any files failed to be created the response code
corresponds to the subrequest’s error. Possible codes are 400, 401, 502 (on
server errors), etc. In both cases the response body will specify the
number of files successfully uploaded and a list of the files that failed.</p>
<p>There are proxy logs created for each file (which becomes a subrequest) in
the tar. The subrequest’s proxy log will have a swift.source set to “EA”
the log’s content length will reflect the unzipped size of the file. If
double proxy-logging is used the leftmost logger will not have a
swift.source set and the content length will reflect the size of the
payload sent to the proxy (the unexpanded size of the tar.gz).</p>
</section>
<section id="bulk-delete">
<h3>Bulk Delete<a class="headerlink" href="#bulk-delete" title="Permalink to this heading">¶</a></h3>
<p>Will delete multiple objects or containers from their account with a
single request. Responds to POST requests with query parameter
<code class="docutils literal notranslate"><span class="pre">?bulk-delete</span></code> set. The request url is your storage url. The Content-Type
should be set to <code class="docutils literal notranslate"><span class="pre">text/plain</span></code>. The body of the POST request will be a
newline separated list of url encoded objects to delete. You can delete
10,000 (configurable) objects per request. The objects specified in the
POST request body must be URL encoded and in the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">container_name</span><span class="o">/</span><span class="n">obj_name</span>
</pre></div>
</div>
<p>or for a container (which must be empty at time of delete):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">container_name</span>
</pre></div>
</div>
<p>The response is similar to extract archive as in every response will be a
200 OK and you must parse the response body for actual results. An example
response is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Number Not Found&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s2">&quot;Response Status&quot;</span><span class="p">:</span> <span class="s2">&quot;200 OK&quot;</span><span class="p">,</span>
 <span class="s2">&quot;Response Body&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
 <span class="s2">&quot;Errors&quot;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s2">&quot;Number Deleted&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
</pre></div>
</div>
<p>If all items were successfully deleted (or did not exist), the Response
Status will be 200 OK. If any failed to delete, the response code
corresponds to the subrequest’s error. Possible codes are 400, 401, 502 (on
server errors), etc. In all cases the response body will specify the number
of items successfully deleted, not found, and a list of those that failed.
The return body will be formatted in the way specified in the request’s
<code class="docutils literal notranslate"><span class="pre">Accept</span></code> header. Acceptable formats are <code class="docutils literal notranslate"><span class="pre">text/plain</span></code>, <code class="docutils literal notranslate"><span class="pre">application/json</span></code>,
<code class="docutils literal notranslate"><span class="pre">application/xml</span></code>, and <code class="docutils literal notranslate"><span class="pre">text/xml</span></code>.</p>
<p>There are proxy logs created for each object or container (which becomes a
subrequest) that is deleted. The subrequest’s proxy log will have a
swift.source set to “BD” the log’s content length of 0. If double
proxy-logging is used the leftmost logger will not have a
swift.source set and the content length will reflect the size of the
payload sent to the proxy (the list of objects/containers to be deleted).</p>
</section>
<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.bulk.CreateContainerError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.bulk.</span></span><span class="sig-name descname"><span class="pre">CreateContainerError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status_int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.bulk.CreateContainerError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.bulk.get_response_body">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.bulk.</span></span><span class="sig-name descname"><span class="pre">get_response_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_format</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_tag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.bulk.get_response_body" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a properly formatted response body according to format.</p>
<p>Handles json and xml, otherwise will return text/plain.
Note: xml response does not include xml declaration.</p>
<dl class="field-list simple">
<dt class="field-odd">Params data_format<span class="colon">:</span></dt>
<dd class="field-odd"><p>resulting format</p>
</dd>
<dt class="field-even">Params data_dict<span class="colon">:</span></dt>
<dd class="field-even"><p>generated data about results.</p>
</dd>
<dt class="field-odd">Params error_list<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of quoted filenames that failed</p>
</dd>
<dt class="field-even">Params root_tag<span class="colon">:</span></dt>
<dd class="field-even"><p>the tag name to use for root elements when returning XML;
e.g. ‘extract’ or ‘delete’</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-swift.common.middleware.catch_errors">
<span id="catcherrors"></span><span id="catch-errors"></span><h2>CatchErrors<a class="headerlink" href="#module-swift.common.middleware.catch_errors" title="Permalink to this heading">¶</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.catch_errors.BadResponseLength">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.catch_errors.</span></span><span class="sig-name descname"><span class="pre">BadResponseLength</span></span><a class="headerlink" href="#swift.common.middleware.catch_errors.BadResponseLength" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.catch_errors.CatchErrorMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.catch_errors.</span></span><span class="sig-name descname"><span class="pre">CatchErrorMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.catch_errors.CatchErrorMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Middleware that provides high-level error handling and ensures that a
transaction id will be set for every request.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.catch_errors.CatchErrorsContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.catch_errors.</span></span><span class="sig-name descname"><span class="pre">CatchErrorsContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_id_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.catch_errors.CatchErrorsContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.wsgi.WSGIContext" title="swift.common.wsgi.WSGIContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIContext</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.catch_errors.enforce_byte_count">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.catch_errors.</span></span><span class="sig-name descname"><span class="pre">enforce_byte_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inner_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbytes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.catch_errors.enforce_byte_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Enforces that inner_iter yields exactly &lt;nbytes&gt; bytes before
exhaustion.</p>
<p>If inner_iter fails to do so, BadResponseLength is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inner_iter</strong> – iterable of bytestrings</p></li>
<li><p><strong>nbytes</strong> – number of bytes expected</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-swift.common.middleware.cname_lookup">
<span id="cname-lookup"></span><h2>CNAME Lookup<a class="headerlink" href="#module-swift.common.middleware.cname_lookup" title="Permalink to this heading">¶</a></h2>
<p>CNAME Lookup Middleware</p>
<p>Middleware that translates an unknown domain in the host header to
something that ends with the configured storage_domain by looking up
the given domain’s CNAME record in DNS.</p>
<p>This middleware will continue to follow a CNAME chain in DNS until it finds
a record ending in the configured storage domain or it reaches the configured
maximum lookup depth. If a match is found, the environment’s Host header is
rewritten and the request is passed further down the WSGI chain.</p>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.cname_lookup.CNAMELookupMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.cname_lookup.</span></span><span class="sig-name descname"><span class="pre">CNAMELookupMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.cname_lookup.CNAMELookupMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>CNAME Lookup Middleware</p>
<p>See above for a full description.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> – The next WSGI filter or app in the paste.deploy
chain.</p></li>
<li><p><strong>conf</strong> – The configuration dict for the middleware.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.cname_lookup.lookup_cname">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.cname_lookup.</span></span><span class="sig-name descname"><span class="pre">lookup_cname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolver</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.cname_lookup.lookup_cname" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a domain, returns its DNS CNAME mapping and DNS ttl.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> – domain to query on</p></li>
<li><p><strong>resolver</strong> – dns.resolver.Resolver() instance used for executing DNS
queries</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(ttl, result)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-swift.common.middleware.container_quotas">
<span id="id2"></span><span id="container-quotas"></span><h2>Container Quotas<a class="headerlink" href="#module-swift.common.middleware.container_quotas" title="Permalink to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">container_quotas</span></code> middleware implements simple quotas that can be
imposed on swift containers by a user with the ability to set container
metadata, most likely the account administrator.  This can be useful for
limiting the scope of containers that are delegated to non-admin users, exposed
to <code class="docutils literal notranslate"><span class="pre">formpost</span></code> uploads, or just as a self-imposed sanity check.</p>
<p>Any object PUT operations that exceed these quotas return a 413 response
(request entity too large) with a descriptive body.</p>
<p>Quotas are subject to several limitations: eventual consistency, the timeliness
of the cached container_info (60 second ttl by default), and it’s unable to
reject chunked transfer uploads that exceed the quota (though once the quota
is exceeded, new chunked transfers will be refused).</p>
<p>Quotas are set by adding meta values to the container, and are validated when
set:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Metadata</p></th>
<th class="head"><p>Use</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>X-Container-Meta-Quota-Bytes</p></td>
<td><p>Maximum size of the
container, in bytes.</p></td>
</tr>
<tr class="row-odd"><td><p>X-Container-Meta-Quota-Count</p></td>
<td><p>Maximum object count of the
container.</p></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">container_quotas</span></code> middleware should be added to the pipeline in your
<code class="docutils literal notranslate"><span class="pre">/etc/swift/proxy-server.conf</span></code> file just after any auth middleware.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">pipeline</span><span class="p">:</span><span class="n">main</span><span class="p">]</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">catch_errors</span> <span class="n">cache</span> <span class="n">tempauth</span> <span class="n">container_quotas</span> <span class="n">proxy</span><span class="o">-</span><span class="n">server</span>

<span class="p">[</span><span class="nb">filter</span><span class="p">:</span><span class="n">container_quotas</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#container_quotas</span>
</pre></div>
</div>
</section>
<section id="module-swift.common.middleware.container_sync">
<span id="container-sync-middleware"></span><span id="container-sync"></span><h2>Container Sync Middleware<a class="headerlink" href="#module-swift.common.middleware.container_sync" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.container_sync.ContainerSync">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.container_sync.</span></span><span class="sig-name descname"><span class="pre">ContainerSync</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.container_sync.ContainerSync" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>WSGI middleware that validates an incoming container sync request
using the container-sync-realms.conf style of container sync.</p>
</dd></dl>

</section>
<section id="module-swift.common.middleware.crossdomain">
<span id="cross-domain-policies"></span><h2>Cross Domain Policies<a class="headerlink" href="#module-swift.common.middleware.crossdomain" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crossdomain.CrossDomainMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crossdomain.</span></span><span class="sig-name descname"><span class="pre">CrossDomainMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crossdomain.CrossDomainMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Cross domain middleware used to respond to requests for cross domain
policy information.</p>
<p>If the path is /crossdomain.xml it will respond with an xml cross domain
policy document. This allows web pages hosted elsewhere to use client
side technologies such as Flash, Java and Silverlight to interact
with the Swift API.</p>
<p>To enable this middleware, add it to the pipeline in your proxy-server.conf
file. It should be added before any authentication (e.g., tempauth or
keystone) middleware. In this example ellipsis (…) indicate other
middleware you may have chosen to use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">pipeline</span><span class="p">:</span><span class="n">main</span><span class="p">]</span>
<span class="n">pipeline</span> <span class="o">=</span>  <span class="o">...</span> <span class="n">crossdomain</span> <span class="o">...</span> <span class="n">authtoken</span> <span class="o">...</span> <span class="n">proxy</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
<p>And add a filter section, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">filter</span><span class="p">:</span><span class="n">crossdomain</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#crossdomain</span>
<span class="n">cross_domain_policy</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">allow</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="kn">from</span> <span class="nn">domain</span><span class="o">=</span><span class="s2">&quot;*.example.com&quot;</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">allow</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="kn">from</span> <span class="nn">domain</span><span class="o">=</span><span class="s2">&quot;www.example.com&quot;</span> <span class="n">secure</span><span class="o">=</span><span class="s2">&quot;false&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
<p>For continuation lines, put some whitespace before the continuation
text. Ensure you put a completely blank line to terminate the
cross_domain_policy value.</p>
<p>The cross_domain_policy name/value is optional. If omitted, the policy
defaults as if you had specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cross_domain_policy</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">allow</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="kn">from</span> <span class="nn">domain</span><span class="o">=</span><span class="s2">&quot;*&quot;</span> <span class="n">secure</span><span class="o">=</span><span class="s2">&quot;false&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crossdomain.CrossDomainMiddleware.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crossdomain.CrossDomainMiddleware.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 200 response with cross domain policy information</p>
</dd></dl>

</dd></dl>

</section>
<section id="discoverability">
<span id="id3"></span><h2>Discoverability<a class="headerlink" href="#discoverability" title="Permalink to this heading">¶</a></h2>
<p>Swift will by default provide clients with an interface providing details
about the installation. Unless disabled (i.e <code class="docutils literal notranslate"><span class="pre">expose_info=false</span></code> in
<a class="reference internal" href="config/proxy_server_config.html#proxy-server-config"><span class="std std-ref">Proxy Server Configuration</span></a>), a GET request to <code class="docutils literal notranslate"><span class="pre">/info</span></code> will return configuration
data in JSON format.  An example response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;swift&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.11.0&quot;</span><span class="p">},</span> <span class="s2">&quot;staticweb&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;tempurl&quot;</span><span class="p">:</span> <span class="p">{}}</span>
</pre></div>
</div>
<p>This would signify to the client that swift version 1.11.0 is running and that
staticweb and tempurl are available in this installation.</p>
<p>There may be administrator-only information available via <code class="docutils literal notranslate"><span class="pre">/info</span></code>. To
retrieve it, one must use an HMAC-signed request, similar to TempURL.
The signature may be produced like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="n">tempurl</span> <span class="n">GET</span> <span class="mi">3600</span> <span class="o">/</span><span class="n">info</span> <span class="n">secret</span> <span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span> <span class="o">|</span> <span class="n">sed</span> <span class="n">s</span><span class="o">/</span><span class="n">temp_url</span><span class="o">/</span><span class="n">swiftinfo</span><span class="o">/</span><span class="n">g</span>
</pre></div>
</div>
</section>
<section id="module-swift.common.middleware.domain_remap">
<span id="domain-remap"></span><h2>Domain Remap<a class="headerlink" href="#module-swift.common.middleware.domain_remap" title="Permalink to this heading">¶</a></h2>
<p>Domain Remap Middleware</p>
<p>Middleware that translates container and account parts of a domain to path
parameters that the proxy server understands.</p>
<p>Translation is only performed when the request URL’s host domain matches one of
a list of domains. This list may be configured by the option
<code class="docutils literal notranslate"><span class="pre">storage_domain</span></code>, and defaults to the single domain <code class="docutils literal notranslate"><span class="pre">example.com</span></code>.</p>
<p>If not already present, a configurable <code class="docutils literal notranslate"><span class="pre">path_root</span></code>, which defaults to <code class="docutils literal notranslate"><span class="pre">v1</span></code>,
will be added to the start of the translated path.</p>
<p>For example, with the default configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">container</span><span class="o">.</span><span class="n">AUTH</span><span class="o">-</span><span class="n">account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="nb">object</span>
<span class="n">container</span><span class="o">.</span><span class="n">AUTH</span><span class="o">-</span><span class="n">account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="nb">object</span>
</pre></div>
</div>
<p>would both be translated to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">container</span><span class="o">.</span><span class="n">AUTH</span><span class="o">-</span><span class="n">account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">AUTH_account</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
</pre></div>
</div>
<p>and:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AUTH</span><span class="o">-</span><span class="n">account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
<span class="n">AUTH</span><span class="o">-</span><span class="n">account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
</pre></div>
</div>
<p>would both be translated to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AUTH</span><span class="o">-</span><span class="n">account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">AUTH_account</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
</pre></div>
</div>
<p>Additionally, translation is only performed when the account name in the
translated path starts with a reseller prefix matching one of a list configured
by the option <code class="docutils literal notranslate"><span class="pre">reseller_prefixes</span></code>, or when no match is found but a
<code class="docutils literal notranslate"><span class="pre">default_reseller_prefix</span></code> has been configured.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">reseller_prefixes</span></code> list defaults to the single prefix <code class="docutils literal notranslate"><span class="pre">AUTH</span></code>. The
<code class="docutils literal notranslate"><span class="pre">default_reseller_prefix</span></code> is not configured by default.</p>
<p>Browsers can convert a host header to lowercase, so the middleware checks that
the reseller prefix on the account name is the correct case. This is done by
comparing the items in the <code class="docutils literal notranslate"><span class="pre">reseller_prefixes</span></code> config option to the found
prefix. If they match except for case, the item from <code class="docutils literal notranslate"><span class="pre">reseller_prefixes</span></code> will
be used instead of the found reseller prefix. The middleware will also replace
any hyphen (‘-’) in the account name with an underscore (‘_’).</p>
<p>For example, with the default configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auth</span><span class="o">-</span><span class="n">account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
<span class="n">AUTH</span><span class="o">-</span><span class="n">account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
<span class="n">auth_account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
<span class="n">AUTH_account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
</pre></div>
</div>
<p>would all be translated to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">unchanged</span><span class="o">&gt;.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">AUTH_account</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
</pre></div>
</div>
<p>When no match is found in <code class="docutils literal notranslate"><span class="pre">reseller_prefixes</span></code>, the
<code class="docutils literal notranslate"><span class="pre">default_reseller_prefix</span></code> config option is used. When no
<code class="docutils literal notranslate"><span class="pre">default_reseller_prefix</span></code> is configured, any request with an account prefix
not in the <code class="docutils literal notranslate"><span class="pre">reseller_prefixes</span></code> list will be ignored by this middleware.</p>
<p>For example, with <code class="docutils literal notranslate"><span class="pre">default_reseller_prefix</span> <span class="pre">=</span> <span class="pre">AUTH</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
</pre></div>
</div>
<p>would be translated to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">account</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">AUTH_account</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="nb">object</span>
</pre></div>
</div>
<p>Note that this middleware requires that container names and account names
(except as described above) must be DNS-compatible. This means that the account
name created in the system and the containers created by users cannot exceed 63
characters or have UTF-8 characters. These are restrictions over and above what
Swift requires and are not explicitly checked. Simply put, this middleware
will do a best-effort attempt to derive account and container names from
elements in the domain name and put those derived values into the URL path
(leaving the <code class="docutils literal notranslate"><span class="pre">Host</span></code> header unchanged).</p>
<p>Also note that using <a class="reference internal" href="overview_container_sync.html"><span class="doc">Container to Container Synchronization</span></a> with remapped domain names
is not advised. With <a class="reference internal" href="overview_container_sync.html"><span class="doc">Container to Container Synchronization</span></a>, you should use the true
storage end points as sync destinations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.domain_remap.DomainRemapMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.domain_remap.</span></span><span class="sig-name descname"><span class="pre">DomainRemapMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.domain_remap.DomainRemapMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Domain Remap Middleware</p>
<p>See above for a full description.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> – The next WSGI filter or app in the paste.deploy
chain.</p></li>
<li><p><strong>conf</strong> – The configuration dict for the middleware.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="dynamic-large-objects">
<h2>Dynamic Large Objects<a class="headerlink" href="#dynamic-large-objects" title="Permalink to this heading">¶</a></h2>
<p>DLO support centers around a user specified filter that matches
segments and concatenates them together in object listing order. Please see
the DLO docs for <a class="reference internal" href="overview_large_objects.html#dlo-doc"><span class="std std-ref">Dynamic Large Objects</span></a> further details.</p>
</section>
<section id="encryption">
<span id="id4"></span><h2>Encryption<a class="headerlink" href="#encryption" title="Permalink to this heading">¶</a></h2>
<p>Encryption middleware should be deployed in conjunction with the
<a class="reference internal" href="#keymaster"><span class="std std-ref">Keymaster</span></a> middleware.</p>
<span class="target" id="module-swift.common.middleware.crypto"></span><p>Implements middleware for object encryption which comprises an instance of a
<a class="reference internal" href="#swift.common.middleware.crypto.decrypter.Decrypter" title="swift.common.middleware.crypto.decrypter.Decrypter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Decrypter</span></code></a> combined with an
instance of an <a class="reference internal" href="#swift.common.middleware.crypto.encrypter.Encrypter" title="swift.common.middleware.crypto.encrypter.Encrypter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Encrypter</span></code></a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides a factory function for loading encryption middleware.</p>
</dd></dl>

<span class="target" id="module-swift.common.middleware.crypto.encrypter"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.encrypter.EncInputWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.encrypter.</span></span><span class="sig-name descname"><span class="pre">EncInputWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crypto</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.encrypter.EncInputWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>File-like object to be swapped in for wsgi.input.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.encrypter.Encrypter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.encrypter.</span></span><span class="sig-name descname"><span class="pre">Encrypter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.encrypter.Encrypter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Middleware for encrypting data and user metadata.</p>
<p>By default all PUT or POST’ed object data and/or metadata will be
encrypted. Encryption of new data and/or metadata may be disabled by
setting the <code class="docutils literal notranslate"><span class="pre">disable_encryption</span></code> option to True. However, this middleware
should remain in the pipeline in order for existing encrypted data to be
read.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.encrypter.EncrypterObjContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.encrypter.</span></span><span class="sig-name descname"><span class="pre">EncrypterObjContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encrypter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.encrypter.EncrypterObjContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CryptoWSGIContext</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.encrypter.EncrypterObjContext.encrypt_user_metadata">
<span class="sig-name descname"><span class="pre">encrypt_user_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.encrypter.EncrypterObjContext.encrypt_user_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt user-metadata header values. Replace each x-object-meta-&lt;key&gt;
user metadata header with a corresponding
x-object-transient-sysmeta-crypto-meta-&lt;key&gt; header which has the
crypto metadata required to decrypt appended to the encrypted value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – a swob Request</p></li>
<li><p><strong>keys</strong> – a dict of encryption keys</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.encrypter.EncrypterObjContext.handle_post">
<span class="sig-name descname"><span class="pre">handle_post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.encrypter.EncrypterObjContext.handle_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt the new object headers with a new iv and the current crypto.
Note that an object may have encrypted headers while the body may
remain unencrypted.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.encrypter.encrypt_header_val">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.encrypter.</span></span><span class="sig-name descname"><span class="pre">encrypt_header_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crypto</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.encrypter.encrypt_header_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt a header value using the supplied key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crypto</strong> – a Crypto instance</p></li>
<li><p><strong>value</strong> – value to encrypt</p></li>
<li><p><strong>key</strong> – crypto key to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of (encrypted value, crypto_meta) where crypto_meta is a
dict of form returned by
<code class="xref py py-func docutils literal notranslate"><span class="pre">get_crypto_meta()</span></code></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if value is empty</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-swift.common.middleware.crypto.decrypter"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.BaseDecrypterContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.decrypter.</span></span><span class="sig-name descname"><span class="pre">BaseDecrypterContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crypto_app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CryptoWSGIContext</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.BaseDecrypterContext.decrypt_value">
<span class="sig-name descname"><span class="pre">decrypt_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crypto_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext.decrypt_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Base64-decode and decrypt a value using the crypto_meta provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – a base64-encoded value to decrypt</p></li>
<li><p><strong>key</strong> – crypto key to use</p></li>
<li><p><strong>crypto_meta</strong> – a crypto-meta dict of form returned by
<code class="xref py py-func docutils literal notranslate"><span class="pre">get_crypto_meta()</span></code></p></li>
<li><p><strong>decoder</strong> – function to turn the decrypted bytes into useful data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>decrypted value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.BaseDecrypterContext.decrypt_value_with_meta">
<span class="sig-name descname"><span class="pre">decrypt_value_with_meta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext.decrypt_value_with_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Base64-decode and decrypt a value if crypto meta can be extracted from
the value itself, otherwise return the value unmodified.</p>
<p>A value should either be a string that does not contain the ‘;’
character or should be of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">base64</span><span class="o">-</span><span class="n">encoded</span> <span class="n">ciphertext</span><span class="o">&gt;</span><span class="p">;</span><span class="n">swift_meta</span><span class="o">=&lt;</span><span class="n">crypto</span> <span class="n">meta</span><span class="o">&gt;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – value to decrypt</p></li>
<li><p><strong>key</strong> – crypto key to use</p></li>
<li><p><strong>required</strong> – if True then the value is required to be decrypted
and an EncryptionException will be raised if the
header cannot be decrypted due to missing crypto meta.</p></li>
<li><p><strong>decoder</strong> – function to turn the decrypted bytes into useful data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>decrypted value if crypto meta is found, otherwise the
unmodified value</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#swift.common.exceptions.EncryptionException" title="swift.common.exceptions.EncryptionException"><strong>EncryptionException</strong></a> – if an error occurs while parsing crypto
meta or if the header value was required
to be decrypted but crypto meta was not
found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.BaseDecrypterContext.get_crypto_meta">
<span class="sig-name descname"><span class="pre">get_crypto_meta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext.get_crypto_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a crypto_meta dict from a header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header_name</strong> – name of header that may have crypto_meta</p></li>
<li><p><strong>check</strong> – if True validate the crypto meta</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dict containing crypto_meta items</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#swift.common.exceptions.EncryptionException" title="swift.common.exceptions.EncryptionException"><strong>EncryptionException</strong></a> – if an error occurs while parsing the
crypto meta</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.BaseDecrypterContext.get_decryption_keys">
<span class="sig-name descname"><span class="pre">get_decryption_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crypto_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext.get_decryption_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if a response should be decrypted, and if so then fetch keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – a Request object</p></li>
<li><p><strong>crypto_meta</strong> – a dict of crypto metadata</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dict of decryption keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.BaseDecrypterContext.get_unwrapped_key">
<span class="sig-name descname"><span class="pre">get_unwrapped_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crypto_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrapping_key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext.get_unwrapped_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a wrapped key from crypto-meta and unwrap it using the provided
wrapping key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crypto_meta</strong> – a dict of crypto-meta</p></li>
<li><p><strong>wrapping_key</strong> – key to be used to decrypt the wrapped key</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an unwrapped key</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>HTTPInternalServerError</strong> – if the crypto-meta has no wrapped key
or the unwrapped key is invalid</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.Decrypter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.decrypter.</span></span><span class="sig-name descname"><span class="pre">Decrypter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.Decrypter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Middleware for decrypting data and user metadata.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.DecrypterContContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.decrypter.</span></span><span class="sig-name descname"><span class="pre">DecrypterContContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decrypter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.DecrypterContContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext" title="swift.common.middleware.crypto.decrypter.BaseDecrypterContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDecrypterContext</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.DecrypterContContext.process_json_resp">
<span class="sig-name descname"><span class="pre">process_json_resp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resp_iter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.DecrypterContContext.process_json_resp" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses json body listing and decrypt encrypted entries. Updates
Content-Length header with new body length and return a body iter.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.DecrypterObjContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.decrypter.</span></span><span class="sig-name descname"><span class="pre">DecrypterObjContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decrypter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.DecrypterObjContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext" title="swift.common.middleware.crypto.decrypter.BaseDecrypterContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDecrypterContext</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.DecrypterObjContext.decrypt_resp_headers">
<span class="sig-name descname"><span class="pre">decrypt_resp_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">put_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_cors_exposed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.DecrypterObjContext.decrypt_resp_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Find encrypted headers and replace with the decrypted versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>put_keys</strong> – a dict of decryption keys used for object PUT.</p></li>
<li><p><strong>post_keys</strong> – a dict of decryption keys used for object POST.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of headers with any encrypted headers replaced by their
decrypted values.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>HTTPInternalServerError</strong> – if any error occurs while decrypting
headers</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.DecrypterObjContext.multipart_response_iter">
<span class="sig-name descname"><span class="pre">multipart_response_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crypto_meta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.DecrypterObjContext.multipart_response_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypts a multipart mime doc response body.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resp</strong> – application response</p></li>
<li><p><strong>boundary</strong> – multipart boundary string</p></li>
<li><p><strong>body_key</strong> – decryption key for the response body</p></li>
<li><p><strong>crypto_meta</strong> – crypto_meta for the response body</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>generator for decrypted response body</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.decrypter.DecrypterObjContext.response_iter">
<span class="sig-name descname"><span class="pre">response_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crypto_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.decrypter.DecrypterObjContext.response_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypts a response body.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resp</strong> – application response</p></li>
<li><p><strong>body_key</strong> – decryption key for the response body</p></li>
<li><p><strong>crypto_meta</strong> – crypto_meta for the response body</p></li>
<li><p><strong>offset</strong> – offset into object content at which response body starts</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>generator for decrypted response body</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-swift.common.middleware.etag_quoter">
<span id="id5"></span><span id="etag-quoter"></span><h2>Etag Quoter<a class="headerlink" href="#module-swift.common.middleware.etag_quoter" title="Permalink to this heading">¶</a></h2>
<p>This middleware fix the Etag header of responses so that it is RFC compliant.
<a class="reference external" href="https://tools.ietf.org/html/rfc7232#section-2.3">RFC 7232</a> specifies that
the value of the Etag header must be double quoted.</p>
<p>It must be placed at the beggining of the pipeline, right after cache:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">pipeline</span><span class="p">:</span><span class="n">main</span><span class="p">]</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="o">...</span>  <span class="n">cache</span> <span class="n">etag</span><span class="o">-</span><span class="n">quoter</span> <span class="o">...</span>

<span class="p">[</span><span class="nb">filter</span><span class="p">:</span><span class="n">etag</span><span class="o">-</span><span class="n">quoter</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#etag_quoter</span>
</pre></div>
</div>
<p>Set <code class="docutils literal notranslate"><span class="pre">X-Account-Rfc-Compliant-Etags:</span> <span class="pre">true</span></code> at the account
level to have any Etags in object responses be double quoted, as in
<code class="docutils literal notranslate"><span class="pre">&quot;d41d8cd98f00b204e9800998ecf8427e&quot;</span></code>. Alternatively, you may
only fix Etags in a single container by setting
<code class="docutils literal notranslate"><span class="pre">X-Container-Rfc-Compliant-Etags:</span> <span class="pre">true</span></code> on the container.
This may be necessary for Swift to work properly with some CDNs.</p>
<p>Either option may also be explicitly <em>disabled</em>, so you may enable quoted
Etags account-wide as above but turn them off for individual containers
with <code class="docutils literal notranslate"><span class="pre">X-Container-Rfc-Compliant-Etags:</span> <span class="pre">false</span></code>. This may be
useful if some subset of applications expect Etags to be bare MD5s.</p>
</section>
<section id="formpost">
<span id="id6"></span><h2>FormPost<a class="headerlink" href="#formpost" title="Permalink to this heading">¶</a></h2>
<span class="target" id="module-swift.common.middleware.formpost"></span><p>FormPost Middleware</p>
<p>Translates a browser form post into a regular Swift object PUT.</p>
<p>The format of the form is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;&lt;swift-url&gt;&quot;</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span>
      <span class="n">enctype</span><span class="o">=</span><span class="s2">&quot;multipart/form-data&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;redirect&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;redirect-url&gt;&quot;</span> <span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;max_file_size&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;bytes&gt;&quot;</span> <span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;max_file_count&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;count&gt;&quot;</span> <span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;expires&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;unix-timestamp&gt;&quot;</span> <span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;signature&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;hmac&gt;&quot;</span> <span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;file&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;file1&quot;</span> <span class="o">/&gt;&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Optionally, if you want the uploaded files to be temporary you can set
x-delete-at or x-delete-after attributes by adding one of these as a
form input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;x_delete_at&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;unix-timestamp&gt;&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;x_delete_after&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&lt;seconds&gt;&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
<p>If you want to specify the content type or content encoding of the files you
can set content-encoding or content-type by adding them to the form input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;content-type&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;text/html&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;content-encoding&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
<p>The above example applies these parameters to all uploaded files. You can also
set the content-type and content-encoding on a per-file basis by adding the
parameters to each part of the upload.</p>
<p>The &lt;swift-url&gt; is the URL of the Swift destination, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">swift</span><span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">AUTH_account</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="n">object_prefix</span>
</pre></div>
</div>
<p>The name of each file uploaded will be appended to the &lt;swift-url&gt;
given. So, you can upload directly to the root of container with a
url like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">swift</span><span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">AUTH_account</span><span class="o">/</span><span class="n">container</span><span class="o">/</span>
</pre></div>
</div>
<p>Optionally, you can include an object prefix to better separate
different users’ uploads, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">swift</span><span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">AUTH_account</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="n">object_prefix</span>
</pre></div>
</div>
<p>Note the form method must be POST and the enctype must be set as
“multipart/form-data”.</p>
<p>The redirect attribute is the URL to redirect the browser to after the upload
completes. This is an optional parameter. If you are uploading the form via an
XMLHttpRequest the redirect should not be included. The URL will have status
and message query parameters added to it, indicating the HTTP status code for
the upload (2xx is success) and a possible message for further information if
there was an error (such as “max_file_size exceeded”).</p>
<p>The max_file_size attribute must be included and indicates the
largest single file upload that can be done, in bytes.</p>
<p>The max_file_count attribute must be included and indicates the
maximum number of files that can be uploaded with the form. Include
additional <code class="docutils literal notranslate"><span class="pre">&lt;input</span> <span class="pre">type=&quot;file&quot;</span> <span class="pre">name=&quot;filexx&quot;</span> <span class="pre">/&gt;</span></code> attributes if
desired.</p>
<p>The expires attribute is the Unix timestamp before which the form
must be submitted before it is invalidated.</p>
<p>The signature attribute is the HMAC signature of the form. Here is
sample code for computing the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha512</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/v1/account/container/object_prefix&#39;</span>
<span class="n">redirect</span> <span class="o">=</span> <span class="s1">&#39;https://srv.com/some-page&#39;</span>  <span class="c1"># set to &#39;&#39; if redirect not in form</span>
<span class="n">max_file_size</span> <span class="o">=</span> <span class="mi">104857600</span>
<span class="n">max_file_count</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">expires</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;mykey&#39;</span>
<span class="n">hmac_body</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span>
    <span class="n">max_file_size</span><span class="p">,</span> <span class="n">max_file_count</span><span class="p">,</span> <span class="n">expires</span><span class="p">)</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">hmac_body</span><span class="p">,</span> <span class="n">sha512</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</pre></div>
</div>
<p>The key is the value of either the account (X-Account-Meta-Temp-URL-Key,
X-Account-Meta-Temp-Url-Key-2) or the container
(X-Container-Meta-Temp-URL-Key, X-Container-Meta-Temp-Url-Key-2) TempURL keys.</p>
<p>Be certain to use the full path, from the /v1/ onward.
Note that x_delete_at and x_delete_after are not used in signature generation
as they are both optional attributes.</p>
<p>The command line tool <code class="docutils literal notranslate"><span class="pre">swift-form-signature</span></code> may be used (mostly
just when testing) to compute expires and signature.</p>
<p>Also note that the file attributes must be after the other attributes
in order to be processed correctly. If attributes come after the
file, they won’t be sent with the subrequest (there is no way to
parse all the attributes on the server-side without reading the whole
thing into memory – to service many requests, some with large files,
there just isn’t enough memory on the server, so attributes following
the file are simply ignored).</p>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.formpost.FormPost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.formpost.</span></span><span class="sig-name descname"><span class="pre">FormPost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.formpost.FormPost" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>FormPost Middleware</p>
<p>See above for a full description.</p>
<p>The proxy logs created for any subrequests made will have swift.source set
to “FP”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> – The next WSGI filter or app in the paste.deploy
chain.</p></li>
<li><p><strong>conf</strong> – The configuration dict for the middleware.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.formpost.FormPost.app">
<span class="sig-name descname"><span class="pre">app</span></span><a class="headerlink" href="#swift.common.middleware.formpost.FormPost.app" title="Permalink to this definition">¶</a></dt>
<dd><p>The next WSGI application/filter in the paste.deploy pipeline.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.formpost.FormPost.conf">
<span class="sig-name descname"><span class="pre">conf</span></span><a class="headerlink" href="#swift.common.middleware.formpost.FormPost.conf" title="Permalink to this definition">¶</a></dt>
<dd><p>The filter configuration dict.</p>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="swift.common.middleware.formpost.MAX_VALUE_LENGTH">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.formpost.</span></span><span class="sig-name descname"><span class="pre">MAX_VALUE_LENGTH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4096</span></em><a class="headerlink" href="#swift.common.middleware.formpost.MAX_VALUE_LENGTH" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum size of any attribute’s value. Any additional data will be
truncated.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="swift.common.middleware.formpost.READ_CHUNK_SIZE">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.formpost.</span></span><span class="sig-name descname"><span class="pre">READ_CHUNK_SIZE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4096</span></em><a class="headerlink" href="#swift.common.middleware.formpost.READ_CHUNK_SIZE" title="Permalink to this definition">¶</a></dt>
<dd><p>The size of data to read from the form at any given time.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.formpost.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.formpost.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.formpost.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the WSGI filter for use with paste.deploy.</p>
</dd></dl>

</section>
<section id="gatekeeper">
<span id="id7"></span><h2>GateKeeper<a class="headerlink" href="#gatekeeper" title="Permalink to this heading">¶</a></h2>
<span class="target" id="module-swift.common.middleware.gatekeeper"></span><p>The <code class="docutils literal notranslate"><span class="pre">gatekeeper</span></code> middleware imposes restrictions on the headers that
may be included with requests and responses. Request headers are filtered
to remove headers that should never be generated by a client. Similarly,
response headers are filtered to remove private headers that should
never be passed to a client.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">gatekeeper</span></code> middleware must always be present in the proxy server
wsgi pipeline. It should be configured close to the start of the pipeline
specified in <code class="docutils literal notranslate"><span class="pre">/etc/swift/proxy-server.conf</span></code>, immediately after catch_errors
and before any other middleware. It is essential that it is configured ahead
of all middlewares using system metadata in order that they function
correctly.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">gatekeeper</span></code> middleware is not configured in the pipeline then it will be
automatically inserted close to the start of the pipeline by the proxy server.</p>
<dl class="py data">
<dt class="sig sig-object py" id="swift.common.middleware.gatekeeper.outbound_exclusions">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.gatekeeper.</span></span><span class="sig-name descname"><span class="pre">outbound_exclusions</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['x-account-sysmeta-',</span> <span class="pre">'x-container-sysmeta-',</span> <span class="pre">'x-object-sysmeta-',</span> <span class="pre">'x-object-transient-sysmeta-',</span> <span class="pre">'x-backend']</span></em><a class="headerlink" href="#swift.common.middleware.gatekeeper.outbound_exclusions" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of python regular expressions that will be used to
match against outbound response headers. Matching headers will
be removed from the response.</p>
</dd></dl>

</section>
<section id="healthcheck">
<span id="id8"></span><h2>Healthcheck<a class="headerlink" href="#healthcheck" title="Permalink to this heading">¶</a></h2>
<span class="target" id="module-swift.common.middleware.healthcheck"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.healthcheck.HealthCheckMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.healthcheck.</span></span><span class="sig-name descname"><span class="pre">HealthCheckMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.healthcheck.HealthCheckMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Healthcheck middleware used for monitoring.</p>
<p>If the path is /healthcheck, it will respond 200 with “OK” as the body.</p>
<p>If the optional config parameter “disable_path” is set, and a file is
present at that path, it will respond 503 with “DISABLED BY FILE” as the
body.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.healthcheck.HealthCheckMiddleware.DISABLED">
<span class="sig-name descname"><span class="pre">DISABLED</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.healthcheck.HealthCheckMiddleware.DISABLED" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 503 response with “DISABLED BY FILE” in the body.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.healthcheck.HealthCheckMiddleware.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.healthcheck.HealthCheckMiddleware.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 200 response with “OK” in the body.</p>
</dd></dl>

</dd></dl>

</section>
<section id="keymaster">
<span id="id9"></span><h2>Keymaster<a class="headerlink" href="#keymaster" title="Permalink to this heading">¶</a></h2>
<p>Keymaster middleware should be deployed in conjunction with the
<a class="reference internal" href="#encryption"><span class="std std-ref">Encryption</span></a> middleware.</p>
<span class="target" id="module-swift.common.middleware.crypto.keymaster"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.keymaster.BaseKeyMaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.keymaster.</span></span><span class="sig-name descname"><span class="pre">BaseKeyMaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.keymaster.BaseKeyMaster" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base middleware for providing encryption keys.</p>
<p>This provides some basic helpers for:</p>
<ul class="simple">
<li><p>loading from a separate config path,</p></li>
<li><p>deriving keys based on path, and</p></li>
<li><p>installing a <code class="docutils literal notranslate"><span class="pre">swift.callback.fetch_crypto_keys</span></code> hook
in the request environment.</p></li>
</ul>
<p>Subclasses should define <code class="docutils literal notranslate"><span class="pre">log_route</span></code>, <code class="docutils literal notranslate"><span class="pre">keymaster_opts</span></code>, and
<code class="docutils literal notranslate"><span class="pre">keymaster_conf_section</span></code> attributes, and implement the
<code class="docutils literal notranslate"><span class="pre">_get_root_secret</span></code> function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.keymaster.BaseKeyMaster.create_key">
<span class="sig-name descname"><span class="pre">create_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secret_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.keymaster.BaseKeyMaster.create_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an encryption key that is unique for the given path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – the (WSGI string) path of the resource being encrypted.</p></li>
<li><p><strong>secret_id</strong> – the id of the root secret from which the key should
be derived.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an encryption key.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#swift.common.exceptions.UnknownSecretIdError" title="swift.common.exceptions.UnknownSecretIdError"><strong>UnknownSecretIdError</strong></a> – if the secret_id is not recognised.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.keymaster.KeyMaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.keymaster.</span></span><span class="sig-name descname"><span class="pre">KeyMaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.keymaster.KeyMaster" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.crypto.keymaster.BaseKeyMaster" title="swift.common.middleware.crypto.keymaster.BaseKeyMaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseKeyMaster</span></code></a></p>
<p>Middleware for providing encryption keys.</p>
<p>The middleware requires its encryption root secret to be set. This is the
root secret from which encryption keys are derived. This must be set before
first use to a value that is at least 256 bits. The security of all
encrypted data critically depends on this key, therefore it should be set
to a high-entropy value. For example, a suitable value may be obtained by
generating a 32 byte (or longer) value using a cryptographically secure
random number generator. Changing the root secret is likely to result in
data loss.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.keymaster.KeyMasterContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.crypto.keymaster.</span></span><span class="sig-name descname"><span class="pre">KeyMasterContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keymaster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_version_to_write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.keymaster.KeyMasterContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.wsgi.WSGIContext" title="swift.common.wsgi.WSGIContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIContext</span></code></a></p>
<p>The simple scheme for key derivation is as follows: every path is
associated with a key, where the key is derived from the path itself in a
deterministic fashion such that the key does not need to be stored.
Specifically, the key for any path is an HMAC of a root key and the path
itself, calculated using an SHA256 hash function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">path_key</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">HMAC_SHA256</span><span class="p">(</span><span class="o">&lt;</span><span class="n">root_secret</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.crypto.keymaster.KeyMasterContext.fetch_crypto_keys">
<span class="sig-name descname"><span class="pre">fetch_crypto_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.crypto.keymaster.KeyMasterContext.fetch_crypto_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup container and object keys based on the request path.</p>
<p>Keys are derived from request path. The ‘id’ entry in the results dict
includes the part of the path used to derive keys. Other keymaster
implementations may use a different strategy to generate keys and may
include a different type of ‘id’, so callers should treat the ‘id’ as
opaque keymaster-specific data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key_id</strong> – if given this should be a dict with the items included
under the <code class="docutils literal notranslate"><span class="pre">id</span></code> key of a dict returned by this method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dict containing encryption keys for ‘object’ and
‘container’, and entries ‘id’ and ‘all_ids’. The ‘all_ids’ entry is a
list of key id dicts for all root secret ids including the one used
to generate the returned keys.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="keystoneauth">
<span id="id10"></span><h2>KeystoneAuth<a class="headerlink" href="#keystoneauth" title="Permalink to this heading">¶</a></h2>
<span class="target" id="module-swift.common.middleware.keystoneauth"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.keystoneauth.KeystoneAuth">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.keystoneauth.</span></span><span class="sig-name descname"><span class="pre">KeystoneAuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.keystoneauth.KeystoneAuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Swift middleware to Keystone authorization system.</p>
<p>In Swift’s proxy-server.conf add this keystoneauth middleware and the
authtoken middleware to your pipeline. Make sure you have the authtoken
middleware before the keystoneauth middleware.</p>
<p>The authtoken middleware will take care of validating the user and
keystoneauth will authorize access.</p>
<p>The sample proxy-server.conf shows a sample pipeline that uses keystone.</p>
<p><a class="reference download internal" download="" href="_downloads/a0b78dc4ad0f48590ceab7ed39e2f98f/proxy-server.conf-sample"><code class="xref download docutils literal notranslate"><span class="pre">proxy-server.conf-sample</span></code></a></p>
<p>The authtoken middleware is shipped with keystonemiddleware - it
does not have any other dependencies than itself so you can either
install it by copying the file directly in your python path or by
installing keystonemiddleware.</p>
<p>If support is required for unvalidated users (as with anonymous
access) or for formpost/staticweb/tempurl middleware, authtoken will
need to be configured with <code class="docutils literal notranslate"><span class="pre">delay_auth_decision</span></code> set to true.  See
the Keystone documentation for more detail on how to configure the
authtoken middleware.</p>
<p>In proxy-server.conf you will need to have the setting account
auto creation to true:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">app</span><span class="p">:</span><span class="n">proxy</span><span class="o">-</span><span class="n">server</span><span class="p">]</span>
<span class="n">account_autocreate</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
<p>And add a swift authorization filter section, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">filter</span><span class="p">:</span><span class="n">keystoneauth</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#keystoneauth</span>
<span class="n">operator_roles</span> <span class="o">=</span> <span class="n">admin</span><span class="p">,</span> <span class="n">swiftoperator</span>
</pre></div>
</div>
<p>The user who is able to give ACL / create Containers permissions
will be the user with a role listed in the <code class="docutils literal notranslate"><span class="pre">operator_roles</span></code>
setting which by default includes the admin and the swiftoperator
roles.</p>
<p>The keystoneauth middleware maps a Keystone project/tenant to an account
in Swift by adding a prefix (<code class="docutils literal notranslate"><span class="pre">AUTH_</span></code> by default) to the tenant/project
id.. For example, if the project id is <code class="docutils literal notranslate"><span class="pre">1234</span></code>, the path is
<code class="docutils literal notranslate"><span class="pre">/v1/AUTH_1234</span></code>.</p>
<p>If you need to have a different reseller_prefix to be able to
mix different auth servers you can configure the option
<code class="docutils literal notranslate"><span class="pre">reseller_prefix</span></code> in your keystoneauth entry like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reseller_prefix</span> <span class="o">=</span> <span class="n">NEWAUTH</span>
</pre></div>
</div>
<p>Don’t forget to also update the Keystone service endpoint configuration to
use NEWAUTH in the path.</p>
<p>It is possible to have several accounts associated with the same project.
This is done by listing several prefixes as shown in the following
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reseller_prefix</span> <span class="o">=</span> <span class="n">AUTH</span><span class="p">,</span> <span class="n">SERVICE</span>
</pre></div>
</div>
<p>This means that for project id ‘1234’, the paths ‘/v1/AUTH_1234’ and
‘/v1/SERVICE_1234’ are associated with the project and are authorized
using roles that a user has with that project. The core use of this feature
is that it is possible to provide different rules for each account
prefix. The following parameters may be prefixed with the appropriate
prefix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">operator_roles</span>
<span class="n">service_roles</span>
</pre></div>
</div>
<p>For backward compatibility, if either of these parameters is specified
without a prefix then it applies to all reseller_prefixes. Here is an
example, using two prefixes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reseller_prefix</span> <span class="o">=</span> <span class="n">AUTH</span><span class="p">,</span> <span class="n">SERVICE</span>
<span class="c1"># The next three lines have identical effects (since the first applies</span>
<span class="c1"># to both prefixes).</span>
<span class="n">operator_roles</span> <span class="o">=</span> <span class="n">admin</span><span class="p">,</span> <span class="n">swiftoperator</span>
<span class="n">AUTH_operator_roles</span> <span class="o">=</span> <span class="n">admin</span><span class="p">,</span> <span class="n">swiftoperator</span>
<span class="n">SERVICE_operator_roles</span> <span class="o">=</span> <span class="n">admin</span><span class="p">,</span> <span class="n">swiftoperator</span>
<span class="c1"># The next line only applies to accounts with the SERVICE prefix</span>
<span class="n">SERVICE_operator_roles</span> <span class="o">=</span> <span class="n">admin</span><span class="p">,</span> <span class="n">some_other_role</span>
</pre></div>
</div>
<p>X-Service-Token tokens are supported by the inclusion of the service_roles
configuration option. When present, this option requires that the
X-Service-Token header supply a token from a user who has a role listed
in service_roles. Here is an example configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reseller_prefix</span> <span class="o">=</span> <span class="n">AUTH</span><span class="p">,</span> <span class="n">SERVICE</span>
<span class="n">AUTH_operator_roles</span> <span class="o">=</span> <span class="n">admin</span><span class="p">,</span> <span class="n">swiftoperator</span>
<span class="n">SERVICE_operator_roles</span> <span class="o">=</span> <span class="n">admin</span><span class="p">,</span> <span class="n">swiftoperator</span>
<span class="n">SERVICE_service_roles</span> <span class="o">=</span> <span class="n">service</span>
</pre></div>
</div>
<p>The keystoneauth middleware supports cross-tenant access control using the
syntax <code class="docutils literal notranslate"><span class="pre">&lt;tenant&gt;:&lt;user&gt;</span></code> to specify a grantee in container Access Control
Lists (ACLs). For a request to be granted by an ACL, the grantee
<code class="docutils literal notranslate"><span class="pre">&lt;tenant&gt;</span></code> must match the UUID of the tenant to which the request
X-Auth-Token is scoped and the grantee <code class="docutils literal notranslate"><span class="pre">&lt;user&gt;</span></code> must match the UUID of
the user authenticated by that token.</p>
<p>Note that names must no longer be used in cross-tenant ACLs because with
the introduction of domains in keystone names are no longer globally
unique.</p>
<p>For backwards compatibility, ACLs using names will be granted by
keystoneauth when it can be established that the grantee tenant,
the grantee user and the tenant being accessed are either not yet in a
domain (e.g. the X-Auth-Token has been obtained via the keystone v2
API) or are all in the default domain to which legacy accounts would
have been migrated. The default domain is identified by its UUID,
which by default has the value <code class="docutils literal notranslate"><span class="pre">default</span></code>. This can be changed by
setting the <code class="docutils literal notranslate"><span class="pre">default_domain_id</span></code> option in the keystoneauth
configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">default_domain_id</span> <span class="o">=</span> <span class="n">default</span>
</pre></div>
</div>
<p>The backwards compatible behavior can be disabled by setting the config
option <code class="docutils literal notranslate"><span class="pre">allow_names_in_acls</span></code> to false:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">allow_names_in_acls</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
<p>To enable this backwards compatibility, keystoneauth will attempt to
determine the domain id of a tenant when any new account is created,
and persist this as account metadata. If an account is created for a tenant
using a token with reselleradmin role that is not scoped on that tenant,
keystoneauth is unable to determine the domain id of the tenant;
keystoneauth will assume that the tenant may not be in the default domain
and therefore not match names in ACLs for that account.</p>
<p>By default, middleware higher in the WSGI pipeline may override auth
processing, useful for middleware such as tempurl and formpost. If you know
you’re not going to use such middleware and you want a bit of extra
security you can disable this behaviour by setting the <code class="docutils literal notranslate"><span class="pre">allow_overrides</span></code>
option to <code class="docutils literal notranslate"><span class="pre">false</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">allow_overrides</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> – The next WSGI app in the pipeline</p></li>
<li><p><strong>conf</strong> – The dict of configuration values</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.keystoneauth.KeystoneAuth.authorize_anonymous">
<span class="sig-name descname"><span class="pre">authorize_anonymous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.keystoneauth.KeystoneAuth.authorize_anonymous" title="Permalink to this definition">¶</a></dt>
<dd><p>Authorize an anonymous request.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None if authorization is granted, an error page otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.keystoneauth.KeystoneAuth.denied_response">
<span class="sig-name descname"><span class="pre">denied_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.keystoneauth.KeystoneAuth.denied_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Deny WSGI Response.</p>
<p>Returns a standard WSGI response callable with the status of 403 or 401
depending on whether the REMOTE_USER is set or not.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.keystoneauth.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.keystoneauth.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.keystoneauth.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a WSGI filter app for use with paste.deploy.</p>
</dd></dl>

</section>
<section id="module-swift.common.middleware.list_endpoints">
<span id="id11"></span><span id="list-endpoints"></span><h2>List Endpoints<a class="headerlink" href="#module-swift.common.middleware.list_endpoints" title="Permalink to this heading">¶</a></h2>
<p>List endpoints for an object, account or container.</p>
<p>This middleware makes it possible to integrate swift with software
that relies on data locality information to avoid network overhead,
such as Hadoop.</p>
<p>Using the original API, answers requests of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">endpoints</span><span class="o">/</span><span class="p">{</span><span class="n">account</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">container</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="nb">object</span><span class="p">}</span>
<span class="o">/</span><span class="n">endpoints</span><span class="o">/</span><span class="p">{</span><span class="n">account</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">container</span><span class="p">}</span>
<span class="o">/</span><span class="n">endpoints</span><span class="o">/</span><span class="p">{</span><span class="n">account</span><span class="p">}</span>
<span class="o">/</span><span class="n">endpoints</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="p">{</span><span class="n">account</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">container</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="nb">object</span><span class="p">}</span>
<span class="o">/</span><span class="n">endpoints</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="p">{</span><span class="n">account</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">container</span><span class="p">}</span>
<span class="o">/</span><span class="n">endpoints</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="p">{</span><span class="n">account</span><span class="p">}</span>
</pre></div>
</div>
<p>with a JSON-encoded list of endpoints of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="p">{</span><span class="n">server</span><span class="p">}:{</span><span class="n">port</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">dev</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">part</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">acc</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">cont</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">obj</span><span class="p">}</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="p">{</span><span class="n">server</span><span class="p">}:{</span><span class="n">port</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">dev</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">part</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">acc</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">cont</span><span class="p">}</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="p">{</span><span class="n">server</span><span class="p">}:{</span><span class="n">port</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">dev</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">part</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">acc</span><span class="p">}</span>
</pre></div>
</div>
<p>correspondingly, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.1.1.1</span><span class="p">:</span><span class="mi">6200</span><span class="o">/</span><span class="n">sda1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">a</span><span class="o">/</span><span class="n">c2</span><span class="o">/</span><span class="n">o1</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.1.1.1</span><span class="p">:</span><span class="mi">6200</span><span class="o">/</span><span class="n">sda1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">a</span><span class="o">/</span><span class="n">c2</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.1.1.1</span><span class="p">:</span><span class="mi">6200</span><span class="o">/</span><span class="n">sda1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">a</span>
</pre></div>
</div>
<p>Using the v2 API, answers requests of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">endpoints</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="p">{</span><span class="n">account</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">container</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="nb">object</span><span class="p">}</span>
<span class="o">/</span><span class="n">endpoints</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="p">{</span><span class="n">account</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">container</span><span class="p">}</span>
<span class="o">/</span><span class="n">endpoints</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="p">{</span><span class="n">account</span><span class="p">}</span>
</pre></div>
</div>
<p>with a JSON-encoded dictionary containing a key ‘endpoints’ that maps to a list
of endpoints having the same form as described above, and a key ‘headers’ that
maps to a dictionary of headers that should be sent with a request made to
the endpoints, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&quot;endpoints&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;http://10.1.1.1:6210/sda1/2/a/c3/o1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;http://10.1.1.1:6230/sda3/2/a/c3/o1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;http://10.1.1.1:6240/sda4/2/a/c3/o1&quot;</span><span class="p">},</span>
  <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;X-Backend-Storage-Policy-Index&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}}</span>
</pre></div>
</div>
<p>In this example, the ‘headers’ dictionary indicates that requests to the
endpoint URLs should include the header ‘X-Backend-Storage-Policy-Index: 1’
because the object’s container is using storage policy index 1.</p>
<p>The ‘/endpoints/’ path is customizable (‘list_endpoints_path’
configuration parameter).</p>
<p>Intended for consumption by third-party services living inside the
cluster (as the endpoints make sense only inside the cluster behind
the firewall); potentially written in a different language.</p>
<p>This is why it’s provided as a REST API and not just a Python API:
to avoid requiring clients to write their own ring parsers in their
languages, and to avoid the necessity to distribute the ring file
to clients and keep it up-to-date.</p>
<p>Note that the call is not authenticated, which means that a proxy
with this middleware enabled should not be open to an untrusted
environment (everyone can query the locality data using this middleware).</p>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.list_endpoints.ListEndpointsMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.list_endpoints.</span></span><span class="sig-name descname"><span class="pre">ListEndpointsMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.list_endpoints.ListEndpointsMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>List endpoints for an object, account or container.</p>
<p>See above for a full description.</p>
<p>Uses configuration parameter <cite>swift_dir</cite> (default <cite>/etc/swift</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> – The next WSGI filter or app in the paste.deploy
chain.</p></li>
<li><p><strong>conf</strong> – The configuration dict for the middleware.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.list_endpoints.ListEndpointsMiddleware.get_object_ring">
<span class="sig-name descname"><span class="pre">get_object_ring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.list_endpoints.ListEndpointsMiddleware.get_object_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ring object to use to handle a request based on its policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Policy_idx<span class="colon">:</span></dt>
<dd class="field-odd"><p>policy index as defined in swift.conf</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>appropriate ring object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-swift.common.middleware.memcache">
<span id="memcache"></span><h2>Memcache<a class="headerlink" href="#module-swift.common.middleware.memcache" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.memcache.MemcacheMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.memcache.</span></span><span class="sig-name descname"><span class="pre">MemcacheMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.memcache.MemcacheMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Caching middleware that manages caching in swift.</p>
</dd></dl>

</section>
<section id="module-swift.common.middleware.name_check">
<span id="name-check-forbidden-character-filter"></span><h2>Name Check (Forbidden Character Filter)<a class="headerlink" href="#module-swift.common.middleware.name_check" title="Permalink to this heading">¶</a></h2>
<p>Created on February 27, 2012</p>
<p>A filter that disallows any paths that contain defined forbidden characters or
that exceed a defined length.</p>
<p>Place early in the proxy-server pipeline after the left-most occurrence of the
<code class="docutils literal notranslate"><span class="pre">proxy-logging</span></code> middleware (if present) and before the final
<code class="docutils literal notranslate"><span class="pre">proxy-logging</span></code> middleware (if present) or the <code class="docutils literal notranslate"><span class="pre">proxy-serer</span></code> app itself,
e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">pipeline</span><span class="p">:</span><span class="n">main</span><span class="p">]</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">catch_errors</span> <span class="n">healthcheck</span> <span class="n">proxy</span><span class="o">-</span><span class="n">logging</span> <span class="n">name_check</span> <span class="n">cache</span> <span class="n">ratelimit</span> <span class="n">tempauth</span> <span class="n">sos</span> <span class="n">proxy</span><span class="o">-</span><span class="n">logging</span> <span class="n">proxy</span><span class="o">-</span><span class="n">server</span>

<span class="p">[</span><span class="nb">filter</span><span class="p">:</span><span class="n">name_check</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#name_check</span>
<span class="n">forbidden_chars</span> <span class="o">=</span> <span class="s1">&#39;&quot;`&lt;&gt;</span>
<span class="n">maximum_length</span> <span class="o">=</span> <span class="mi">255</span>
</pre></div>
</div>
<p>There are default settings for forbidden_chars (FORBIDDEN_CHARS) and
maximum_length (MAX_LENGTH)</p>
<p>The filter returns HTTPBadRequest if path is invalid.</p>
<p>&#64;author: eamonn-otoole</p>
</section>
<section id="module-swift.common.middleware.versioned_writes.object_versioning">
<span id="id12"></span><span id="object-versioning"></span><h2>Object Versioning<a class="headerlink" href="#module-swift.common.middleware.versioned_writes.object_versioning" title="Permalink to this heading">¶</a></h2>
<p>Object versioning in Swift has 3 different modes. There are two
<a class="reference internal" href="#versioned-writes"><span class="std std-ref">legacy modes</span></a> that have similar API with a slight
difference in behavior and this middleware introduces a new mode with a
completely redesigned API and implementation.</p>
<p>In terms of the implementation, this middleware relies heavily on the use of
static links to reduce the amount of backend data movement that was part of the
two legacy modes. It also introduces a new API for enabling the feature and to
interact with older versions of an object.</p>
<section id="compatibility-between-modes">
<h3>Compatibility between modes<a class="headerlink" href="#compatibility-between-modes" title="Permalink to this heading">¶</a></h3>
<p>This new mode is not backwards compatible or interchangeable with the
two legacy modes. This means that existing containers that are being versioned
by the two legacy modes cannot enable the new mode. The new mode can only be
enabled on a new container or a container without either
<code class="docutils literal notranslate"><span class="pre">X-Versions-Location</span></code> or <code class="docutils literal notranslate"><span class="pre">X-History-Location</span></code> header set. Attempting to
enable the new mode on a container with either header will result in a
<code class="docutils literal notranslate"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></code> response.</p>
</section>
<section id="enable-object-versioning-in-a-container">
<h3>Enable Object Versioning in a Container<a class="headerlink" href="#enable-object-versioning-in-a-container" title="Permalink to this heading">¶</a></h3>
<p>After the introduction of this feature containers in a Swift cluster will be
in one of either 3 possible states: 1. Object versioning never enabled,
2. Object Versioning Enabled or 3. Object Versioning Disabled. Once versioning
has been enabled on a container, it will always have a flag stating whether it
is either enabled or disabled.</p>
<p>Clients enable object versioning on a container by performing either a PUT or
POST request with the header <code class="docutils literal notranslate"><span class="pre">X-Versions-Enabled:</span> <span class="pre">true</span></code>. Upon enabling the
versioning for the first time, the middleware will create a hidden container
where object versions are stored. This hidden container will inherit the same
Storage Policy as its parent container.</p>
<p>To disable, clients send a POST request with the header
<code class="docutils literal notranslate"><span class="pre">X-Versions-Enabled:</span> <span class="pre">false</span></code>. When versioning is disabled, the old versions
remain unchanged.</p>
<p>To delete a versioned container, versioning must be disabled and all versions
of all objects must be deleted before the container can be deleted. At such
time, the hidden container will also be deleted.</p>
</section>
<section id="object-crud-operations-to-a-versioned-container">
<h3>Object CRUD Operations to a Versioned Container<a class="headerlink" href="#object-crud-operations-to-a-versioned-container" title="Permalink to this heading">¶</a></h3>
<p>When data is <code class="docutils literal notranslate"><span class="pre">PUT</span></code> into a versioned container (a container with the
versioning flag enabled), the actual object is written to a hidden container
and a symlink object is written to the parent container. Every object is
assigned a version id. This id can be retrieved from the
<code class="docutils literal notranslate"><span class="pre">X-Object-Version-Id</span></code> header in the PUT response.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When object versioning is disabled on a container, new data will no longer
be versioned, but older versions remain untouched. Any new data <code class="docutils literal notranslate"><span class="pre">PUT</span></code>
will result in a object with a <code class="docutils literal notranslate"><span class="pre">null</span></code> version-id. The versioning API can
be used to both list and operate on previous versions even while versioning
is disabled.</p>
<p>If versioning is re-enabled and an overwrite occurs on a <cite>null</cite> id object.
The object will be versioned off with a regular version-id.</p>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">GET</span></code> to a versioned object will return the current version of the object.
The <code class="docutils literal notranslate"><span class="pre">X-Object-Version-Id</span></code> header is also returned in the response.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">POST</span></code> to a versioned object will update the most current object metadata
as normal, but will not create a new version of the object. In other words,
new versions are only created when the content of the object changes.</p>
<p>On <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, the middleware will write a zero-byte “delete marker” object
version that notes <strong>when</strong> the delete took place. The symlink object will also
be deleted from the versioned container. The object will no longer appear in
container listings for the versioned container and future requests there will
return <code class="docutils literal notranslate"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code>. However, the previous versions content will still be
recoverable.</p>
</section>
<section id="object-versioning-api">
<h3>Object Versioning API<a class="headerlink" href="#object-versioning-api" title="Permalink to this heading">¶</a></h3>
<p>Clients can now operate on previous versions of an object using this new
versioning API.</p>
<p>First to list previous versions, issue a a <code class="docutils literal notranslate"><span class="pre">GET</span></code> request to the versioned
container with query parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>?versions
</pre></div>
</div>
<p>To list a container with a large number of object versions, clients can
also use the <code class="docutils literal notranslate"><span class="pre">version_marker</span></code> parameter together with the <code class="docutils literal notranslate"><span class="pre">marker</span></code>
parameter.  While the <code class="docutils literal notranslate"><span class="pre">marker</span></code> parameter is used to specify an object name
the <code class="docutils literal notranslate"><span class="pre">version_marker</span></code> will be used specify the version id.</p>
<p>All other pagination parameters can be used in conjunction with the
<code class="docutils literal notranslate"><span class="pre">versions</span></code> parameter.</p>
<p>During container listings, delete markers can be identified with the
content-type <code class="docutils literal notranslate"><span class="pre">application/x-deleted;swift_versions_deleted=1</span></code>. The most
current version of an object can be identified by the field <code class="docutils literal notranslate"><span class="pre">is_latest</span></code>.</p>
<p>To operate on previous versions, clients can use the query parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>?version-id=&lt;id&gt;
</pre></div>
</div>
<p>where the <code class="docutils literal notranslate"><span class="pre">&lt;id&gt;</span></code> is the value from the <code class="docutils literal notranslate"><span class="pre">X-Object-Version-Id</span></code> header.</p>
<p>Only COPY, HEAD, GET and DELETE operations can be performed on previous
versions. Either a PUT or POST request with a <code class="docutils literal notranslate"><span class="pre">version-id</span></code> parameter will
result in a <code class="docutils literal notranslate"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></code> response.</p>
<p>A HEAD/GET request to a delete-marker will result in a <code class="docutils literal notranslate"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code>
response.</p>
<p>When issuing DELETE requests with a <code class="docutils literal notranslate"><span class="pre">version-id</span></code> parameter, delete markers
are not written down. A DELETE request with a <code class="docutils literal notranslate"><span class="pre">version-id</span></code> parameter to
the current object will result in a both the symlink and the backing data
being deleted. A DELETE to any other version will result in that version only
be deleted and no changes made to the symlink pointing to the current version.</p>
</section>
<section id="how-to-enable-object-versioning-in-a-swift-cluster">
<h3>How to Enable Object Versioning in a Swift Cluster<a class="headerlink" href="#how-to-enable-object-versioning-in-a-swift-cluster" title="Permalink to this heading">¶</a></h3>
<p>To enable this new mode in a Swift cluster the <code class="docutils literal notranslate"><span class="pre">versioned_writes</span></code> and
<code class="docutils literal notranslate"><span class="pre">symlink</span></code> middlewares must be added to the proxy pipeline, you must also set
the option <code class="docutils literal notranslate"><span class="pre">allow_object_versioning</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.AccountContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.versioned_writes.object_versioning.</span></span><span class="sig-name descname"><span class="pre">AccountContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wsgi_app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.AccountContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectVersioningContext" title="swift.common.middleware.versioned_writes.object_versioning.ObjectVersioningContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectVersioningContext</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ByteCountingReader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.versioned_writes.object_versioning.</span></span><span class="sig-name descname"><span class="pre">ByteCountingReader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_like</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ByteCountingReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Counts bytes read from file_like so we know how big the object is that
the client just PUT.</p>
<p>This is particularly important when the client sends a chunk-encoded body,
so we don’t have a Content-Length header available.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ContainerContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.versioned_writes.object_versioning.</span></span><span class="sig-name descname"><span class="pre">ContainerContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wsgi_app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ContainerContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectVersioningContext" title="swift.common.middleware.versioned_writes.object_versioning.ObjectVersioningContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectVersioningContext</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ContainerContext.handle_delete">
<span class="sig-name descname"><span class="pre">handle_delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ContainerContext.handle_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle request to delete a user’s container.</p>
<p>As part of deleting a container, this middleware will also delete
the hidden container holding object versions.</p>
<p>Before a user’s container can be deleted, swift must check
if there are still old object versions from that container.
Only after disabling versioning and deleting <em>all</em> object versions
can a container be deleted.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ContainerContext.handle_request">
<span class="sig-name descname"><span class="pre">handle_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ContainerContext.handle_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle request for container resource.</p>
<p>On PUT, POST set version location and enabled flag sysmeta.
For container listings of a versioned container, update the object’s
bytes and etag to use the target’s instead of using the symlink info.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ObjectContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.versioned_writes.object_versioning.</span></span><span class="sig-name descname"><span class="pre">ObjectContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wsgi_app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectVersioningContext" title="swift.common.middleware.versioned_writes.object_versioning.ObjectVersioningContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectVersioningContext</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_delete">
<span class="sig-name descname"><span class="pre">handle_delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions_cont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_enabled</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle DELETE requests.</p>
<p>Copy current version of object to versions_container and write a
delete marker before proceeding with original request.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – original request.</p></li>
<li><p><strong>versions_cont</strong> – container where previous versions of the object
are stored.</p></li>
<li><p><strong>api_version</strong> – api version.</p></li>
<li><p><strong>account_name</strong> – account name.</p></li>
<li><p><strong>object_name</strong> – name of object of original request</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_post">
<span class="sig-name descname"><span class="pre">handle_post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions_cont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a POST request to an object in a versioned container.</p>
<p>If the response is a 307 because the POST went to a symlink,
follow the symlink and send the request to the versioned object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – original request.</p></li>
<li><p><strong>versions_cont</strong> – container where previous versions of the object
are stored.</p></li>
<li><p><strong>account</strong> – account name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_put">
<span class="sig-name descname"><span class="pre">handle_put</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions_cont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_enabled</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_put" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the current version of the object is a versions-symlink
if not, it’s because this object was added to the container when
versioning was not enabled. We’ll need to copy it into the versions
containers now that versioning is enabled.</p>
<p>Also, put the new data from the client into the versions container
and add a static symlink in the versioned container.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – original request.</p></li>
<li><p><strong>versions_cont</strong> – container where previous versions of the object
are stored.</p></li>
<li><p><strong>api_version</strong> – api version.</p></li>
<li><p><strong>account_name</strong> – account name.</p></li>
<li><p><strong>object_name</strong> – name of object of original request</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_put_version">
<span class="sig-name descname"><span class="pre">handle_put_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions_cont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_enabled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_put_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a PUT?version-id request and create/update the is_latest link to
point to the specific version. Expects a valid ‘version’ id.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_versioned_request">
<span class="sig-name descname"><span class="pre">handle_versioned_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions_cont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_enabled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_versioned_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle ‘version-id’ request for object resource. When a request
contains a <code class="docutils literal notranslate"><span class="pre">version-id=&lt;id&gt;</span></code> parameter, the request is acted upon
the actual version of that object. Version-aware operations
require that the container is versioned, but do not require that
the versioning is currently enabled. Users should be able to
operate on older versions of an object even if versioning is
currently suspended.</p>
<p>PUT and POST requests are not allowed as that would overwrite
the contents of the versioned object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – The original request</p></li>
<li><p><strong>versions_cont</strong> – container holding versions of the requested obj</p></li>
<li><p><strong>api_version</strong> – should be v1 unless swift bumps api version</p></li>
<li><p><strong>account</strong> – account name string</p></li>
<li><p><strong>container</strong> – container name string</p></li>
<li><p><strong>object</strong> – object name string</p></li>
<li><p><strong>is_enabled</strong> – is versioning currently enabled</p></li>
<li><p><strong>version</strong> – version of the object to act on</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.object_versioning.ObjectVersioningContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.versioned_writes.object_versioning.</span></span><span class="sig-name descname"><span class="pre">ObjectVersioningContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wsgi_app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectVersioningContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.wsgi.WSGIContext" title="swift.common.wsgi.WSGIContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIContext</span></code></a></p>
</dd></dl>

</section>
<section id="module-swift.common.middleware.proxy_logging">
<span id="proxy-logging"></span><h2>Proxy Logging<a class="headerlink" href="#module-swift.common.middleware.proxy_logging" title="Permalink to this heading">¶</a></h2>
<p>Logging middleware for the Swift proxy.</p>
<p>This serves as both the default logging implementation and an example of how
to plug in your own logging format/method.</p>
<p>The logging format implemented below is as follows:</p>
<dl class="simple">
<dt>client_ip remote_addr end_time.datetime method path protocol</dt><dd><p>status_int referer user_agent auth_token bytes_recvd bytes_sent
client_etag transaction_id headers request_time source log_info
start_time end_time policy_index</p>
</dd>
</dl>
<p>These values are space-separated, and each is url-encoded, so that they can
be separated with a simple .split()</p>
<ul class="simple">
<li><p>remote_addr is the contents of the REMOTE_ADDR environment variable, while
client_ip is swift’s best guess at the end-user IP, extracted variously
from the X-Forwarded-For header, X-Cluster-Ip header, or the REMOTE_ADDR
environment variable.</p></li>
<li><p>source (swift.source in the WSGI environment) indicates the code
that generated the request, such as most middleware. (See below for
more detail.)</p></li>
<li><p>log_info (swift.log_info in the WSGI environment) is for additional
information that could prove quite useful, such as any x-delete-at
value or other “behind the scenes” activity that might not
otherwise be detectable from the plain log information. Code that
wishes to add additional log information should use code like
<code class="docutils literal notranslate"><span class="pre">env.setdefault('swift.log_info',</span> <span class="pre">[]).append(your_info)</span></code> so as to
not disturb others’ log information.</p></li>
<li><p>Values that are missing (e.g. due to a header not being present) or zero
are generally represented by a single hyphen (‘-‘).</p></li>
</ul>
<p>The proxy-logging can be used twice in the proxy server’s pipeline when there
is middleware installed that can return custom responses that don’t follow the
standard pipeline to the proxy server.</p>
<p>For example, with staticweb, the middleware might intercept a request to
/v1/AUTH_acc/cont/, make a subrequest to the proxy to retrieve
/v1/AUTH_acc/cont/index.html and, in effect, respond to the client’s original
request using the 2nd request’s body. In this instance the subrequest will be
logged by the rightmost middleware (with a swift.source set) and the outgoing
request (with body overridden) will be logged by leftmost middleware.</p>
<p>Requests that follow the normal pipeline (use the same wsgi environment
throughout) will not be double logged because an environment variable
(swift.proxy_access_log_made) is checked/set when a log is made.</p>
<p>All middleware making subrequests should take care to set swift.source when
needed. With the doubled proxy logs, any consumer/processor of swift’s proxy
logs should look at the swift.source field, the rightmost log value, to decide
if this is a middleware subrequest or not. A log processor calculating
bandwidth usage will want to only sum up logs with no swift.source.</p>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.proxy_logging.ProxyLoggingMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.proxy_logging.</span></span><span class="sig-name descname"><span class="pre">ProxyLoggingMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.proxy_logging.ProxyLoggingMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Middleware that logs Swift proxy requests in the swift log format.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.proxy_logging.ProxyLoggingMiddleware.log_request">
<span class="sig-name descname"><span class="pre">log_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status_int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bytes_received</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bytes_sent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resp_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ttfb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wire_status_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.proxy_logging.ProxyLoggingMiddleware.log_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Log a request.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – swob.Request object for the request</p></li>
<li><p><strong>status_int</strong> – integer code for the response status</p></li>
<li><p><strong>bytes_received</strong> – bytes successfully read from the request body</p></li>
<li><p><strong>bytes_sent</strong> – bytes yielded to the WSGI server</p></li>
<li><p><strong>start_time</strong> – timestamp request started</p></li>
<li><p><strong>end_time</strong> – timestamp request completed</p></li>
<li><p><strong>resp_headers</strong> – dict of the response headers</p></li>
<li><p><strong>wire_status_int</strong> – the on the wire status int</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-swift.common.middleware.ratelimit">
<span id="ratelimit"></span><h2>Ratelimit<a class="headerlink" href="#module-swift.common.middleware.ratelimit" title="Permalink to this heading">¶</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="swift.common.middleware.ratelimit.MaxSleepTimeHitError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.ratelimit.</span></span><span class="sig-name descname"><span class="pre">MaxSleepTimeHitError</span></span><a class="headerlink" href="#swift.common.middleware.ratelimit.MaxSleepTimeHitError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.ratelimit.RateLimitMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.ratelimit.</span></span><span class="sig-name descname"><span class="pre">RateLimitMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.ratelimit.RateLimitMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Rate limiting middleware</p>
<p>Rate limits requests on both an Account and Container level.  Limits are
configurable.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.ratelimit.RateLimitMiddleware.get_ratelimitable_key_tuples">
<span class="sig-name descname"><span class="pre">get_ratelimitable_key_tuples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_ratelimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.ratelimit.RateLimitMiddleware.get_ratelimitable_key_tuples" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of key (used in memcache), ratelimit tuples. Keys
should be checked in order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – swob request</p></li>
<li><p><strong>account_name</strong> – account name from path</p></li>
<li><p><strong>container_name</strong> – container name from path</p></li>
<li><p><strong>obj_name</strong> – object name from path</p></li>
<li><p><strong>global_ratelimit</strong> – this account has an account wide
ratelimit on all writes combined</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.ratelimit.RateLimitMiddleware.handle_ratelimit">
<span class="sig-name descname"><span class="pre">handle_ratelimit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.ratelimit.RateLimitMiddleware.handle_ratelimit" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs rate limiting and account white/black listing.  Sleeps
if necessary. If self.memcache_client is not set, immediately returns
None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>account_name</strong> – account name from path</p></li>
<li><p><strong>container_name</strong> – container name from path</p></li>
<li><p><strong>obj_name</strong> – object name from path</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.ratelimit.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.ratelimit.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.ratelimit.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>paste.deploy app factory for creating WSGI proxy apps.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.ratelimit.get_maxrate">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.ratelimit.</span></span><span class="sig-name descname"><span class="pre">get_maxrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ratelimits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.ratelimit.get_maxrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns number of requests allowed per second for given size.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.ratelimit.interpret_conf_limits">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.ratelimit.</span></span><span class="sig-name descname"><span class="pre">interpret_conf_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.ratelimit.interpret_conf_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses general parms for rate limits looking for things that
start with the provided name_prefix within the provided conf
and returns lists for both internal use and for /info</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conf</strong> – conf dict to parse</p></li>
<li><p><strong>name_prefix</strong> – prefix of config parms to look for</p></li>
<li><p><strong>info</strong> – set to return extra stuff for /info registration</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-swift.common.middleware.read_only">
<span id="id13"></span><span id="read-only"></span><h2>Read Only<a class="headerlink" href="#module-swift.common.middleware.read_only" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.read_only.ReadOnlyMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.read_only.</span></span><span class="sig-name descname"><span class="pre">ReadOnlyMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.read_only.ReadOnlyMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Middleware that make an entire cluster or individual accounts read only.</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.read_only.ReadOnlyMiddleware.account_read_only">
<span class="sig-name descname"><span class="pre">account_read_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.read_only.ReadOnlyMiddleware.account_read_only" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether an account should be read-only.</p>
<p>This considers both the cluster-wide config value as well as the
per-account override in X-Account-Sysmeta-Read-Only.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.read_only.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.read_only.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.read_only.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>paste.deploy app factory for creating WSGI proxy apps.</p>
</dd></dl>

</section>
<section id="recon">
<span id="id14"></span><h2>Recon<a class="headerlink" href="#recon" title="Permalink to this heading">¶</a></h2>
<span class="target" id="module-swift.common.middleware.recon"></span><dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.recon.</span></span><span class="sig-name descname"><span class="pre">ReconMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Recon middleware used for monitoring.</p>
<p>/recon/load|mem|async… will return various system metrics.</p>
<p>Needs to be added to the pipeline and requires a filter
declaration in the [account|container|object]-server conf file:</p>
<p>[filter:recon]
use = egg:swift#recon
recon_cache_path = /var/cache/swift</p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_async_info">
<span class="sig-name descname"><span class="pre">get_async_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_async_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get # of async pendings</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_auditor_info">
<span class="sig-name descname"><span class="pre">get_auditor_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_auditor_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get auditor info</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_device_info">
<span class="sig-name descname"><span class="pre">get_device_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_device_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get devices</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_diskusage">
<span class="sig-name descname"><span class="pre">get_diskusage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_diskusage" title="Permalink to this definition">¶</a></dt>
<dd><p>get disk utilization statistics</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_driveaudit_error">
<span class="sig-name descname"><span class="pre">get_driveaudit_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_driveaudit_error" title="Permalink to this definition">¶</a></dt>
<dd><p>get # of drive audit errors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_expirer_info">
<span class="sig-name descname"><span class="pre">get_expirer_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_expirer_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get expirer info</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_load">
<span class="sig-name descname"><span class="pre">get_load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">openr=&lt;built-in</span> <span class="pre">function</span> <span class="pre">open&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_load" title="Permalink to this definition">¶</a></dt>
<dd><p>get info from /proc/loadavg</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_mem">
<span class="sig-name descname"><span class="pre">get_mem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">openr=&lt;built-in</span> <span class="pre">function</span> <span class="pre">open&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_mem" title="Permalink to this definition">¶</a></dt>
<dd><p>get info from /proc/meminfo</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_mounted">
<span class="sig-name descname"><span class="pre">get_mounted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">openr=&lt;built-in</span> <span class="pre">function</span> <span class="pre">open&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_mounted" title="Permalink to this definition">¶</a></dt>
<dd><p>get ALL mounted fs from /proc/mounts</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_quarantine_count">
<span class="sig-name descname"><span class="pre">get_quarantine_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_quarantine_count" title="Permalink to this definition">¶</a></dt>
<dd><p>get obj/container/account quarantine counts</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_reconstruction_info">
<span class="sig-name descname"><span class="pre">get_reconstruction_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_reconstruction_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get reconstruction info</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_relinker_info">
<span class="sig-name descname"><span class="pre">get_relinker_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_relinker_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get relinker info, if any</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_replication_info">
<span class="sig-name descname"><span class="pre">get_replication_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_replication_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get replication info</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_ring_md5">
<span class="sig-name descname"><span class="pre">get_ring_md5</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_ring_md5" title="Permalink to this definition">¶</a></dt>
<dd><p>get all ring md5sum’s</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_sharding_info">
<span class="sig-name descname"><span class="pre">get_sharding_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_sharding_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get sharding info</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_socket_info">
<span class="sig-name descname"><span class="pre">get_socket_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">openr=&lt;built-in</span> <span class="pre">function</span> <span class="pre">open&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_socket_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get info from /proc/net/sockstat and sockstat6</p>
<p>Note: The mem value is actually kernel pages, but we return bytes
allocated based on the systems page size.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_swift_conf_md5">
<span class="sig-name descname"><span class="pre">get_swift_conf_md5</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_swift_conf_md5" title="Permalink to this definition">¶</a></dt>
<dd><p>get md5 of swift.conf</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_time">
<span class="sig-name descname"><span class="pre">get_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_time" title="Permalink to this definition">¶</a></dt>
<dd><p>get current time</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_unmounted">
<span class="sig-name descname"><span class="pre">get_unmounted</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_unmounted" title="Permalink to this definition">¶</a></dt>
<dd><p>list unmounted (failed?) devices</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_updater_info">
<span class="sig-name descname"><span class="pre">get_updater_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_updater_info" title="Permalink to this definition">¶</a></dt>
<dd><p>get updater info</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.recon.ReconMiddleware.get_version">
<span class="sig-name descname"><span class="pre">get_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.recon.ReconMiddleware.get_version" title="Permalink to this definition">¶</a></dt>
<dd><p>get swift version</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-swift.common.middleware.copy">
<span id="server-side-copy"></span><span id="copy"></span><h2>Server Side Copy<a class="headerlink" href="#module-swift.common.middleware.copy" title="Permalink to this heading">¶</a></h2>
<p>Server side copy is a feature that enables users/clients to COPY objects
between accounts and containers without the need to download and then
re-upload objects, thus eliminating additional bandwidth consumption and
also saving time. This may be used when renaming/moving an object which
in Swift is a (COPY + DELETE) operation.</p>
<p>The server side copy middleware should be inserted in the pipeline after auth
and before the quotas and large object middlewares. If it is not present in the
pipeline in the proxy-server configuration file, it will be inserted
automatically. There is no configurable option provided to turn off server
side copy.</p>
<section id="metadata">
<h3>Metadata<a class="headerlink" href="#metadata" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>All metadata of source object is preserved during object copy.</p></li>
<li><p>One can also provide additional metadata during PUT/COPY request. This will
over-write any existing conflicting keys.</p></li>
<li><p>Server side copy can also be used to change content-type of an existing
object.</p></li>
</ul>
</section>
<section id="object-copy">
<h3>Object Copy<a class="headerlink" href="#object-copy" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>The destination container must exist before requesting copy of the object.</p></li>
<li><p>When several replicas exist, the system copies from the most recent replica.
That is, the copy operation behaves as though the X-Newest header is in the
request.</p></li>
<li><p>The request to copy an object should have no body (i.e. content-length of the
request must be zero).</p></li>
</ul>
<p>There are two ways in which an object can be copied:</p>
<ol class="arabic">
<li><p>Send a PUT request to the new object (destination/target) with an additional
header named <code class="docutils literal notranslate"><span class="pre">X-Copy-From</span></code> specifying the source object
(in ‘/container/object’ format). Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container1</span><span class="o">/</span><span class="n">destination_obj</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Auth-Token: &lt;token&gt;&#39;</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Copy-From: /container2/source_obj&#39;</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;Content-Length: 0&#39;</span>
</pre></div>
</div>
</li>
<li><p>Send a COPY request with an existing object in URL with an additional header
named <code class="docutils literal notranslate"><span class="pre">Destination</span></code> specifying the destination/target object
(in ‘/container/object’ format). Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">X</span> <span class="n">COPY</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container2</span><span class="o">/</span><span class="n">source_obj</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Auth-Token: &lt;token&gt;&#39;</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;Destination: /container1/destination_obj&#39;</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;Content-Length: 0&#39;</span>
</pre></div>
</div>
</li>
</ol>
<p>Note that if the incoming request has some conditional headers (e.g. <code class="docutils literal notranslate"><span class="pre">Range</span></code>,
<code class="docutils literal notranslate"><span class="pre">If-Match</span></code>), the <em>source</em> object will be evaluated for these headers (i.e. if
PUT with both <code class="docutils literal notranslate"><span class="pre">X-Copy-From</span></code> and <code class="docutils literal notranslate"><span class="pre">Range</span></code>, Swift will make a partial copy to
the destination object).</p>
</section>
<section id="cross-account-object-copy">
<h3>Cross Account Object Copy<a class="headerlink" href="#cross-account-object-copy" title="Permalink to this heading">¶</a></h3>
<p>Objects can also be copied from one account to another account if the user
has the necessary permissions (i.e. permission to read from container
in source account and permission to write to container in destination account).</p>
<p>Similar to examples mentioned above, there are two ways to copy objects across
accounts:</p>
<ol class="arabic">
<li><p>Like the example above, send PUT request to copy object but with an
additional header named <code class="docutils literal notranslate"><span class="pre">X-Copy-From-Account</span></code> specifying the source
account. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">host</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;/</span><span class="n">v1</span><span class="o">/</span><span class="n">AUTH_test1</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="n">destination_obj</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Auth-Token: &lt;token&gt;&#39;</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Copy-From: /container/source_obj&#39;</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Copy-From-Account: AUTH_test2&#39;</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;Content-Length: 0&#39;</span>
</pre></div>
</div>
</li>
<li><p>Like the previous example, send a COPY request but with an additional header
named <code class="docutils literal notranslate"><span class="pre">Destination-Account</span></code> specifying the name of destination account.
Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">X</span> <span class="n">COPY</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">host</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;/</span><span class="n">v1</span><span class="o">/</span><span class="n">AUTH_test2</span><span class="o">/</span><span class="n">container</span><span class="o">/</span><span class="n">source_obj</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;X-Auth-Token: &lt;token&gt;&#39;</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;Destination: /container/destination_obj&#39;</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;Destination-Account: AUTH_test1&#39;</span>
 <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;Content-Length: 0&#39;</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="large-object-copy">
<h3>Large Object Copy<a class="headerlink" href="#large-object-copy" title="Permalink to this heading">¶</a></h3>
<p>The best option to copy a large object is to copy segments individually.
To copy the manifest object of a large object, add the query parameter to
the copy request:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>?multipart-manifest=get
</pre></div>
</div>
<p>If a request is sent without the query parameter, an attempt will be made to
copy the whole object but will fail if the object size is
greater than 5GB.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.copy.ServerSideCopyWebContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.copy.</span></span><span class="sig-name descname"><span class="pre">ServerSideCopyWebContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.copy.ServerSideCopyWebContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.wsgi.WSGIContext" title="swift.common.wsgi.WSGIContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIContext</span></code></a></p>
</dd></dl>

</section>
<section id="static-large-objects">
<h2>Static Large Objects<a class="headerlink" href="#static-large-objects" title="Permalink to this heading">¶</a></h2>
<p>Please see
the SLO docs for <a class="reference internal" href="overview_large_objects.html#slo-doc"><span class="std std-ref">Static Large Objects</span></a> further details.</p>
</section>
<section id="staticweb">
<span id="id15"></span><h2>StaticWeb<a class="headerlink" href="#staticweb" title="Permalink to this heading">¶</a></h2>
<span class="target" id="module-swift.common.middleware.staticweb"></span><p>This StaticWeb WSGI middleware will serve container data as a static web site
with index file and error file resolution and optional file listings. This mode
is normally only active for anonymous requests. When using keystone for
authentication set <code class="docutils literal notranslate"><span class="pre">delay_auth_decision</span> <span class="pre">=</span> <span class="pre">true</span></code> in the authtoken middleware
configuration in your <code class="docutils literal notranslate"><span class="pre">/etc/swift/proxy-server.conf</span></code> file.  If you want to
use it with authenticated requests, set the <code class="docutils literal notranslate"><span class="pre">X-Web-Mode:</span> <span class="pre">true</span></code> header on the
request.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">staticweb</span></code> filter should be added to the pipeline in your
<code class="docutils literal notranslate"><span class="pre">/etc/swift/proxy-server.conf</span></code> file just after any auth middleware. Also, the
configuration section for the <code class="docutils literal notranslate"><span class="pre">staticweb</span></code> middleware itself needs to be
added. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">DEFAULT</span><span class="p">]</span>
<span class="o">...</span>

<span class="p">[</span><span class="n">pipeline</span><span class="p">:</span><span class="n">main</span><span class="p">]</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">catch_errors</span> <span class="n">healthcheck</span> <span class="n">proxy</span><span class="o">-</span><span class="n">logging</span> <span class="n">cache</span> <span class="n">ratelimit</span> <span class="n">tempauth</span>
           <span class="n">staticweb</span> <span class="n">proxy</span><span class="o">-</span><span class="n">logging</span> <span class="n">proxy</span><span class="o">-</span><span class="n">server</span>

<span class="o">...</span>

<span class="p">[</span><span class="nb">filter</span><span class="p">:</span><span class="n">staticweb</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#staticweb</span>
</pre></div>
</div>
<p>Any publicly readable containers (for example, <code class="docutils literal notranslate"><span class="pre">X-Container-Read:</span> <span class="pre">.r:*</span></code>, see
<a class="reference internal" href="misc.html#acls"><span class="std std-ref">ACLs</span></a> for more information on this) will be checked for
X-Container-Meta-Web-Index and X-Container-Meta-Web-Error header values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">-</span><span class="n">Container</span><span class="o">-</span><span class="n">Meta</span><span class="o">-</span><span class="n">Web</span><span class="o">-</span><span class="n">Index</span>  <span class="o">&lt;</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="o">&gt;</span>
<span class="n">X</span><span class="o">-</span><span class="n">Container</span><span class="o">-</span><span class="n">Meta</span><span class="o">-</span><span class="n">Web</span><span class="o">-</span><span class="n">Error</span>  <span class="o">&lt;</span><span class="n">error</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">suffix</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>If X-Container-Meta-Web-Index is set, any &lt;index.name&gt; files will be served
without having to specify the &lt;index.name&gt; part. For instance, setting
<code class="docutils literal notranslate"><span class="pre">X-Container-Meta-Web-Index:</span> <span class="pre">index.html</span></code> will be able to serve the object
…/pseudo/path/index.html with just …/pseudo/path or …/pseudo/path/</p>
<p>If X-Container-Meta-Web-Error is set, any errors (currently just 401
Unauthorized and 404 Not Found) will instead serve the
…/&lt;status.code&gt;&lt;error.name.suffix&gt; object. For instance, setting
<code class="docutils literal notranslate"><span class="pre">X-Container-Meta-Web-Error:</span> <span class="pre">error.html</span></code> will serve …/404error.html for
requests for paths not found.</p>
<p>For pseudo paths that have no &lt;index.name&gt;, this middleware can serve HTML file
listings if you set the <code class="docutils literal notranslate"><span class="pre">X-Container-Meta-Web-Listings:</span> <span class="pre">true</span></code> metadata item
on the container.</p>
<p>If listings are enabled, the listings can have a custom style sheet by setting
the X-Container-Meta-Web-Listings-CSS header. For instance, setting
<code class="docutils literal notranslate"><span class="pre">X-Container-Meta-Web-Listings-CSS:</span> <span class="pre">listing.css</span></code> will make listings link to
the …/listing.css style sheet. If you “view source” in your browser on a
listing page, you will see the well defined document structure that can be
styled.</p>
<p>By default, the listings will be rendered with a label of
“Listing of /v1/account/container/path”.  This can be altered by
setting a <code class="docutils literal notranslate"><span class="pre">X-Container-Meta-Web-Listings-Label:</span> <span class="pre">&lt;label&gt;</span></code>.  For example,
if the label is set to “example.com”, a label of
“Listing of example.com/path” will be used instead.</p>
<p>The content-type of directory marker objects can be modified by setting
the <code class="docutils literal notranslate"><span class="pre">X-Container-Meta-Web-Directory-Type</span></code> header.  If the header is not set,
application/directory is used by default.  Directory marker objects are
0-byte objects that represent directories to create a simulated hierarchical
structure.</p>
<p>Example usage of this middleware via <code class="docutils literal notranslate"><span class="pre">swift</span></code>:</p>
<blockquote>
<div><p>Make the container publicly readable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="n">post</span> <span class="o">-</span><span class="n">r</span> <span class="s1">&#39;.r:*&#39;</span> <span class="n">container</span>
</pre></div>
</div>
<p>You should be able to get objects directly, but no index.html resolution or
listings.</p>
<p>Set an index file directive:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="n">post</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;web-index:index.html&#39;</span> <span class="n">container</span>
</pre></div>
</div>
<p>You should be able to hit paths that have an index.html without needing to
type the index.html part.</p>
<p>Turn on listings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="n">post</span> <span class="o">-</span><span class="n">r</span> <span class="s1">&#39;.r:*,.rlistings&#39;</span> <span class="n">container</span>
<span class="n">swift</span> <span class="n">post</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;web-listings: true&#39;</span> <span class="n">container</span>
</pre></div>
</div>
<p>Now you should see object listings for paths and pseudo paths that have no
index.html.</p>
<p>Enable a custom listings style sheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="n">post</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;web-listings-css:listings.css&#39;</span> <span class="n">container</span>
</pre></div>
</div>
<p>Set an error file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="n">post</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;web-error:error.html&#39;</span> <span class="n">container</span>
</pre></div>
</div>
<p>Now 401’s should load 401error.html, 404’s should load 404error.html, etc.</p>
<p>Set Content-Type of directory marker object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">swift</span> <span class="n">post</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;web-directory-type:text/directory&#39;</span> <span class="n">container</span>
</pre></div>
</div>
<p>Now 0-byte objects with a content-type of text/directory will be treated
as directories rather than objects.</p>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.staticweb.StaticWeb">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.staticweb.</span></span><span class="sig-name descname"><span class="pre">StaticWeb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.staticweb.StaticWeb" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Static Web WSGI middleware filter; serves container data as a static
web site. See <a class="reference internal" href="#staticweb">staticweb</a> for an overview.</p>
<p>The proxy logs created for any subrequests made will have swift.source set
to “SW”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> – The next WSGI application/filter in the paste.deploy pipeline.</p></li>
<li><p><strong>conf</strong> – The filter configuration dict.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.staticweb.StaticWeb.app">
<span class="sig-name descname"><span class="pre">app</span></span><a class="headerlink" href="#swift.common.middleware.staticweb.StaticWeb.app" title="Permalink to this definition">¶</a></dt>
<dd><p>The next WSGI application/filter in the paste.deploy pipeline.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.staticweb.StaticWeb.conf">
<span class="sig-name descname"><span class="pre">conf</span></span><a class="headerlink" href="#swift.common.middleware.staticweb.StaticWeb.conf" title="Permalink to this definition">¶</a></dt>
<dd><p>The filter configuration dict. Only used in tests.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.staticweb.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.staticweb.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.staticweb.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Static Web WSGI filter for use with paste.deploy.</p>
</dd></dl>

</section>
<section id="symlink">
<span id="id16"></span><h2>Symlink<a class="headerlink" href="#symlink" title="Permalink to this heading">¶</a></h2>
<span class="target" id="module-swift.common.middleware.symlink"></span><p>Symlink Middleware</p>
<p>Symlinks are objects stored in Swift that contain a reference to another
object (hereinafter, this is called “target object”). They are analogous to
symbolic links in Unix-like operating systems. The existence of a symlink
object does not affect the target object in any way. An important use case is
to use a path in one container to access an object in a different container,
with a different policy. This allows policy cost/performance trade-offs to be
made on individual objects.</p>
<p>Clients create a Swift symlink by performing a zero-length PUT request
with the header <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target:</span> <span class="pre">&lt;container&gt;/&lt;object&gt;</span></code>. For a cross-account
symlink, the header <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Account:</span> <span class="pre">&lt;account&gt;</span></code> must be included.
If omitted, it is inserted automatically with the account of the symlink
object in the PUT request process.</p>
<p>Symlinks must be zero-byte objects. Attempting to PUT a symlink with a
non-empty request body will result in a 400-series error. Also, POST with
<code class="docutils literal notranslate"><span class="pre">X-Symlink-Target</span></code> header always results in a 400-series error. The target
object need not exist at symlink creation time.</p>
<p>Clients may optionally include a <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag:</span> <span class="pre">&lt;etag&gt;</span></code> header
during the PUT. If present, this will create a “static symlink” instead of a
“dynamic symlink”.  Static symlinks point to a specific object rather than a
specific name.  They do this by using the value set in their
<code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag</span></code> header when created to verify it still matches the
ETag of the object they’re pointing at on a GET.  In contrast to a dynamic
symlink the target object referenced in the <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target</span></code> header must
exist and its ETag must match the <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag</span></code> or the symlink
creation will return a client error.</p>
<p>A GET/HEAD request to a symlink will result in a request to the target
object referenced by the symlink’s <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Account</span></code> and
<code class="docutils literal notranslate"><span class="pre">X-Symlink-Target</span></code> headers. The response of the GET/HEAD request will contain
a <code class="docutils literal notranslate"><span class="pre">Content-Location</span></code> header with the path location of the target object. A
GET/HEAD request to a symlink with the query parameter <code class="docutils literal notranslate"><span class="pre">?symlink=get</span></code> will
result in the request targeting the symlink itself.</p>
<p>A symlink can point to another symlink. Chained symlinks will be traversed
until the target is not a symlink. If the number of chained symlinks exceeds
the limit <code class="docutils literal notranslate"><span class="pre">symloop_max</span></code> an error response will be produced. The value of
<code class="docutils literal notranslate"><span class="pre">symloop_max</span></code> can be defined in the symlink config section of
<cite>proxy-server.conf</cite>. If not specified, the default <code class="docutils literal notranslate"><span class="pre">symloop_max</span></code> value is 2.
If a value less than 1 is specified, the default value will be used.</p>
<p>If a static symlink (i.e. a symlink created with a <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag</span></code>
header) targets another static symlink, both of the <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag</span></code>
headers must match the target object for the GET to succeed.  If a static
symlink targets a dynamic symlink (i.e. a symlink created without a
<code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag</span></code> header) then the <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag</span></code> header of
the static symlink must be the Etag of the zero-byte object.  If a symlink with
a <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag</span></code> targets a large object manifest it must match the
ETag of the manifest (e.g. the ETag as returned by <code class="docutils literal notranslate"><span class="pre">multipart-manifest=get</span></code>
or value in the <code class="docutils literal notranslate"><span class="pre">X-Manifest-Etag</span></code> header).</p>
<p>A HEAD/GET request to a symlink object behaves as a normal HEAD/GET request
to the target object. Therefore issuing a HEAD request to the symlink will
return the target metadata, and issuing a GET request to the symlink will
return the data and metadata of the target object. To return the symlink
metadata (with its empty body) a GET/HEAD request with the <code class="docutils literal notranslate"><span class="pre">?symlink=get</span></code>
query parameter must be sent to a symlink object.</p>
<p>A POST request to a symlink will result in a 307 Temporary Redirect response.
The response will contain a <code class="docutils literal notranslate"><span class="pre">Location</span></code> header with the path of the target
object as the value. The request is never redirected to the target object by
Swift. Nevertheless, the metadata in the POST request will be applied to the
symlink because object servers cannot know for sure if the current object is a
symlink or not in eventual consistency.</p>
<p>A symlink’s <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> is completely independent from its target.  As a
convenience Swift will automatically set the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> on a symlink PUT
if not explicitly set by the client.  If the client sends a
<code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag</span></code> Swift will set the symlink’s <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> to that
of the target, otherwise it will be set to <code class="docutils literal notranslate"><span class="pre">application/symlink</span></code>.  You can
review a symlink’s <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> using the <code class="docutils literal notranslate"><span class="pre">?symlink=get</span></code> interface.  You
can change a symlink’s <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> using a POST request.  The symlink’s
<code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> will appear in the container listing.</p>
<p>A DELETE request to a symlink will delete the symlink itself. The target
object will not be deleted.</p>
<p>A COPY request, or a PUT request with a <code class="docutils literal notranslate"><span class="pre">X-Copy-From</span></code> header, to a symlink
will copy the target object. The same request to a symlink with the query
parameter <code class="docutils literal notranslate"><span class="pre">?symlink=get</span></code> will copy the symlink itself.</p>
<p>An OPTIONS request to a symlink will respond with the options for the symlink
only; the request will not be redirected to the target object. Please note that
if the symlink’s target object is in another container with CORS settings, the
response will not reflect the settings.</p>
<p>Tempurls can be used to GET/HEAD symlink objects, but PUT is not allowed and
will result in a 400-series error. The GET/HEAD tempurls honor the scope of
the tempurl key. Container tempurl will only work on symlinks where the target
container is the same as the symlink. In case a symlink targets an object
in a different container, a GET/HEAD request will result in a 401 Unauthorized
error. The account level tempurl will allow cross-container symlinks, but not
cross-account symlinks.</p>
<p>If a symlink object is overwritten while it is in a versioned container, the
symlink object itself is versioned, not the referenced object.</p>
<p>A GET request with query parameter <code class="docutils literal notranslate"><span class="pre">?format=json</span></code> to a container which
contains symlinks will respond with additional information <code class="docutils literal notranslate"><span class="pre">symlink_path</span></code>
for each symlink object in the container listing. The <code class="docutils literal notranslate"><span class="pre">symlink_path</span></code> value
is the target path of the symlink. Clients can differentiate symlinks and
other objects by this function. Note that responses in any other format
(e.g. <code class="docutils literal notranslate"><span class="pre">?format=xml</span></code>) won’t include <code class="docutils literal notranslate"><span class="pre">symlink_path</span></code> info.  If a
<code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag</span></code> header was included on the symlink, JSON container
listings will include that value in a <code class="docutils literal notranslate"><span class="pre">symlink_etag</span></code> key and the target
object’s <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> will be included in the key <code class="docutils literal notranslate"><span class="pre">symlink_bytes</span></code>.</p>
<p>If a static symlink targets a static large object manifest it will carry
forward the SLO’s size and slo_etag in the container listing using the
<code class="docutils literal notranslate"><span class="pre">symlink_bytes</span></code> and <code class="docutils literal notranslate"><span class="pre">slo_etag</span></code> keys.  However, manifests created before
swift v2.12.0 (released Dec 2016) do not contain enough metadata to propagate
the extra SLO information to the listing.  Clients may recreate the manifest
(COPY w/ <code class="docutils literal notranslate"><span class="pre">?multipart-manfiest=get</span></code>) before creating a static symlink to add
the requisite metadata.</p>
<p>Errors</p>
<ul class="simple">
<li><p>PUT with the header <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target</span></code> with non-zero Content-Length
will produce a 400 BadRequest error.</p></li>
<li><p>POST with the header <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target</span></code> will produce a
400 BadRequest error.</p></li>
<li><p>GET/HEAD traversing more than <code class="docutils literal notranslate"><span class="pre">symloop_max</span></code> chained symlinks will
produce a 409 Conflict error.</p></li>
<li><p>PUT/GET/HEAD on a symlink that inclues a <code class="docutils literal notranslate"><span class="pre">X-Symlink-Target-Etag</span></code> header
that does not match the target will poduce a 409 Conflict error.</p></li>
<li><p>POSTs will produce a 307 Temporary Redirect error.</p></li>
</ul>
<section id="id17">
<h3>Deployment<a class="headerlink" href="#id17" title="Permalink to this heading">¶</a></h3>
<p>Symlinks are enabled by adding the <cite>symlink</cite> middleware to the proxy server
WSGI pipeline and including a corresponding filter configuration section in the
<cite>proxy-server.conf</cite> file. The <cite>symlink</cite> middleware should be placed after
<cite>slo</cite>, <cite>dlo</cite> and <cite>versioned_writes</cite> middleware, but before <cite>encryption</cite>
middleware in the pipeline. See the <cite>proxy-server.conf-sample</cite> file for further
details. <a class="reference internal" href="#symlink-container-sync-client-config"><span class="std std-ref">Additional steps</span></a> are
required if the container sync feature is being used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Once you have deployed <cite>symlink</cite> middleware in your pipeline, you should
neither remove the <cite>symlink</cite> middleware nor downgrade swift to a version
earlier than symlinks being supported. Doing so may result in unexpected
container listing results in addition to symlink objects behaving like a
normal object.</p>
</div>
<section id="container-sync-configuration">
<span id="symlink-container-sync-client-config"></span><h4>Container sync configuration<a class="headerlink" href="#container-sync-configuration" title="Permalink to this heading">¶</a></h4>
<p>If container sync is being used then the <cite>symlink</cite> middleware
must be added to the container sync internal client pipeline. The following
configuration steps are required:</p>
<ol class="arabic">
<li><p>Create a custom internal client configuration file for container sync (if
one is not already in use) based on the sample file
<cite>internal-client.conf-sample</cite>. For example, copy
<cite>internal-client.conf-sample</cite> to <cite>/etc/swift/container-sync-client.conf</cite>.</p></li>
<li><p>Modify this file to include the <cite>symlink</cite> middleware in the pipeline in
the same way as described above for the proxy server.</p></li>
<li><p>Modify the container-sync section of all container server config files to
point to this internal client config file using the
<code class="docutils literal notranslate"><span class="pre">internal_client_conf_path</span></code> option. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">internal_client_conf_path</span> <span class="o">=</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">swift</span><span class="o">/</span><span class="n">container</span><span class="o">-</span><span class="n">sync</span><span class="o">-</span><span class="n">client</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These container sync configuration steps will be necessary for container
sync probe tests to pass if the <cite>symlink</cite> middleware is included in the
proxy pipeline of a test cluster.</p>
</div>
</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.SymlinkContainerContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.symlink.</span></span><span class="sig-name descname"><span class="pre">SymlinkContainerContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wsgi_app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.SymlinkContainerContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.wsgi.WSGIContext" title="swift.common.wsgi.WSGIContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIContext</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.SymlinkContainerContext.handle_container">
<span class="sig-name descname"><span class="pre">handle_container</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.SymlinkContainerContext.handle_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle container requests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – a <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a></p></li>
<li><p><strong>start_response</strong> – start_response function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response Iterator after start_response called.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.SymlinkMiddleware">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.symlink.</span></span><span class="sig-name descname"><span class="pre">SymlinkMiddleware</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symloop_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.SymlinkMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Middleware that implements symlinks.</p>
<p>Symlinks are objects stored in Swift that contain a reference to another
object (i.e., the target object). An important use case is to use a path in
one container to access an object in a different container, with a
different policy. This allows policy cost/performance trade-offs to be made
on individual objects.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.SymlinkObjectContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.symlink.</span></span><span class="sig-name descname"><span class="pre">SymlinkObjectContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wsgi_app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symloop_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.SymlinkObjectContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.wsgi.WSGIContext" title="swift.common.wsgi.WSGIContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIContext</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.SymlinkObjectContext.handle_get_head">
<span class="sig-name descname"><span class="pre">handle_get_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.SymlinkObjectContext.handle_get_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle get/head request and in case the response is a symlink,
redirect request to target object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> – HTTP GET or HEAD object request</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response Iterator</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.SymlinkObjectContext.handle_get_head_symlink">
<span class="sig-name descname"><span class="pre">handle_get_head_symlink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.SymlinkObjectContext.handle_get_head_symlink" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle get/head request when client sent parameter ?symlink=get</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> – HTTP GET or HEAD object request with param ?symlink=get</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response Iterator</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.SymlinkObjectContext.handle_object">
<span class="sig-name descname"><span class="pre">handle_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.SymlinkObjectContext.handle_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle object requests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – a <a class="reference internal" href="misc.html#swift.common.swob.Request" title="swift.common.swob.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a></p></li>
<li><p><strong>start_response</strong> – start_response function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response Iterator after start_response has been called</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.SymlinkObjectContext.handle_post">
<span class="sig-name descname"><span class="pre">handle_post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.SymlinkObjectContext.handle_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle post request. If POSTing to a symlink, a HTTPTemporaryRedirect
error message is returned to client.</p>
<p>Clients that POST to symlinks should understand that the POST is not
redirected to the target object like in a HEAD/GET request. POSTs to a
symlink will be handled just like a normal object by the object server.
It cannot reject it because it may not have symlink state when the POST
lands.  The object server has no knowledge of what is a symlink object
is. On the other hand, on POST requests, the object server returns all
sysmeta of the object. This method uses that sysmeta to determine if
the stored object is a symlink or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> – HTTP POST object request</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p>HTTPTemporaryRedirect if POSTing to a symlink.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Response Iterator</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.SymlinkObjectContext.handle_put">
<span class="sig-name descname"><span class="pre">handle_put</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.SymlinkObjectContext.handle_put" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle put request when it contains X-Symlink-Target header.</p>
<p>Symlink headers are validated and moved to sysmeta namespace.
:param req: HTTP PUT object request
:returns: Response Iterator</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.symlink_sysmeta_to_usermeta">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.symlink.</span></span><span class="sig-name descname"><span class="pre">symlink_sysmeta_to_usermeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.symlink_sysmeta_to_usermeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to translate from cluster-facing
X-Object-Sysmeta-Symlink-* headers to client-facing X-Symlink-* headers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>headers</strong> – request headers dict. Note that the headers dict
will be updated directly.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.symlink.symlink_usermeta_to_sysmeta">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.symlink.</span></span><span class="sig-name descname"><span class="pre">symlink_usermeta_to_sysmeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.symlink.symlink_usermeta_to_sysmeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to translate from client-facing X-Symlink-* headers
to cluster-facing X-Object-Sysmeta-Symlink-* headers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>headers</strong> – request headers dict. Note that the headers dict
will be updated directly.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-swift.common.middleware.tempauth">
<span id="tempauth"></span><span id="common-tempauth"></span><h2>TempAuth<a class="headerlink" href="#module-swift.common.middleware.tempauth" title="Permalink to this heading">¶</a></h2>
<p>Test authentication and authorization system.</p>
<p>Add to your pipeline in proxy-server.conf, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">pipeline</span><span class="p">:</span><span class="n">main</span><span class="p">]</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">catch_errors</span> <span class="n">cache</span> <span class="n">tempauth</span> <span class="n">proxy</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
<p>Set account auto creation to true in proxy-server.conf:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">app</span><span class="p">:</span><span class="n">proxy</span><span class="o">-</span><span class="n">server</span><span class="p">]</span>
<span class="n">account_autocreate</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
<p>And add a tempauth filter section, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">filter</span><span class="p">:</span><span class="n">tempauth</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#tempauth</span>
<span class="n">user_admin_admin</span> <span class="o">=</span> <span class="n">admin</span> <span class="o">.</span><span class="n">admin</span> <span class="o">.</span><span class="n">reseller_admin</span>
<span class="n">user_test_tester</span> <span class="o">=</span> <span class="n">testing</span> <span class="o">.</span><span class="n">admin</span>
<span class="n">user_test2_tester2</span> <span class="o">=</span> <span class="n">testing2</span> <span class="o">.</span><span class="n">admin</span>
<span class="n">user_test_tester3</span> <span class="o">=</span> <span class="n">testing3</span>
<span class="c1"># To allow accounts/users with underscores you can base64 encode them.</span>
<span class="c1"># Here is the account &quot;under_score&quot; and username &quot;a_b&quot; (note the lack</span>
<span class="c1"># of padding equal signs):</span>
<span class="n">user64_dW5kZXJfc2NvcmU_YV9i</span> <span class="o">=</span> <span class="n">testing4</span>
</pre></div>
</div>
<p>See the proxy-server.conf-sample for more information.</p>
<section id="account-user-list">
<h3>Account/User List<a class="headerlink" href="#account-user-list" title="Permalink to this heading">¶</a></h3>
<p>All accounts/users are listed in the filter section. The format is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user_</span><span class="o">&lt;</span><span class="n">account</span><span class="o">&gt;</span><span class="n">_</span><span class="o">&lt;</span><span class="n">user</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="p">[</span><span class="n">storage_url</span><span class="p">]</span>
</pre></div>
</div>
<p>If you want to be able to include underscores in the <code class="docutils literal notranslate"><span class="pre">&lt;account&gt;</span></code> or
<code class="docutils literal notranslate"><span class="pre">&lt;user&gt;</span></code> portions, you can base64 encode them (with <em>no</em> equal signs)
in a line like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user64_</span><span class="o">&lt;</span><span class="n">account_b64</span><span class="o">&gt;</span><span class="n">_</span><span class="o">&lt;</span><span class="n">user_b64</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="p">[</span><span class="n">storage_url</span><span class="p">]</span>
</pre></div>
</div>
<p>There are three special groups:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.reseller_admin</span></code> – can do anything to any account for this auth</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.reseller_reader</span></code> – can GET/HEAD anything in any account for this auth</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.admin</span></code> – can do anything within the account</p></li>
</ul>
<p>If none of these groups are specified, the user can only access
containers that have been explicitly allowed for them by a <code class="docutils literal notranslate"><span class="pre">.admin</span></code> or
<code class="docutils literal notranslate"><span class="pre">.reseller_admin</span></code>.</p>
<p>The trailing optional <code class="docutils literal notranslate"><span class="pre">storage_url</span></code> allows you to specify an alternate
URL to hand back to the user upon authentication. If not specified, this
defaults to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$HOST/v1/&lt;reseller_prefix&gt;_&lt;account&gt;
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">$HOST</span></code> will do its best to resolve to what the requester would
need to use to reach this host, <code class="docutils literal notranslate"><span class="pre">&lt;reseller_prefix&gt;</span></code> is from this section,
and <code class="docutils literal notranslate"><span class="pre">&lt;account&gt;</span></code> is from the <code class="docutils literal notranslate"><span class="pre">user_&lt;account&gt;_&lt;user&gt;</span></code> name. Note that
<code class="docutils literal notranslate"><span class="pre">$HOST</span></code> cannot possibly handle when you have a load balancer in front of
it that does https while TempAuth itself runs with http; in such a case,
you’ll have to specify the  <code class="docutils literal notranslate"><span class="pre">storage_url_scheme</span></code> configuration value as
an override.</p>
</section>
<section id="multiple-reseller-prefix-items">
<h3>Multiple Reseller Prefix Items<a class="headerlink" href="#multiple-reseller-prefix-items" title="Permalink to this heading">¶</a></h3>
<p>The reseller prefix specifies which parts of the account namespace this
middleware is responsible for managing authentication and authorization.
By default, the prefix is <code class="docutils literal notranslate"><span class="pre">AUTH</span></code> so accounts and tokens are prefixed
by <code class="docutils literal notranslate"><span class="pre">AUTH_</span></code>. When a request’s token and/or path start with <code class="docutils literal notranslate"><span class="pre">AUTH_</span></code>, this
middleware knows it is responsible.</p>
<p>We allow the reseller prefix to be a list. In tempauth, the first item
in the list is used as the prefix for tokens and user groups. The
other prefixes provide alternate accounts that user’s can access. For
example if the reseller prefix list is <code class="docutils literal notranslate"><span class="pre">AUTH,</span> <span class="pre">OTHER</span></code>, a user with
admin access to <code class="docutils literal notranslate"><span class="pre">AUTH_account</span></code> also has admin access to
<code class="docutils literal notranslate"><span class="pre">OTHER_account</span></code>.</p>
</section>
<section id="required-group">
<h3>Required Group<a class="headerlink" href="#required-group" title="Permalink to this heading">¶</a></h3>
<p>The group <code class="docutils literal notranslate"><span class="pre">.admin</span></code> is normally needed to access an account (ACLs provide
an additional way to access an account). You can specify the
<code class="docutils literal notranslate"><span class="pre">require_group</span></code> parameter. This means that you also need the named group
to access an account. If you have several reseller prefix items, prefix
the <code class="docutils literal notranslate"><span class="pre">require_group</span></code> parameter with the appropriate prefix.</p>
</section>
<section id="x-service-token">
<h3>X-Service-Token<a class="headerlink" href="#x-service-token" title="Permalink to this heading">¶</a></h3>
<p>If an <code class="docutils literal notranslate"><span class="pre">X-Service-Token</span></code> is presented in the request headers, the groups
derived from the token are appended to the roles derived from
<code class="docutils literal notranslate"><span class="pre">X-Auth-Token</span></code>. If <code class="docutils literal notranslate"><span class="pre">X-Auth-Token</span></code> is missing or invalid,
<code class="docutils literal notranslate"><span class="pre">X-Service-Token</span></code> is not processed.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">X-Service-Token</span></code> is useful when combined with multiple reseller
prefix items. In the following configuration, accounts prefixed
<code class="docutils literal notranslate"><span class="pre">SERVICE_</span></code> are only accessible if <code class="docutils literal notranslate"><span class="pre">X-Auth-Token</span></code> is from the end-user
and <code class="docutils literal notranslate"><span class="pre">X-Service-Token</span></code> is from the <code class="docutils literal notranslate"><span class="pre">glance</span></code> user:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">filter</span><span class="p">:</span><span class="n">tempauth</span><span class="p">]</span>
<span class="n">use</span> <span class="o">=</span> <span class="n">egg</span><span class="p">:</span><span class="n">swift</span><span class="c1">#tempauth</span>
<span class="n">reseller_prefix</span> <span class="o">=</span> <span class="n">AUTH</span><span class="p">,</span> <span class="n">SERVICE</span>
<span class="n">SERVICE_require_group</span> <span class="o">=</span> <span class="o">.</span><span class="n">service</span>
<span class="n">user_admin_admin</span> <span class="o">=</span> <span class="n">admin</span> <span class="o">.</span><span class="n">admin</span> <span class="o">.</span><span class="n">reseller_admin</span>
<span class="n">user_joeacct_joe</span> <span class="o">=</span> <span class="n">joepw</span> <span class="o">.</span><span class="n">admin</span>
<span class="n">user_maryacct_mary</span> <span class="o">=</span> <span class="n">marypw</span> <span class="o">.</span><span class="n">admin</span>
<span class="n">user_glance_glance</span> <span class="o">=</span> <span class="n">glancepw</span> <span class="o">.</span><span class="n">service</span>
</pre></div>
</div>
<p>The name <code class="docutils literal notranslate"><span class="pre">.service</span></code> is an example. Unlike <code class="docutils literal notranslate"><span class="pre">.admin</span></code>, <code class="docutils literal notranslate"><span class="pre">.reseller_admin</span></code>,
<code class="docutils literal notranslate"><span class="pre">.reseller_reader</span></code> it is not a reserved name.</p>
<p>Please note that ACLs can be set on service accounts and are matched
against the identity validated by <code class="docutils literal notranslate"><span class="pre">X-Auth-Token</span></code>. As such ACLs can grant
access to a service account’s container without needing to provide a
service token, just like any other cross-reseller request using ACLs.</p>
</section>
<section id="account-acls">
<h3>Account ACLs<a class="headerlink" href="#account-acls" title="Permalink to this heading">¶</a></h3>
<p>If a swift_owner issues a POST or PUT to the account with the
<code class="docutils literal notranslate"><span class="pre">X-Account-Access-Control</span></code> header set in the request, then this may
allow certain types of access for additional users.</p>
<ul class="simple">
<li><p>Read-Only: Users with read-only access can list containers in the
account, list objects in any container, retrieve objects, and view
unprivileged account/container/object metadata.</p></li>
<li><p>Read-Write: Users with read-write access can (in addition to the
read-only privileges) create objects, overwrite existing objects,
create new containers, and set unprivileged container/object
metadata.</p></li>
<li><p>Admin: Users with admin access are swift_owners and can perform
any action, including viewing/setting privileged metadata (e.g.
changing account ACLs).</p></li>
</ul>
<p>To generate headers for setting an account ACL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">swift.common.middleware.acl</span> <span class="kn">import</span> <span class="n">format_acl</span>
<span class="n">acl_data</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;admin&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;alice&#39;</span><span class="p">],</span> <span class="s1">&#39;read-write&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;bob&#39;</span><span class="p">,</span> <span class="s1">&#39;carol&#39;</span><span class="p">]</span> <span class="p">}</span>
<span class="n">header_value</span> <span class="o">=</span> <span class="n">format_acl</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">acl_dict</span><span class="o">=</span><span class="n">acl_data</span><span class="p">)</span>
</pre></div>
</div>
<p>To generate a curl command line from the above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">token</span><span class="o">=...</span>
<span class="n">storage_url</span><span class="o">=...</span>
<span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;</span>
  <span class="kn">from</span> <span class="nn">swift.common.middleware.acl</span> <span class="kn">import</span> <span class="n">format_acl</span>
  <span class="n">acl_data</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;admin&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;alice&#39;</span><span class="p">],</span> <span class="s1">&#39;read-write&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;bob&#39;</span><span class="p">,</span> <span class="s1">&#39;carol&#39;</span><span class="p">]</span> <span class="p">}</span>
  <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X-Account-Access-Control&#39;</span><span class="p">:</span>
             <span class="n">format_acl</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">acl_dict</span><span class="o">=</span><span class="n">acl_data</span><span class="p">)}</span>
  <span class="n">header_str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;-H &#39;</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                         <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;curl -D- -X POST -H &quot;x-auth-token: $token&quot; </span><span class="si">%s</span><span class="s1"> &#39;</span>
        <span class="s1">&#39;$storage_url&#39;</span> <span class="o">%</span> <span class="n">header_str</span><span class="p">)</span>
<span class="s1">&#39;</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.tempauth.TempAuth">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.tempauth.</span></span><span class="sig-name descname"><span class="pre">TempAuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempauth.TempAuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> – The next WSGI app in the pipeline</p></li>
<li><p><strong>conf</strong> – The dict of configuration values from the Paste config file</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.tempauth.TempAuth.account_acls">
<span class="sig-name descname"><span class="pre">account_acls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempauth.TempAuth.account_acls" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dict of ACL data from the account server via get_account_info.</p>
<p>Auth systems may define their own format, serialization, structure,
and capabilities implemented in the ACL headers and persisted in the
sysmeta data.  However, auth systems are strongly encouraged to be
interoperable with Tempauth.</p>
<dl class="simple">
<dt>Account ACLs are set and retrieved via the header</dt><dd><p>X-Account-Access-Control</p>
</dd>
<dt>For header format and syntax, see:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="misc.html#swift.common.middleware.acl.parse_acl" title="swift.common.middleware.acl.parse_acl"><code class="xref py py-func docutils literal notranslate"><span class="pre">swift.common.middleware.acl.parse_acl()</span></code></a></p></li>
<li><p><a class="reference internal" href="misc.html#swift.common.middleware.acl.format_acl" title="swift.common.middleware.acl.format_acl"><code class="xref py py-func docutils literal notranslate"><span class="pre">swift.common.middleware.acl.format_acl()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.tempauth.TempAuth.authorize">
<span class="sig-name descname"><span class="pre">authorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempauth.TempAuth.authorize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns None if the request is authorized to continue or a standard
WSGI response callable if not.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.tempauth.TempAuth.denied_response">
<span class="sig-name descname"><span class="pre">denied_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempauth.TempAuth.denied_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a standard WSGI response callable with the status of 403 or 401
depending on whether the REMOTE_USER is set or not.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.tempauth.TempAuth.extract_acl_and_report_errors">
<span class="sig-name descname"><span class="pre">extract_acl_and_report_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempauth.TempAuth.extract_acl_and_report_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a user-readable string indicating the errors in the input ACL,
or None if there are no errors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.tempauth.TempAuth.get_groups">
<span class="sig-name descname"><span class="pre">get_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempauth.TempAuth.get_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Get groups for the given token.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – The current WSGI environment dictionary.</p></li>
<li><p><strong>token</strong> – Token to validate and return a group string for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None if the token is invalid or a string containing a comma
separated list of groups the authenticated user is a member
of. The first group in the list is also considered a unique
identifier for that user.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.tempauth.TempAuth.handle">
<span class="sig-name descname"><span class="pre">handle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempauth.TempAuth.handle" title="Permalink to this definition">¶</a></dt>
<dd><p>WSGI entry point for auth requests (ones that match the
self.auth_prefix).
Wraps env in swob.Request object and passes it down.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – WSGI environment dictionary</p></li>
<li><p><strong>start_response</strong> – WSGI callable</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.tempauth.TempAuth.handle_get_token">
<span class="sig-name descname"><span class="pre">handle_get_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempauth.TempAuth.handle_get_token" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles the various <cite>request for token and service end point(s)</cite> calls.
There are various formats to support the various auth servers in the
past. Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GET</span> <span class="o">&lt;</span><span class="n">auth</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;/</span><span class="n">v1</span><span class="o">/&lt;</span><span class="n">act</span><span class="o">&gt;/</span><span class="n">auth</span>
    <span class="n">X</span><span class="o">-</span><span class="n">Auth</span><span class="o">-</span><span class="n">User</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">act</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">usr</span><span class="o">&gt;</span>  <span class="ow">or</span>  <span class="n">X</span><span class="o">-</span><span class="n">Storage</span><span class="o">-</span><span class="n">User</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">usr</span><span class="o">&gt;</span>
    <span class="n">X</span><span class="o">-</span><span class="n">Auth</span><span class="o">-</span><span class="n">Key</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>         <span class="ow">or</span>  <span class="n">X</span><span class="o">-</span><span class="n">Storage</span><span class="o">-</span><span class="n">Pass</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>
<span class="n">GET</span> <span class="o">&lt;</span><span class="n">auth</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;/</span><span class="n">auth</span>
    <span class="n">X</span><span class="o">-</span><span class="n">Auth</span><span class="o">-</span><span class="n">User</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">act</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">usr</span><span class="o">&gt;</span>  <span class="ow">or</span>  <span class="n">X</span><span class="o">-</span><span class="n">Storage</span><span class="o">-</span><span class="n">User</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">act</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">usr</span><span class="o">&gt;</span>
    <span class="n">X</span><span class="o">-</span><span class="n">Auth</span><span class="o">-</span><span class="n">Key</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>         <span class="ow">or</span>  <span class="n">X</span><span class="o">-</span><span class="n">Storage</span><span class="o">-</span><span class="n">Pass</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>
<span class="n">GET</span> <span class="o">&lt;</span><span class="n">auth</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;/</span><span class="n">v1</span><span class="mf">.0</span>
    <span class="n">X</span><span class="o">-</span><span class="n">Auth</span><span class="o">-</span><span class="n">User</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">act</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">usr</span><span class="o">&gt;</span>  <span class="ow">or</span>  <span class="n">X</span><span class="o">-</span><span class="n">Storage</span><span class="o">-</span><span class="n">User</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">act</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">usr</span><span class="o">&gt;</span>
    <span class="n">X</span><span class="o">-</span><span class="n">Auth</span><span class="o">-</span><span class="n">Key</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>         <span class="ow">or</span>  <span class="n">X</span><span class="o">-</span><span class="n">Storage</span><span class="o">-</span><span class="n">Pass</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>On successful authentication, the response will have X-Auth-Token and
X-Storage-Token set to the token to use with Swift and X-Storage-URL
set to the URL to the default Swift cluster to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> – The swob.Request to process.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>swob.Response, 2xx on success with data set as explained
above.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.tempauth.TempAuth.handle_request">
<span class="sig-name descname"><span class="pre">handle_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempauth.TempAuth.handle_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry point for auth requests (ones that match the self.auth_prefix).
Should return a WSGI-style callable (such as swob.Response).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> – swob.Request object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.tempauth.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.tempauth.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempauth.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a WSGI filter app for use with paste.deploy.</p>
</dd></dl>

</section>
<section id="tempurl">
<span id="id18"></span><h2>TempURL<a class="headerlink" href="#tempurl" title="Permalink to this heading">¶</a></h2>
<span class="target" id="module-swift.common.middleware.tempurl"></span><p>TempURL Middleware</p>
<p>Allows the creation of URLs to provide temporary access to objects.</p>
<p>For example, a website may wish to provide a link to download a large
object in Swift, but the Swift account has no public access. The
website can generate a URL that will provide GET access for a limited
time to the resource. When the web browser user clicks on the link,
the browser will download the object directly from Swift, obviating
the need for the website to act as a proxy for the request.</p>
<p>If the user were to share the link with all his friends, or
accidentally post it on a forum, etc. the direct access would be
limited to the expiration time set when the website created the link.</p>
<p>Beyond that, the middleware provides the ability to create URLs, which
contain signatures which are valid for all objects which share a
common prefix. These prefix-based URLs are useful for sharing a set
of objects.</p>
<p>Restrictions can also be placed on the ip that the resource is allowed
to be accessed from. This can be useful for locking down where the urls
can be used from.</p>
<section id="client-usage">
<h3>Client Usage<a class="headerlink" href="#client-usage" title="Permalink to this heading">¶</a></h3>
<p>To create temporary URLs, first an <code class="docutils literal notranslate"><span class="pre">X-Account-Meta-Temp-URL-Key</span></code>
header must be set on the Swift account. Then, an HMAC (RFC 2104)
signature is generated using the HTTP method to allow (<code class="docutils literal notranslate"><span class="pre">GET</span></code>, <code class="docutils literal notranslate"><span class="pre">PUT</span></code>,
<code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, etc.), the Unix timestamp until which the access should be allowed,
the full path to the object, and the key set on the account.</p>
<p>The digest algorithm to be used may be configured by the operator. By default,
HMAC-SHA256 and HMAC-SHA512 are supported. Check the
<code class="docutils literal notranslate"><span class="pre">tempurl.allowed_digests</span></code> entry in the cluster’s capabilities response to
see which algorithms are supported by your deployment; see
<a class="reference internal" href="api/discoverability.html"><span class="doc">Discoverability</span></a> for more information. On older clusters,
the <code class="docutils literal notranslate"><span class="pre">tempurl</span></code> key may be present while the <code class="docutils literal notranslate"><span class="pre">allowed_digests</span></code> subkey
is not; in this case, only HMAC-SHA1 is supported.</p>
<p>For example, here is code generating the signature for a <code class="docutils literal notranslate"><span class="pre">GET</span></code> for 60
seconds on <code class="docutils literal notranslate"><span class="pre">/v1/AUTH_account/container/object</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;GET&#39;</span>
<span class="n">expires</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/v1/AUTH_account/container/object&#39;</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;mykey&#39;</span>
<span class="n">hmac_body</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">expires</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">hmac_body</span><span class="p">,</span> <span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</pre></div>
</div>
<p>Be certain to use the full path, from the <code class="docutils literal notranslate"><span class="pre">/v1/</span></code> onward.</p>
<p>Let’s say <code class="docutils literal notranslate"><span class="pre">sig</span></code> ends up equaling
<code class="docutils literal notranslate"><span class="pre">732fcac368abb10c78a4cbe95c3fab7f311584532bf779abd5074e13cbe8b88b</span></code> and
<code class="docutils literal notranslate"><span class="pre">expires</span></code> ends up <code class="docutils literal notranslate"><span class="pre">1512508563</span></code>. Then, for example, the website could
provide a link to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://swift-cluster.example.com/v1/AUTH_account/container/object?
temp_url_sig=732fcac368abb10c78a4cbe95c3fab7f311584532bf779abd5074e13cbe8b88b&amp;
temp_url_expires=1512508563
</pre></div>
</div>
<p>For longer hashes, a hex encoding becomes unwieldy. Base64 encoding is also
supported, and indicated by prefixing the signature with <code class="docutils literal notranslate"><span class="pre">&quot;&lt;digest</span> <span class="pre">name&gt;:&quot;</span></code>.
This is <em>required</em> for HMAC-SHA512 signatures. For example, comparable code
for generating a HMAC-SHA512 signature would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha512</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;GET&#39;</span>
<span class="n">expires</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/v1/AUTH_account/container/object&#39;</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;mykey&#39;</span>
<span class="n">hmac_body</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">expires</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
<span class="n">sig</span> <span class="o">=</span> <span class="s1">&#39;sha512:&#39;</span> <span class="o">+</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
    <span class="n">key</span><span class="p">,</span> <span class="n">hmac_body</span><span class="p">,</span> <span class="n">sha512</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span>
</pre></div>
</div>
<p>Supposing that <code class="docutils literal notranslate"><span class="pre">sig</span></code> ends up equaling
<code class="docutils literal notranslate"><span class="pre">sha512:ZrSijn0GyDhsv1ltIj9hWUTrbAeE45NcKXyBaz7aPbSMvROQ4jtYH4nRAmm</span>
<span class="pre">5ErY2X11Yc1Yhy2OMCyN3yueeXg==</span></code> and <code class="docutils literal notranslate"><span class="pre">expires</span></code> ends up
<code class="docutils literal notranslate"><span class="pre">1516741234</span></code>, then the website could provide a link to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://swift-cluster.example.com/v1/AUTH_account/container/object?
temp_url_sig=sha512:ZrSijn0GyDhsv1ltIj9hWUTrbAeE45NcKXyBaz7aPbSMvRO
Q4jtYH4nRAmm5ErY2X11Yc1Yhy2OMCyN3yueeXg==&amp;
temp_url_expires=1516741234
</pre></div>
</div>
<p>You may also use ISO 8601 UTC timestamps with the format
<code class="docutils literal notranslate"><span class="pre">&quot;%Y-%m-%dT%H:%M:%SZ&quot;</span></code> instead of UNIX timestamps in the URL
(but NOT in the code above for generating the signature!).
So, the above HMAC-SHA246 URL could also be formulated as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://swift-cluster.example.com/v1/AUTH_account/container/object?
temp_url_sig=732fcac368abb10c78a4cbe95c3fab7f311584532bf779abd5074e13cbe8b88b&amp;
temp_url_expires=2017-12-05T21:16:03Z
</pre></div>
</div>
<p>If a prefix-based signature with the prefix <code class="docutils literal notranslate"><span class="pre">pre</span></code> is desired, set path to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;prefix:/v1/AUTH_account/container/pre&#39;</span>
</pre></div>
</div>
<p>The generated signature would be valid for all objects starting
with <code class="docutils literal notranslate"><span class="pre">pre</span></code>. The middleware detects a prefix-based temporary URL by
a query parameter called <code class="docutils literal notranslate"><span class="pre">temp_url_prefix</span></code>. So, if <code class="docutils literal notranslate"><span class="pre">sig</span></code> and <code class="docutils literal notranslate"><span class="pre">expires</span></code>
would end up like above, following URL would be valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://swift-cluster.example.com/v1/AUTH_account/container/pre/object?
temp_url_sig=732fcac368abb10c78a4cbe95c3fab7f311584532bf779abd5074e13cbe8b88b&amp;
temp_url_expires=1512508563&amp;
temp_url_prefix=pre
</pre></div>
</div>
<p>Another valid URL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://swift-cluster.example.com/v1/AUTH_account/container/pre/
subfolder/another_object?
temp_url_sig=732fcac368abb10c78a4cbe95c3fab7f311584532bf779abd5074e13cbe8b88b&amp;
temp_url_expires=1512508563&amp;
temp_url_prefix=pre
</pre></div>
</div>
<p>If you wish to lock down the ip ranges from where the resource can be accessed
to the ip <code class="docutils literal notranslate"><span class="pre">1.2.3.4</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;GET&#39;</span>
<span class="n">expires</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/v1/AUTH_account/container/object&#39;</span>
<span class="n">ip_range</span> <span class="o">=</span> <span class="s1">&#39;1.2.3.4&#39;</span>
<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;mykey&#39;</span>
<span class="n">hmac_body</span> <span class="o">=</span> <span class="s1">&#39;ip=</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ip_range</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">expires</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">hmac_body</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">),</span> <span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</pre></div>
</div>
<p>The generated signature would only be valid from the ip <code class="docutils literal notranslate"><span class="pre">1.2.3.4</span></code>. The
middleware detects an ip-based temporary URL by a query parameter called
<code class="docutils literal notranslate"><span class="pre">temp_url_ip_range</span></code>. So, if <code class="docutils literal notranslate"><span class="pre">sig</span></code> and <code class="docutils literal notranslate"><span class="pre">expires</span></code> would end up like
above, following URL would be valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://swift-cluster.example.com/v1/AUTH_account/container/object?
temp_url_sig=3f48476acaf5ec272acd8e99f7b5bad96c52ddba53ed27c60613711774a06f0c&amp;
temp_url_expires=1648082711&amp;
temp_url_ip_range=1.2.3.4
</pre></div>
</div>
<p>Similarly to lock down the ip to a range of <code class="docutils literal notranslate"><span class="pre">1.2.3.X</span></code> so starting
from the ip <code class="docutils literal notranslate"><span class="pre">1.2.3.0</span></code> to <code class="docutils literal notranslate"><span class="pre">1.2.3.255</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;GET&#39;</span>
<span class="n">expires</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/v1/AUTH_account/container/object&#39;</span>
<span class="n">ip_range</span> <span class="o">=</span> <span class="s1">&#39;1.2.3.0/24&#39;</span>
<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;mykey&#39;</span>
<span class="n">hmac_body</span> <span class="o">=</span> <span class="s1">&#39;ip=</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ip_range</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">expires</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
<span class="n">sig</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">hmac_body</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">),</span> <span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</pre></div>
</div>
<p>Then the following url would be valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://swift-cluster.example.com/v1/AUTH_account/container/object?
temp_url_sig=6ff81256b8a3ba11d239da51a703b9c06a56ffddeb8caab74ca83af8f73c9c83&amp;
temp_url_expires=1648082711&amp;
temp_url_ip_range=1.2.3.0/24
</pre></div>
</div>
<p>Any alteration of the resource path or query arguments of a temporary URL
would result in <code class="docutils literal notranslate"><span class="pre">401</span> <span class="pre">Unauthorized</span></code>. Similarly, a <code class="docutils literal notranslate"><span class="pre">PUT</span></code> where <code class="docutils literal notranslate"><span class="pre">GET</span></code> was
the allowed method would be rejected with <code class="docutils literal notranslate"><span class="pre">401</span> <span class="pre">Unauthorized</span></code>.
However, <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> is allowed if <code class="docutils literal notranslate"><span class="pre">GET</span></code>, <code class="docutils literal notranslate"><span class="pre">PUT</span></code>, or <code class="docutils literal notranslate"><span class="pre">POST</span></code> is allowed.</p>
<p>Using this in combination with browser form post translation
middleware could also allow direct-from-browser uploads to specific
locations in Swift.</p>
<p>TempURL supports both account and container level keys.  Each allows up to two
keys to be set, allowing key rotation without invalidating all existing
temporary URLs.  Account keys are specified by <code class="docutils literal notranslate"><span class="pre">X-Account-Meta-Temp-URL-Key</span></code>
and <code class="docutils literal notranslate"><span class="pre">X-Account-Meta-Temp-URL-Key-2</span></code>, while container keys are specified by
<code class="docutils literal notranslate"><span class="pre">X-Container-Meta-Temp-URL-Key</span></code> and <code class="docutils literal notranslate"><span class="pre">X-Container-Meta-Temp-URL-Key-2</span></code>.
Signatures are checked against account and container keys, if
present.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">GET</span></code> TempURLs, a <code class="docutils literal notranslate"><span class="pre">Content-Disposition</span></code> header will be set on the
response so that browsers will interpret this as a file attachment to
be saved. The filename chosen is based on the object name, but you
can override this with a filename query parameter. Modifying the
above example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://swift-cluster.example.com/v1/AUTH_account/container/object?
temp_url_sig=732fcac368abb10c78a4cbe95c3fab7f311584532bf779abd5074e13cbe8b88b&amp;
temp_url_expires=1512508563&amp;filename=My+Test+File.pdf
</pre></div>
</div>
<p>If you do not want the object to be downloaded, you can cause
<code class="docutils literal notranslate"><span class="pre">Content-Disposition:</span> <span class="pre">inline</span></code> to be set on the response by adding the
<code class="docutils literal notranslate"><span class="pre">inline</span></code> parameter to the query string, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://swift-cluster.example.com/v1/AUTH_account/container/object?
temp_url_sig=732fcac368abb10c78a4cbe95c3fab7f311584532bf779abd5074e13cbe8b88b&amp;
temp_url_expires=1512508563&amp;inline
</pre></div>
</div>
<p>In some cases, the client might not able to present the content of the object,
but you still want the content able to save to local with the specific
filename. So you can cause <code class="docutils literal notranslate"><span class="pre">Content-Disposition:</span> <span class="pre">inline;</span> <span class="pre">filename=...</span></code> to be
set on the response by adding the <code class="docutils literal notranslate"><span class="pre">inline&amp;filename=...</span></code> parameter to the
query string, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://swift-cluster.example.com/v1/AUTH_account/container/object?
temp_url_sig=732fcac368abb10c78a4cbe95c3fab7f311584532bf779abd5074e13cbe8b88b&amp;
temp_url_expires=1512508563&amp;inline&amp;filename=My+Test+File.pdf
</pre></div>
</div>
</section>
<section id="cluster-configuration">
<h3>Cluster Configuration<a class="headerlink" href="#cluster-configuration" title="Permalink to this heading">¶</a></h3>
<p>This middleware understands the following configuration settings:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">incoming_remove_headers</span></code></dt><dd><p>A whitespace-delimited list of the headers to remove from
incoming requests. Names may optionally end with <code class="docutils literal notranslate"><span class="pre">*</span></code> to
indicate a prefix match. <code class="docutils literal notranslate"><span class="pre">incoming_allow_headers</span></code> is a
list of exceptions to these removals.
Default: <code class="docutils literal notranslate"><span class="pre">x-timestamp</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">incoming_allow_headers</span></code></dt><dd><p>A whitespace-delimited list of the headers allowed as
exceptions to <code class="docutils literal notranslate"><span class="pre">incoming_remove_headers</span></code>. Names may
optionally end with <code class="docutils literal notranslate"><span class="pre">*</span></code> to indicate a prefix match.</p>
<p>Default: None</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">outgoing_remove_headers</span></code></dt><dd><p>A whitespace-delimited list of the headers to remove from
outgoing responses. Names may optionally end with <code class="docutils literal notranslate"><span class="pre">*</span></code> to
indicate a prefix match. <code class="docutils literal notranslate"><span class="pre">outgoing_allow_headers</span></code> is a
list of exceptions to these removals.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">x-object-meta-*</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">outgoing_allow_headers</span></code></dt><dd><p>A whitespace-delimited list of the headers allowed as
exceptions to <code class="docutils literal notranslate"><span class="pre">outgoing_remove_headers</span></code>. Names may
optionally end with <code class="docutils literal notranslate"><span class="pre">*</span></code> to indicate a prefix match.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">x-object-meta-public-*</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">methods</span></code></dt><dd><p>A whitespace delimited list of request methods that are
allowed to be used with a temporary URL.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">HEAD</span> <span class="pre">PUT</span> <span class="pre">POST</span> <span class="pre">DELETE</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">allowed_digests</span></code></dt><dd><p>A whitespace delimited list of digest algorithms that are allowed
to be used when calculating the signature for a temporary URL.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">sha256</span> <span class="pre">sha512</span></code></p>
</dd>
</dl>
</section>
<dl class="py data">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.DEFAULT_INCOMING_ALLOW_HEADERS">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.tempurl.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_INCOMING_ALLOW_HEADERS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#swift.common.middleware.tempurl.DEFAULT_INCOMING_ALLOW_HEADERS" title="Permalink to this definition">¶</a></dt>
<dd><p>Default headers as exceptions to DEFAULT_INCOMING_REMOVE_HEADERS. Simply a
whitespace delimited list of header names and names can optionally end with
‘*’ to indicate a prefix match.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.DEFAULT_INCOMING_REMOVE_HEADERS">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.tempurl.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_INCOMING_REMOVE_HEADERS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'x-timestamp'</span></em><a class="headerlink" href="#swift.common.middleware.tempurl.DEFAULT_INCOMING_REMOVE_HEADERS" title="Permalink to this definition">¶</a></dt>
<dd><p>Default headers to remove from incoming requests. Simply a whitespace
delimited list of header names and names can optionally end with ‘*’ to
indicate a prefix match. DEFAULT_INCOMING_ALLOW_HEADERS is a list of
exceptions to these removals.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.DEFAULT_OUTGOING_ALLOW_HEADERS">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.tempurl.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_OUTGOING_ALLOW_HEADERS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'x-object-meta-public-*'</span></em><a class="headerlink" href="#swift.common.middleware.tempurl.DEFAULT_OUTGOING_ALLOW_HEADERS" title="Permalink to this definition">¶</a></dt>
<dd><p>Default headers as exceptions to DEFAULT_OUTGOING_REMOVE_HEADERS. Simply a
whitespace delimited list of header names and names can optionally end with
‘*’ to indicate a prefix match.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.DEFAULT_OUTGOING_REMOVE_HEADERS">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.tempurl.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_OUTGOING_REMOVE_HEADERS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'x-object-meta-*'</span></em><a class="headerlink" href="#swift.common.middleware.tempurl.DEFAULT_OUTGOING_REMOVE_HEADERS" title="Permalink to this definition">¶</a></dt>
<dd><p>Default headers to remove from outgoing responses. Simply a whitespace
delimited list of header names and names can optionally end with ‘*’ to
indicate a prefix match. DEFAULT_OUTGOING_ALLOW_HEADERS is a list of
exceptions to these removals.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.tempurl.</span></span><span class="sig-name descname"><span class="pre">TempURL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>WSGI Middleware to grant temporary URLs specific access to Swift
resources. See the overview for more information.</p>
<p>The proxy logs created for any subrequests made will have swift.source set
to “TU”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> – The next WSGI filter or app in the paste.deploy
chain.</p></li>
<li><p><strong>conf</strong> – The configuration dict for the middleware.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.agent">
<span class="sig-name descname"><span class="pre">agent</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.agent" title="Permalink to this definition">¶</a></dt>
<dd><p>HTTP user agent to use for subrequests.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.app">
<span class="sig-name descname"><span class="pre">app</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.app" title="Permalink to this definition">¶</a></dt>
<dd><p>The next WSGI application/filter in the paste.deploy pipeline.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.conf">
<span class="sig-name descname"><span class="pre">conf</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.conf" title="Permalink to this definition">¶</a></dt>
<dd><p>The filter configuration dict.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.incoming_allow_headers">
<span class="sig-name descname"><span class="pre">incoming_allow_headers</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.incoming_allow_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Headers to allow in incoming requests. Uppercase WSGI env style,
like <cite>HTTP_X_MATCHES_REMOVE_PREFIX_BUT_OKAY</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.incoming_allow_headers_startswith">
<span class="sig-name descname"><span class="pre">incoming_allow_headers_startswith</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.incoming_allow_headers_startswith" title="Permalink to this definition">¶</a></dt>
<dd><p>Header with match prefixes to allow in incoming requests. Uppercase
WSGI env style, like <cite>HTTP_X_MATCHES_REMOVE_PREFIX_BUT_OKAY_*</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.incoming_remove_headers">
<span class="sig-name descname"><span class="pre">incoming_remove_headers</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.incoming_remove_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Headers to remove from incoming requests. Uppercase WSGI env style,
like <cite>HTTP_X_PRIVATE</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.incoming_remove_headers_startswith">
<span class="sig-name descname"><span class="pre">incoming_remove_headers_startswith</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.incoming_remove_headers_startswith" title="Permalink to this definition">¶</a></dt>
<dd><p>Header with match prefixes to remove from incoming requests.
Uppercase WSGI env style, like <cite>HTTP_X_SENSITIVE_*</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.outgoing_allow_headers">
<span class="sig-name descname"><span class="pre">outgoing_allow_headers</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.outgoing_allow_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Headers to allow in outgoing responses. Lowercase, like
<cite>x-matches-remove-prefix-but-okay</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.outgoing_allow_headers_startswith">
<span class="sig-name descname"><span class="pre">outgoing_allow_headers_startswith</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.outgoing_allow_headers_startswith" title="Permalink to this definition">¶</a></dt>
<dd><p>Header with match prefixes to allow in outgoing responses.
Lowercase, like <cite>x-matches-remove-prefix-but-okay-*</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.outgoing_remove_headers">
<span class="sig-name descname"><span class="pre">outgoing_remove_headers</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.outgoing_remove_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Headers to remove from outgoing responses. Lowercase, like
<cite>x-account-meta-temp-url-key</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.TempURL.outgoing_remove_headers_startswith">
<span class="sig-name descname"><span class="pre">outgoing_remove_headers_startswith</span></span><a class="headerlink" href="#swift.common.middleware.tempurl.TempURL.outgoing_remove_headers_startswith" title="Permalink to this definition">¶</a></dt>
<dd><p>Header with match prefixes to remove from outgoing responses.
Lowercase, like <cite>x-account-meta-private-*</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="swift.common.middleware.tempurl.filter_factory">
<span class="sig-prename descclassname"><span class="pre">swift.common.middleware.tempurl.</span></span><span class="sig-name descname"><span class="pre">filter_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_conf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">local_conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.tempurl.filter_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the WSGI filter for use with paste.deploy.</p>
</dd></dl>

</section>
<section id="module-swift.common.middleware.versioned_writes.legacy">
<span id="id19"></span><span id="versioned-writes"></span><h2>Versioned Writes<a class="headerlink" href="#module-swift.common.middleware.versioned_writes.legacy" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This middleware supports two legacy modes of object versioning that is
now replaced by a new mode. It is recommended to use the new
<a class="reference internal" href="#object-versioning"><span class="std std-ref">Object Versioning</span></a> mode for new containers.</p>
</div>
<p>Object versioning in swift is implemented by setting a flag on the container
to tell swift to version all objects in the container. The value of the flag is
the URL-encoded container name where the versions are stored (commonly referred
to as the “archive container”). The flag itself is one of two headers, which
determines how object <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> requests are handled:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">X-History-Location</span></code></p>
<p>On <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, copy the current version of the object to the archive
container, write a zero-byte “delete marker” object that notes when the
delete took place, and delete the object from the versioned container. The
object will no longer appear in container listings for the versioned
container and future requests there will return <code class="docutils literal notranslate"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code>. However,
the content will still be recoverable from the archive container.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">X-Versions-Location</span></code></p>
<p>On <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, only remove the current version of the object. If any
previous versions exist in the archive container, the most recent one is
copied over the current version, and the copy in the archive container is
deleted. As a result, if you have 5 total versions of the object, you must
delete the object 5 times for that object name to start responding with
<code class="docutils literal notranslate"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code>.</p>
</li>
</ul>
<p>Either header may be used for the various containers within an account, but
only one may be set for any given container. Attempting to set both
simulataneously will result in a <code class="docutils literal notranslate"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></code> response.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended to use a different archive container for
each container that is being versioned.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Enabling versioning on an archive container is not recommended.</p>
</div>
<p>When data is <code class="docutils literal notranslate"><span class="pre">PUT</span></code> into a versioned container (a container with the
versioning flag turned on), the existing data in the file is redirected to a
new object in the archive container and the data in the <code class="docutils literal notranslate"><span class="pre">PUT</span></code> request is
saved as the data for the versioned object. The new object name (for the
previous version) is <code class="docutils literal notranslate"><span class="pre">&lt;archive_container&gt;/&lt;length&gt;&lt;object_name&gt;/&lt;timestamp&gt;</span></code>,
where <code class="docutils literal notranslate"><span class="pre">length</span></code> is the 3-character zero-padded hexadecimal length of the
<code class="docutils literal notranslate"><span class="pre">&lt;object_name&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;timestamp&gt;</span></code> is the timestamp of when the previous
version was created.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">GET</span></code> to a versioned object will return the current version of the object
without having to do any request redirects or metadata lookups.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">POST</span></code> to a versioned object will update the object metadata as normal,
but will not create a new version of the object. In other words, new versions
are only created when the content of the object changes.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> to a versioned object will be handled in one of two ways,
as described above.</p>
<p>To restore a previous version of an object, find the desired version in the
archive container then issue a <code class="docutils literal notranslate"><span class="pre">COPY</span></code> with a <code class="docutils literal notranslate"><span class="pre">Destination</span></code> header
indicating the original location. This will archive the current version similar
to a <code class="docutils literal notranslate"><span class="pre">PUT</span></code> over the versioned object. If the client additionally wishes to
permanently delete what was the current version, it must find the newly-created
archive in the archive container and issue a separate <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> to it.</p>
<section id="id20">
<h3>How to Enable Object Versioning in a Swift Cluster<a class="headerlink" href="#id20" title="Permalink to this heading">¶</a></h3>
<p>This middleware was written as an effort to refactor parts of the proxy server,
so this functionality was already available in previous releases and every
attempt was made to maintain backwards compatibility. To allow operators to
perform a seamless upgrade, it is not required to add the middleware to the
proxy pipeline and the flag <code class="docutils literal notranslate"><span class="pre">allow_versions</span></code> in the container server
configuration files are still valid, but only when using
<code class="docutils literal notranslate"><span class="pre">X-Versions-Location</span></code>. In future releases, <code class="docutils literal notranslate"><span class="pre">allow_versions</span></code> will be
deprecated in favor of adding this middleware to the pipeline to enable or
disable the feature.</p>
<p>In case the middleware is added to the proxy pipeline, you must also
set <code class="docutils literal notranslate"><span class="pre">allow_versioned_writes</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> in the middleware options
to enable the information about this middleware to be returned in a /info
request.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You need to add the middleware to the proxy pipeline and set
<code class="docutils literal notranslate"><span class="pre">allow_versioned_writes</span> <span class="pre">=</span> <span class="pre">True</span></code> to use <code class="docutils literal notranslate"><span class="pre">X-History-Location</span></code>. Setting
<code class="docutils literal notranslate"><span class="pre">allow_versions</span> <span class="pre">=</span> <span class="pre">True</span></code> in the container server is not sufficient to
enable the use of <code class="docutils literal notranslate"><span class="pre">X-History-Location</span></code>.</p>
</div>
<section id="upgrade-considerations">
<h4>Upgrade considerations<a class="headerlink" href="#upgrade-considerations" title="Permalink to this heading">¶</a></h4>
<p>If <code class="docutils literal notranslate"><span class="pre">allow_versioned_writes</span></code> is set in the filter configuration, you can leave
the <code class="docutils literal notranslate"><span class="pre">allow_versions</span></code> flag in the container server configuration files
untouched. If you decide to disable or remove the <code class="docutils literal notranslate"><span class="pre">allow_versions</span></code> flag, you
must re-set any existing containers that had the <code class="docutils literal notranslate"><span class="pre">X-Versions-Location</span></code> flag
configured so that it can now be tracked by the versioned_writes middleware.</p>
<p>Clients should not use the <code class="docutils literal notranslate"><span class="pre">X-History-Location</span></code> header until all proxies in
the cluster have been upgraded to a version of Swift that supports it.
Attempting to use <code class="docutils literal notranslate"><span class="pre">X-History-Location</span></code> during a rolling upgrade may result
in some requests being served by proxies running old code, leading to data
loss.</p>
</section>
</section>
<section id="examples-using-curl-with-x-versions-location">
<h3>Examples Using <code class="docutils literal notranslate"><span class="pre">curl</span></code> with <code class="docutils literal notranslate"><span class="pre">X-Versions-Location</span></code><a class="headerlink" href="#examples-using-curl-with-x-versions-location" title="Permalink to this heading">¶</a></h3>
<p>First, create a container with the <code class="docutils literal notranslate"><span class="pre">X-Versions-Location</span></code> header or add the
header to an existing container. Also make sure the container referenced by
the <code class="docutils literal notranslate"><span class="pre">X-Versions-Location</span></code> exists. In this example, the name of that
container is “versions”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XPUT</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Versions-Location: versions&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XPUT</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">versions</span>
</pre></div>
</div>
<p>Create an object (the first version):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XPUT</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">binary</span> <span class="mi">1</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span>
</pre></div>
</div>
<p>Now create a new version of that object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XPUT</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">binary</span> <span class="mi">2</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span>
</pre></div>
</div>
<p>See a listing of the older versions of the object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -i -H &quot;X-Auth-Token: &lt;token&gt;&quot; http://&lt;storage_url&gt;/versions?prefix=008myobject/
</pre></div>
</div>
<p>Now delete the current version of the object and see that the older version is
gone from ‘versions’ container and back in ‘container’ container:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -i -XDELETE -H &quot;X-Auth-Token: &lt;token&gt;&quot; http://&lt;storage_url&gt;/container/myobject
curl -i -H &quot;X-Auth-Token: &lt;token&gt;&quot; http://&lt;storage_url&gt;/versions?prefix=008myobject/
curl -i -XGET -H &quot;X-Auth-Token: &lt;token&gt;&quot; http://&lt;storage_url&gt;/container/myobject
</pre></div>
</div>
</section>
<section id="examples-using-curl-with-x-history-location">
<h3>Examples Using <code class="docutils literal notranslate"><span class="pre">curl</span></code> with <code class="docutils literal notranslate"><span class="pre">X-History-Location</span></code><a class="headerlink" href="#examples-using-curl-with-x-history-location" title="Permalink to this heading">¶</a></h3>
<p>As above, create a container with the <code class="docutils literal notranslate"><span class="pre">X-History-Location</span></code> header and ensure
that the container referenced by the <code class="docutils literal notranslate"><span class="pre">X-History-Location</span></code> exists. In this
example, the name of that container is “versions”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XPUT</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-History-Location: versions&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XPUT</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">versions</span>
</pre></div>
</div>
<p>Create an object (the first version):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XPUT</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">binary</span> <span class="mi">1</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span>
</pre></div>
</div>
<p>Now create a new version of that object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XPUT</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">binary</span> <span class="mi">2</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span>
</pre></div>
</div>
<p>Now delete the current version of the object. Subsequent requests will 404:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XDELETE</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span><span class="o">/</span><span class="n">myobject</span>
</pre></div>
</div>
<p>A listing of the older versions of the object will include both the first and
second versions of the object, as well as a “delete marker” object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -i -H &quot;X-Auth-Token: &lt;token&gt;&quot; http://&lt;storage_url&gt;/versions?prefix=008myobject/
</pre></div>
</div>
<p>To restore a previous version, simply <code class="docutils literal notranslate"><span class="pre">COPY</span></code> it from the archive container:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XCOPY</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">versions</span><span class="o">/</span><span class="mi">008</span><span class="n">myobject</span><span class="o">/&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Destination: container/myobject&quot;</span>
</pre></div>
</div>
<p>Note that the archive container still has all previous versions of the object,
including the source for the restore:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -i -H &quot;X-Auth-Token: &lt;token&gt;&quot; http://&lt;storage_url&gt;/versions?prefix=008myobject/
</pre></div>
</div>
<p>To permanently delete a previous version, <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> it from the archive
container:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XDELETE</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">versions</span><span class="o">/</span><span class="mi">008</span><span class="n">myobject</span><span class="o">/&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="how-to-disable-object-versioning-in-a-swift-cluster">
<h3>How to Disable Object Versioning in a Swift Cluster<a class="headerlink" href="#how-to-disable-object-versioning-in-a-swift-cluster" title="Permalink to this heading">¶</a></h3>
<p>If you want to disable all functionality, set <code class="docutils literal notranslate"><span class="pre">allow_versioned_writes</span></code> to
<code class="docutils literal notranslate"><span class="pre">False</span></code> in the middleware options.</p>
<p>Disable versioning from a container (x is any value except empty):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">XPOST</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Auth-Token: &lt;token&gt;&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;X-Remove-Versions-Location: x&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">storage_url</span><span class="o">&gt;/</span><span class="n">container</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.legacy.VersionedWritesContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">swift.common.middleware.versioned_writes.legacy.</span></span><span class="sig-name descname"><span class="pre">VersionedWritesContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wsgi_app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.legacy.VersionedWritesContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="misc.html#swift.common.wsgi.WSGIContext" title="swift.common.wsgi.WSGIContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WSGIContext</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.legacy.VersionedWritesContext.handle_obj_versions_delete_pop">
<span class="sig-name descname"><span class="pre">handle_obj_versions_delete_pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions_cont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.legacy.VersionedWritesContext.handle_obj_versions_delete_pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle DELETE requests when in stack mode.</p>
<p>Delete current version of object and pop previous version in its place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – original request.</p></li>
<li><p><strong>versions_cont</strong> – container where previous versions of the object
are stored.</p></li>
<li><p><strong>api_version</strong> – api version.</p></li>
<li><p><strong>account_name</strong> – account name.</p></li>
<li><p><strong>container_name</strong> – container name.</p></li>
<li><p><strong>object_name</strong> – object name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.legacy.VersionedWritesContext.handle_obj_versions_delete_push">
<span class="sig-name descname"><span class="pre">handle_obj_versions_delete_push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions_cont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.legacy.VersionedWritesContext.handle_obj_versions_delete_push" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle DELETE requests when in history mode.</p>
<p>Copy current version of object to versions_container and write a
delete marker before proceeding with original request.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – original request.</p></li>
<li><p><strong>versions_cont</strong> – container where previous versions of the object
are stored.</p></li>
<li><p><strong>api_version</strong> – api version.</p></li>
<li><p><strong>account_name</strong> – account name.</p></li>
<li><p><strong>object_name</strong> – name of object of original request</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swift.common.middleware.versioned_writes.legacy.VersionedWritesContext.handle_obj_versions_put">
<span class="sig-name descname"><span class="pre">handle_obj_versions_put</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versions_cont</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.versioned_writes.legacy.VersionedWritesContext.handle_obj_versions_put" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy current version of object to versions_container before proceeding
with original request.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>req</strong> – original request.</p></li>
<li><p><strong>versions_cont</strong> – container where previous versions of the object
are stored.</p></li>
<li><p><strong>api_version</strong> – api version.</p></li>
<li><p><strong>account_name</strong> – account name.</p></li>
<li><p><strong>object_name</strong> – name of object of original request</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-swift.common.middleware.xprofile">
<span id="xprofile"></span><h2>XProfile<a class="headerlink" href="#module-swift.common.middleware.xprofile" title="Permalink to this heading">¶</a></h2>
<p>Profiling middleware for Swift Servers.</p>
<p>The current implementation is based on eventlet aware profiler.(For the
future, more profilers could be added in to collect more data for analysis.)
Profiling all incoming requests and accumulating cpu timing statistics
information for performance tuning and optimization. An mini web UI is also
provided for profiling data analysis. It can be accessed from the URL as
below.</p>
<p>Index page for browse profile data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">SERVER_IP</span><span class="p">:</span><span class="n">PORT</span><span class="o">/</span><span class="n">__profile__</span>
</pre></div>
</div>
<p>List all profiles to return profile ids in json format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">SERVER_IP</span><span class="p">:</span><span class="n">PORT</span><span class="o">/</span><span class="n">__profile__</span><span class="o">/</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">SERVER_IP</span><span class="p">:</span><span class="n">PORT</span><span class="o">/</span><span class="n">__profile__</span><span class="o">/</span><span class="nb">all</span>
</pre></div>
</div>
<p>Retrieve specific profile data in different formats:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://SERVER_IP:PORT/__profile__/PROFILE_ID?format=[default|json|csv|ods]
http://SERVER_IP:PORT/__profile__/current?format=[default|json|csv|ods]
http://SERVER_IP:PORT/__profile__/all?format=[default|json|csv|ods]
</pre></div>
</div>
<p>Retrieve metrics from specific function in json format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://SERVER_IP:PORT/__profile__/PROFILE_ID/NFL?format=json
http://SERVER_IP:PORT/__profile__/current/NFL?format=json
http://SERVER_IP:PORT/__profile__/all/NFL?format=json

NFL is defined by concatenation of file name, function name and the first
line number.
e.g.::
    account.py:50(GETorHEAD)
or with full path:
    opt/stack/swift/swift/proxy/controllers/account.py:50(GETorHEAD)

A list of URL examples:

http://localhost:8080/__profile__    (proxy server)
http://localhost:6200/__profile__/all    (object server)
http://localhost:6201/__profile__/current    (container server)
http://localhost:6202/__profile__/12345?format=json    (account server)
</pre></div>
</div>
<p>The profiling middleware can be configured in paste file for WSGI servers such
as proxy, account, container and object servers. Please refer to the sample
configuration files in etc directory.</p>
<p>The profiling data is provided with four formats such as binary(by default),
json, csv and odf spreadsheet which requires installing odfpy library:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">odfpy</span>
</pre></div>
</div>
<p>There’s also a simple visualization capability which is enabled by using
matplotlib toolkit. it is also required to be installed if you want to use
it to visualize statistic data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">matplotlib</span>
</pre></div>
</div>
</section>
</section>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="misc.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Misc"></i></a>
          
          
            <a href="audit_watchers.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Object Audit Watchers"></i></a>
          
          <a id="pdfLink2" href="" target="_blank" title="Download the manuals as PDF"><i class="fa fa-file-pdf-o" data-toggle="tooltip" data-placement="top" title="Download PDF"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">this page last updated: 2022-03-31 16:36:32</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="https://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the
                 document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="OpenStack Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/id/">Bahasa Indonesia (Indonesian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/it/">Italiano (Italian)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/tr_TR/">Türkçe (Türkiye)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="https://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Swift 0.1.0.dev10164</h4></a>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/object_api_v1_overview.html">Object Storage API overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_architecture.html">Swift Architectural Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_ring.html">The Rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_policies.html">Storage Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_reaper.html">The Account Reaper</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_auth.html">The Auth System</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_acl.html">Access Control Lists (ACLs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_replication.html">Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="ratelimit.html">Rate Limiting</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_large_objects.html">Large Object Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_global_cluster.html">Global Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_container_sync.html">Container to Container Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_expiring_objects.html">Expiring Object Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="cors.html">CORS</a></li>
<li class="toctree-l1"><a class="reference internal" href="crossdomain.html">Cross-domain Policy File</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_erasure_code.html">Erasure Code Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_encryption.html">Object Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_backing_store.html">Using Swift as Backing Store for Service Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_container_sharding.html">Container Sharding</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_background.html">Building a Consistent Hashing Ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_partpower.html">Modifying Ring Partition Power</a></li>
<li class="toctree-l1"><a class="reference internal" href="associated_projects.html">Associated Projects</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html">Contributing to OpenStack Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#swift-design-principles">Swift Design Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#recommended-workflow">Recommended workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#notes-on-testing">Notes on Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#ideas">Ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/contributing.html#community">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributor/review_guidelines.html">Review Guidelines</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development_guidelines.html">Development Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_saio.html">SAIO (Swift All In One)</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_contribution_swift.html">First Contribution to Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies_saio.html">Adding Storage Policies to an Existing SAIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_auth.html">Auth Server and Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_middleware.html">Middleware and Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_ondisk_backends.html">Pluggable On-Disk Back-end APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_watchers.html">Auditor Watchers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deployment_guide.html">Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_deployment_guide.html">Apache Deployment Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin_guide.html">Administrator’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="replication_network.html">Dedicated replication network</a></li>
<li class="toctree-l1"><a class="reference internal" href="logs.html">Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops_runbook/index.html">Swift Ops Runbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin/index.html">OpenStack Swift Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="install/index.html">Object Storage Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="config/index.html">Configuration Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/object_api_v1_overview.html">Object Storage API overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/discoverability.html">Discoverability</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/container_quotas.html">Container quotas</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/object_versioning.html">Object versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/large_objects.html">Large objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/temporary_url_middleware.html">Temporary URL middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/form_post_middleware.html">Form POST middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/use_content-encoding_metadata.html">Use Content-Encoding metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/use_the_content-disposition_metadata.html">Use the Content-Disposition metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pseudo-hierarchical-folders-directories.html">Pseudo-hierarchical folders and directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pagination.html">Page through large lists of containers or objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/serialized-response-formats.html">Serialized response formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/static-website.html">Create static website</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/object-expiration.html">Object expiration</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/bulk-delete.html">Bulk delete</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="s3_compat.html">S3/Swift REST API Comparison Matrix</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ring.html">Partitioned Consistent Hash Ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy.html">Proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="account.html">Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="container.html">Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="db.html">Account DB and Container DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="object.html">Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Misc</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Middleware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.account_quotas">Account Quotas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.s3api.s3api">AWS S3 Api</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.backend_ratelimit">Backend Ratelimit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.bulk">Bulk Operations (Delete and Archive Auto Extraction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.catch_errors">CatchErrors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.cname_lookup">CNAME Lookup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.container_quotas">Container Quotas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.container_sync">Container Sync Middleware</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.crossdomain">Cross Domain Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#discoverability">Discoverability</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.domain_remap">Domain Remap</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dynamic-large-objects">Dynamic Large Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#encryption">Encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.etag_quoter">Etag Quoter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#formpost">FormPost</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gatekeeper">GateKeeper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#healthcheck">Healthcheck</a></li>
<li class="toctree-l2"><a class="reference internal" href="#keymaster">Keymaster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#keystoneauth">KeystoneAuth</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.list_endpoints">List Endpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.memcache">Memcache</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.name_check">Name Check (Forbidden Character Filter)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.versioned_writes.object_versioning">Object Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.proxy_logging">Proxy Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.ratelimit">Ratelimit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.read_only">Read Only</a></li>
<li class="toctree-l2"><a class="reference internal" href="#recon">Recon</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.copy">Server Side Copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#static-large-objects">Static Large Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#staticweb">StaticWeb</a></li>
<li class="toctree-l2"><a class="reference internal" href="#symlink">Symlink</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.tempauth">TempAuth</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tempurl">TempURL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.versioned_writes.legacy">Versioned Writes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-swift.common.middleware.xprofile">XProfile</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="audit_watchers.html">Object Audit Watchers</a></li>
</ul>

    </div>

  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="local-table-of-contents">
      <h4 class="docs-sidebar-section-title">Page Contents</h4>
      <ul>
<li><a class="reference internal" href="#">Middleware</a><ul>
<li><a class="reference internal" href="#module-swift.common.middleware.account_quotas">Account Quotas</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.account_quotas.AccountQuotaMiddleware"><code class="docutils literal notranslate"><span class="pre">AccountQuotaMiddleware</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.account_quotas.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.s3api.s3api">AWS S3 Api</a><ul>
<li><a class="reference internal" href="#deployment">Deployment</a><ul>
<li><a class="reference internal" href="#proxy-server-setting">Proxy-Server Setting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#constraints">Constraints</a></li>
<li><a class="reference internal" href="#supported-api">Supported API</a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3api.S3ApiMiddleware"><code class="docutils literal notranslate"><span class="pre">S3ApiMiddleware</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3api.S3ApiMiddleware.check_filter_order"><code class="docutils literal notranslate"><span class="pre">S3ApiMiddleware.check_filter_order()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3api.S3ApiMiddleware.check_pipeline"><code class="docutils literal notranslate"><span class="pre">S3ApiMiddleware.check_pipeline()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3api.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
<li><a class="reference internal" href="#s3-token-middleware">S3 Token Middleware</a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3token.S3Token"><code class="docutils literal notranslate"><span class="pre">S3Token</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3token.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.HashingInput"><code class="docutils literal notranslate"><span class="pre">HashingInput</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3AclRequest"><code class="docutils literal notranslate"><span class="pre">S3AclRequest</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3AclRequest.authenticate"><code class="docutils literal notranslate"><span class="pre">S3AclRequest.authenticate()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3AclRequest.get_acl_response"><code class="docutils literal notranslate"><span class="pre">S3AclRequest.get_acl_response()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3AclRequest.get_response"><code class="docutils literal notranslate"><span class="pre">S3AclRequest.get_response()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3AclRequest.to_swift_req"><code class="docutils literal notranslate"><span class="pre">S3AclRequest.to_swift_req()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request"><code class="docutils literal notranslate"><span class="pre">S3Request</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request.body"><code class="docutils literal notranslate"><span class="pre">S3Request.body</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request.bucket_acl"><code class="docutils literal notranslate"><span class="pre">S3Request.bucket_acl</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request.check_copy_source"><code class="docutils literal notranslate"><span class="pre">S3Request.check_copy_source()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request.get_container_info"><code class="docutils literal notranslate"><span class="pre">S3Request.get_container_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request.get_response"><code class="docutils literal notranslate"><span class="pre">S3Request.get_response()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request.object_acl"><code class="docutils literal notranslate"><span class="pre">S3Request.object_acl</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request.timestamp"><code class="docutils literal notranslate"><span class="pre">S3Request.timestamp</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request.to_swift_req"><code class="docutils literal notranslate"><span class="pre">S3Request.to_swift_req()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.S3Request.xml"><code class="docutils literal notranslate"><span class="pre">S3Request.xml()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.SigV4Mixin"><code class="docutils literal notranslate"><span class="pre">SigV4Mixin</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.SigV4Mixin.timestamp"><code class="docutils literal notranslate"><span class="pre">SigV4Mixin.timestamp</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.SigV4Request"><code class="docutils literal notranslate"><span class="pre">SigV4Request</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.SigV4S3AclRequest"><code class="docutils literal notranslate"><span class="pre">SigV4S3AclRequest</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3request.get_request_class"><code class="docutils literal notranslate"><span class="pre">get_request_class()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.AccessDenied"><code class="docutils literal notranslate"><span class="pre">AccessDenied</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.AccountProblem"><code class="docutils literal notranslate"><span class="pre">AccountProblem</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.AmbiguousGrantByEmailAddress"><code class="docutils literal notranslate"><span class="pre">AmbiguousGrantByEmailAddress</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.AuthorizationHeaderMalformed"><code class="docutils literal notranslate"><span class="pre">AuthorizationHeaderMalformed</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.AuthorizationQueryParametersError"><code class="docutils literal notranslate"><span class="pre">AuthorizationQueryParametersError</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.BadDigest"><code class="docutils literal notranslate"><span class="pre">BadDigest</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.BrokenMPU"><code class="docutils literal notranslate"><span class="pre">BrokenMPU</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.BucketAlreadyExists"><code class="docutils literal notranslate"><span class="pre">BucketAlreadyExists</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.BucketAlreadyOwnedByYou"><code class="docutils literal notranslate"><span class="pre">BucketAlreadyOwnedByYou</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.BucketNotEmpty"><code class="docutils literal notranslate"><span class="pre">BucketNotEmpty</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.CredentialsNotSupported"><code class="docutils literal notranslate"><span class="pre">CredentialsNotSupported</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.CrossLocationLoggingProhibited"><code class="docutils literal notranslate"><span class="pre">CrossLocationLoggingProhibited</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.EntityTooLarge"><code class="docutils literal notranslate"><span class="pre">EntityTooLarge</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.EntityTooSmall"><code class="docutils literal notranslate"><span class="pre">EntityTooSmall</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.ErrorResponse"><code class="docutils literal notranslate"><span class="pre">ErrorResponse</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.ExpiredToken"><code class="docutils literal notranslate"><span class="pre">ExpiredToken</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.HeaderKeyDict"><code class="docutils literal notranslate"><span class="pre">HeaderKeyDict</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.IllegalVersioningConfigurationException"><code class="docutils literal notranslate"><span class="pre">IllegalVersioningConfigurationException</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.IncompleteBody"><code class="docutils literal notranslate"><span class="pre">IncompleteBody</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.IncorrectNumberOfFilesInPostRequest"><code class="docutils literal notranslate"><span class="pre">IncorrectNumberOfFilesInPostRequest</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InlineDataTooLarge"><code class="docutils literal notranslate"><span class="pre">InlineDataTooLarge</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InternalError"><code class="docutils literal notranslate"><span class="pre">InternalError</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidAccessKeyId"><code class="docutils literal notranslate"><span class="pre">InvalidAccessKeyId</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidArgument"><code class="docutils literal notranslate"><span class="pre">InvalidArgument</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidBucketName"><code class="docutils literal notranslate"><span class="pre">InvalidBucketName</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidBucketState"><code class="docutils literal notranslate"><span class="pre">InvalidBucketState</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidDigest"><code class="docutils literal notranslate"><span class="pre">InvalidDigest</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidLocationConstraint"><code class="docutils literal notranslate"><span class="pre">InvalidLocationConstraint</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidObjectState"><code class="docutils literal notranslate"><span class="pre">InvalidObjectState</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidPart"><code class="docutils literal notranslate"><span class="pre">InvalidPart</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidPartOrder"><code class="docutils literal notranslate"><span class="pre">InvalidPartOrder</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidPayer"><code class="docutils literal notranslate"><span class="pre">InvalidPayer</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidPolicyDocument"><code class="docutils literal notranslate"><span class="pre">InvalidPolicyDocument</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidRange"><code class="docutils literal notranslate"><span class="pre">InvalidRange</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidRequest"><code class="docutils literal notranslate"><span class="pre">InvalidRequest</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidSOAPRequest"><code class="docutils literal notranslate"><span class="pre">InvalidSOAPRequest</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidSecurity"><code class="docutils literal notranslate"><span class="pre">InvalidSecurity</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidStorageClass"><code class="docutils literal notranslate"><span class="pre">InvalidStorageClass</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidTargetBucketForLogging"><code class="docutils literal notranslate"><span class="pre">InvalidTargetBucketForLogging</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidToken"><code class="docutils literal notranslate"><span class="pre">InvalidToken</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.InvalidURI"><code class="docutils literal notranslate"><span class="pre">InvalidURI</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.KeyTooLongError"><code class="docutils literal notranslate"><span class="pre">KeyTooLongError</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MalformedACLError"><code class="docutils literal notranslate"><span class="pre">MalformedACLError</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MalformedPOSTRequest"><code class="docutils literal notranslate"><span class="pre">MalformedPOSTRequest</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MalformedXML"><code class="docutils literal notranslate"><span class="pre">MalformedXML</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MaxMessageLengthExceeded"><code class="docutils literal notranslate"><span class="pre">MaxMessageLengthExceeded</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MaxPostPreDataLengthExceededError"><code class="docutils literal notranslate"><span class="pre">MaxPostPreDataLengthExceededError</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MetadataTooLarge"><code class="docutils literal notranslate"><span class="pre">MetadataTooLarge</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MethodNotAllowed"><code class="docutils literal notranslate"><span class="pre">MethodNotAllowed</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MissingContentLength"><code class="docutils literal notranslate"><span class="pre">MissingContentLength</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MissingRequestBodyError"><code class="docutils literal notranslate"><span class="pre">MissingRequestBodyError</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MissingSecurityElement"><code class="docutils literal notranslate"><span class="pre">MissingSecurityElement</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.MissingSecurityHeader"><code class="docutils literal notranslate"><span class="pre">MissingSecurityHeader</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.NoLoggingStatusForKey"><code class="docutils literal notranslate"><span class="pre">NoLoggingStatusForKey</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.NoSuchBucket"><code class="docutils literal notranslate"><span class="pre">NoSuchBucket</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.NoSuchKey"><code class="docutils literal notranslate"><span class="pre">NoSuchKey</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.NoSuchLifecycleConfiguration"><code class="docutils literal notranslate"><span class="pre">NoSuchLifecycleConfiguration</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.NoSuchUpload"><code class="docutils literal notranslate"><span class="pre">NoSuchUpload</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.NoSuchVersion"><code class="docutils literal notranslate"><span class="pre">NoSuchVersion</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.NotSignedUp"><code class="docutils literal notranslate"><span class="pre">NotSignedUp</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.NotSuchBucketPolicy"><code class="docutils literal notranslate"><span class="pre">NotSuchBucketPolicy</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.OperationAborted"><code class="docutils literal notranslate"><span class="pre">OperationAborted</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.PermanentRedirect"><code class="docutils literal notranslate"><span class="pre">PermanentRedirect</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.PreconditionFailed"><code class="docutils literal notranslate"><span class="pre">PreconditionFailed</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.Redirect"><code class="docutils literal notranslate"><span class="pre">Redirect</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.RequestIsNotMultiPartContent"><code class="docutils literal notranslate"><span class="pre">RequestIsNotMultiPartContent</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.RequestTimeTooSkewed"><code class="docutils literal notranslate"><span class="pre">RequestTimeTooSkewed</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.RequestTimeout"><code class="docutils literal notranslate"><span class="pre">RequestTimeout</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.RequestTorrentOfBucketError"><code class="docutils literal notranslate"><span class="pre">RequestTorrentOfBucketError</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.RestoreAlreadyInProgress"><code class="docutils literal notranslate"><span class="pre">RestoreAlreadyInProgress</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.S3NotImplemented"><code class="docutils literal notranslate"><span class="pre">S3NotImplemented</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.S3Response"><code class="docutils literal notranslate"><span class="pre">S3Response</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.S3Response.from_swift_resp"><code class="docutils literal notranslate"><span class="pre">S3Response.from_swift_resp()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.S3ResponseBase"><code class="docutils literal notranslate"><span class="pre">S3ResponseBase</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.ServiceUnavailable"><code class="docutils literal notranslate"><span class="pre">ServiceUnavailable</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.SignatureDoesNotMatch"><code class="docutils literal notranslate"><span class="pre">SignatureDoesNotMatch</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.SlowDown"><code class="docutils literal notranslate"><span class="pre">SlowDown</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.TemporaryRedirect"><code class="docutils literal notranslate"><span class="pre">TemporaryRedirect</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.TokenRefreshRequired"><code class="docutils literal notranslate"><span class="pre">TokenRefreshRequired</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.TooManyBuckets"><code class="docutils literal notranslate"><span class="pre">TooManyBuckets</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.UnexpectedContent"><code class="docutils literal notranslate"><span class="pre">UnexpectedContent</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.UnresolvableGrantByEmailAddress"><code class="docutils literal notranslate"><span class="pre">UnresolvableGrantByEmailAddress</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.UserKeyMustBeSpecified"><code class="docutils literal notranslate"><span class="pre">UserKeyMustBeSpecified</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.s3response.VersionedBucketNotEmpty"><code class="docutils literal notranslate"><span class="pre">VersionedBucketNotEmpty</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.exception.ACLError"><code class="docutils literal notranslate"><span class="pre">ACLError</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.exception.InvalidSubresource"><code class="docutils literal notranslate"><span class="pre">InvalidSubresource</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.exception.NotS3Request"><code class="docutils literal notranslate"><span class="pre">NotS3Request</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.exception.S3Exception"><code class="docutils literal notranslate"><span class="pre">S3Exception</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.etree._Element"><code class="docutils literal notranslate"><span class="pre">_Element</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.etree._Element.text"><code class="docutils literal notranslate"><span class="pre">_Element.text</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.utils.Config"><code class="docutils literal notranslate"><span class="pre">Config</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.utils.Config.update"><code class="docutils literal notranslate"><span class="pre">Config.update()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.utils.S3Timestamp"><code class="docutils literal notranslate"><span class="pre">S3Timestamp</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.utils.S3Timestamp.amz_date_format"><code class="docutils literal notranslate"><span class="pre">S3Timestamp.amz_date_format</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.utils.mktime"><code class="docutils literal notranslate"><span class="pre">mktime()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.utils.sysmeta_header"><code class="docutils literal notranslate"><span class="pre">sysmeta_header()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.utils.sysmeta_prefix"><code class="docutils literal notranslate"><span class="pre">sysmeta_prefix()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.utils.validate_bucket_name"><code class="docutils literal notranslate"><span class="pre">validate_bucket_name()</span></code></a></li>
<li><a class="reference internal" href="#s3api-s-acls-implementation">s3api’s ACLs implementation</a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.ACL"><code class="docutils literal notranslate"><span class="pre">ACL</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.ACL.check_owner"><code class="docutils literal notranslate"><span class="pre">ACL.check_owner()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.ACL.check_permission"><code class="docutils literal notranslate"><span class="pre">ACL.check_permission()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.ACL.elem"><code class="docutils literal notranslate"><span class="pre">ACL.elem()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.ACL.from_elem"><code class="docutils literal notranslate"><span class="pre">ACL.from_elem()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.ACL.from_headers"><code class="docutils literal notranslate"><span class="pre">ACL.from_headers()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.AllUsers"><code class="docutils literal notranslate"><span class="pre">AllUsers</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.AuthenticatedUsers"><code class="docutils literal notranslate"><span class="pre">AuthenticatedUsers</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.CannedACL"><code class="docutils literal notranslate"><span class="pre">CannedACL</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.Grant"><code class="docutils literal notranslate"><span class="pre">Grant</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.Grant.elem"><code class="docutils literal notranslate"><span class="pre">Grant.elem()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.Grant.from_elem"><code class="docutils literal notranslate"><span class="pre">Grant.from_elem()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.Grantee"><code class="docutils literal notranslate"><span class="pre">Grantee</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.Grantee.elem"><code class="docutils literal notranslate"><span class="pre">Grantee.elem()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.Grantee.from_header"><code class="docutils literal notranslate"><span class="pre">Grantee.from_header()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.Group"><code class="docutils literal notranslate"><span class="pre">Group</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.Group.elem"><code class="docutils literal notranslate"><span class="pre">Group.elem()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.LogDelivery"><code class="docutils literal notranslate"><span class="pre">LogDelivery</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.Owner"><code class="docutils literal notranslate"><span class="pre">Owner</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.User"><code class="docutils literal notranslate"><span class="pre">User</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.User.elem"><code class="docutils literal notranslate"><span class="pre">User.elem()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.canned_acl_grantees"><code class="docutils literal notranslate"><span class="pre">canned_acl_grantees()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.decode_acl"><code class="docutils literal notranslate"><span class="pre">decode_acl()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.encode_acl"><code class="docutils literal notranslate"><span class="pre">encode_acl()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.subresource.get_group_subclass_from_uri"><code class="docutils literal notranslate"><span class="pre">get_group_subclass_from_uri()</span></code></a></li>
<li><a class="reference internal" href="#acl-handlers">Acl Handlers</a><ul>
<li><a class="reference internal" href="#why-do-we-need-this">Why do we need this</a></li>
<li><a class="reference internal" href="#basic-information">Basic Information</a></li>
<li><a class="reference internal" href="#how-to-extend">How to extend</a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.BaseAclHandler"><code class="docutils literal notranslate"><span class="pre">BaseAclHandler</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.BaseAclHandler.get_acl"><code class="docutils literal notranslate"><span class="pre">BaseAclHandler.get_acl()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.BucketAclHandler"><code class="docutils literal notranslate"><span class="pre">BucketAclHandler</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.MultiObjectDeleteAclHandler"><code class="docutils literal notranslate"><span class="pre">MultiObjectDeleteAclHandler</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.MultiUploadAclHandler"><code class="docutils literal notranslate"><span class="pre">MultiUploadAclHandler</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.ObjectAclHandler"><code class="docutils literal notranslate"><span class="pre">ObjectAclHandler</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.PartAclHandler"><code class="docutils literal notranslate"><span class="pre">PartAclHandler</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.S3AclHandler"><code class="docutils literal notranslate"><span class="pre">S3AclHandler</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.UploadAclHandler"><code class="docutils literal notranslate"><span class="pre">UploadAclHandler</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_handlers.UploadsAclHandler"><code class="docutils literal notranslate"><span class="pre">UploadsAclHandler</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_utils.handle_acl_header"><code class="docutils literal notranslate"><span class="pre">handle_acl_header()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.acl_utils.swift_acl_translate"><code class="docutils literal notranslate"><span class="pre">swift_acl_translate()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller"><code class="docutils literal notranslate"><span class="pre">Controller</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.Controller.resource_type"><code class="docutils literal notranslate"><span class="pre">Controller.resource_type()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.UnsupportedController"><code class="docutils literal notranslate"><span class="pre">UnsupportedController</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.bucket_operation"><code class="docutils literal notranslate"><span class="pre">bucket_operation()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.check_container_existence"><code class="docutils literal notranslate"><span class="pre">check_container_existence()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.base.object_operation"><code class="docutils literal notranslate"><span class="pre">object_operation()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.service.ServiceController"><code class="docutils literal notranslate"><span class="pre">ServiceController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.service.ServiceController.GET"><code class="docutils literal notranslate"><span class="pre">ServiceController.GET()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.bucket.BucketController"><code class="docutils literal notranslate"><span class="pre">BucketController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.bucket.BucketController.DELETE"><code class="docutils literal notranslate"><span class="pre">BucketController.DELETE()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.bucket.BucketController.GET"><code class="docutils literal notranslate"><span class="pre">BucketController.GET()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.bucket.BucketController.HEAD"><code class="docutils literal notranslate"><span class="pre">BucketController.HEAD()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.bucket.BucketController.POST"><code class="docutils literal notranslate"><span class="pre">BucketController.POST()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.bucket.BucketController.PUT"><code class="docutils literal notranslate"><span class="pre">BucketController.PUT()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.obj.ObjectController"><code class="docutils literal notranslate"><span class="pre">ObjectController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.obj.ObjectController.DELETE"><code class="docutils literal notranslate"><span class="pre">ObjectController.DELETE()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.obj.ObjectController.GET"><code class="docutils literal notranslate"><span class="pre">ObjectController.GET()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.obj.ObjectController.HEAD"><code class="docutils literal notranslate"><span class="pre">ObjectController.HEAD()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.obj.ObjectController.PUT"><code class="docutils literal notranslate"><span class="pre">ObjectController.PUT()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.acl.AclController"><code class="docutils literal notranslate"><span class="pre">AclController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.acl.AclController.GET"><code class="docutils literal notranslate"><span class="pre">AclController.GET()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.acl.AclController.PUT"><code class="docutils literal notranslate"><span class="pre">AclController.PUT()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.acl.get_acl"><code class="docutils literal notranslate"><span class="pre">get_acl()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.s3_acl.S3AclController"><code class="docutils literal notranslate"><span class="pre">S3AclController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.s3_acl.S3AclController.GET"><code class="docutils literal notranslate"><span class="pre">S3AclController.GET()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.s3_acl.S3AclController.PUT"><code class="docutils literal notranslate"><span class="pre">S3AclController.PUT()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#bucket-segments">[bucket]+segments</a></li>
<li><a class="reference internal" href="#bucket-segments-upload-id">[bucket]+segments/[upload_id]</a></li>
<li><a class="reference internal" href="#bucket-segments-upload-id-part-number">[bucket]+segments/[upload_id]/[part_number]</a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_upload.PartController"><code class="docutils literal notranslate"><span class="pre">PartController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_upload.PartController.PUT"><code class="docutils literal notranslate"><span class="pre">PartController.PUT()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadController"><code class="docutils literal notranslate"><span class="pre">UploadController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadController.DELETE"><code class="docutils literal notranslate"><span class="pre">UploadController.DELETE()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadController.GET"><code class="docutils literal notranslate"><span class="pre">UploadController.GET()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadController.POST"><code class="docutils literal notranslate"><span class="pre">UploadController.POST()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadsController"><code class="docutils literal notranslate"><span class="pre">UploadsController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadsController.GET"><code class="docutils literal notranslate"><span class="pre">UploadsController.GET()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_upload.UploadsController.POST"><code class="docutils literal notranslate"><span class="pre">UploadsController.POST()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_delete.MultiObjectDeleteController"><code class="docutils literal notranslate"><span class="pre">MultiObjectDeleteController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.multi_delete.MultiObjectDeleteController.POST"><code class="docutils literal notranslate"><span class="pre">MultiObjectDeleteController.POST()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.versioning.VersioningController"><code class="docutils literal notranslate"><span class="pre">VersioningController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.versioning.VersioningController.GET"><code class="docutils literal notranslate"><span class="pre">VersioningController.GET()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.versioning.VersioningController.PUT"><code class="docutils literal notranslate"><span class="pre">VersioningController.PUT()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.location.LocationController"><code class="docutils literal notranslate"><span class="pre">LocationController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.location.LocationController.GET"><code class="docutils literal notranslate"><span class="pre">LocationController.GET()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.logging.LoggingStatusController"><code class="docutils literal notranslate"><span class="pre">LoggingStatusController</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.logging.LoggingStatusController.GET"><code class="docutils literal notranslate"><span class="pre">LoggingStatusController.GET()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.s3api.controllers.logging.LoggingStatusController.PUT"><code class="docutils literal notranslate"><span class="pre">LoggingStatusController.PUT()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.backend_ratelimit">Backend Ratelimit</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.backend_ratelimit.BackendRateLimitMiddleware"><code class="docutils literal notranslate"><span class="pre">BackendRateLimitMiddleware</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.bulk">Bulk Operations (Delete and Archive Auto Extraction)</a><ul>
<li><a class="reference internal" href="#extract-archive">Extract Archive</a></li>
<li><a class="reference internal" href="#content-type">Content Type</a></li>
<li><a class="reference internal" href="#assigning-metadata">Assigning Metadata</a></li>
<li><a class="reference internal" href="#response">Response</a></li>
<li><a class="reference internal" href="#bulk-delete">Bulk Delete</a></li>
<li><a class="reference internal" href="#swift.common.middleware.bulk.CreateContainerError"><code class="docutils literal notranslate"><span class="pre">CreateContainerError</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.bulk.get_response_body"><code class="docutils literal notranslate"><span class="pre">get_response_body()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.catch_errors">CatchErrors</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.catch_errors.BadResponseLength"><code class="docutils literal notranslate"><span class="pre">BadResponseLength</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.catch_errors.CatchErrorMiddleware"><code class="docutils literal notranslate"><span class="pre">CatchErrorMiddleware</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.catch_errors.CatchErrorsContext"><code class="docutils literal notranslate"><span class="pre">CatchErrorsContext</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.catch_errors.enforce_byte_count"><code class="docutils literal notranslate"><span class="pre">enforce_byte_count()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.cname_lookup">CNAME Lookup</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.cname_lookup.CNAMELookupMiddleware"><code class="docutils literal notranslate"><span class="pre">CNAMELookupMiddleware</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.cname_lookup.lookup_cname"><code class="docutils literal notranslate"><span class="pre">lookup_cname()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.container_quotas">Container Quotas</a></li>
<li><a class="reference internal" href="#module-swift.common.middleware.container_sync">Container Sync Middleware</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.container_sync.ContainerSync"><code class="docutils literal notranslate"><span class="pre">ContainerSync</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.crossdomain">Cross Domain Policies</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.crossdomain.CrossDomainMiddleware"><code class="docutils literal notranslate"><span class="pre">CrossDomainMiddleware</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.crossdomain.CrossDomainMiddleware.GET"><code class="docutils literal notranslate"><span class="pre">CrossDomainMiddleware.GET()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#discoverability">Discoverability</a></li>
<li><a class="reference internal" href="#module-swift.common.middleware.domain_remap">Domain Remap</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.domain_remap.DomainRemapMiddleware"><code class="docutils literal notranslate"><span class="pre">DomainRemapMiddleware</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dynamic-large-objects">Dynamic Large Objects</a></li>
<li><a class="reference internal" href="#encryption">Encryption</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.crypto.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.encrypter.EncInputWrapper"><code class="docutils literal notranslate"><span class="pre">EncInputWrapper</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.encrypter.Encrypter"><code class="docutils literal notranslate"><span class="pre">Encrypter</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.encrypter.EncrypterObjContext"><code class="docutils literal notranslate"><span class="pre">EncrypterObjContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.crypto.encrypter.EncrypterObjContext.encrypt_user_metadata"><code class="docutils literal notranslate"><span class="pre">EncrypterObjContext.encrypt_user_metadata()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.encrypter.EncrypterObjContext.handle_post"><code class="docutils literal notranslate"><span class="pre">EncrypterObjContext.handle_post()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.encrypter.encrypt_header_val"><code class="docutils literal notranslate"><span class="pre">encrypt_header_val()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext"><code class="docutils literal notranslate"><span class="pre">BaseDecrypterContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext.decrypt_value"><code class="docutils literal notranslate"><span class="pre">BaseDecrypterContext.decrypt_value()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext.decrypt_value_with_meta"><code class="docutils literal notranslate"><span class="pre">BaseDecrypterContext.decrypt_value_with_meta()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext.get_crypto_meta"><code class="docutils literal notranslate"><span class="pre">BaseDecrypterContext.get_crypto_meta()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext.get_decryption_keys"><code class="docutils literal notranslate"><span class="pre">BaseDecrypterContext.get_decryption_keys()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.BaseDecrypterContext.get_unwrapped_key"><code class="docutils literal notranslate"><span class="pre">BaseDecrypterContext.get_unwrapped_key()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.Decrypter"><code class="docutils literal notranslate"><span class="pre">Decrypter</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.DecrypterContContext"><code class="docutils literal notranslate"><span class="pre">DecrypterContContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.DecrypterContContext.process_json_resp"><code class="docutils literal notranslate"><span class="pre">DecrypterContContext.process_json_resp()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.DecrypterObjContext"><code class="docutils literal notranslate"><span class="pre">DecrypterObjContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.DecrypterObjContext.decrypt_resp_headers"><code class="docutils literal notranslate"><span class="pre">DecrypterObjContext.decrypt_resp_headers()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.DecrypterObjContext.multipart_response_iter"><code class="docutils literal notranslate"><span class="pre">DecrypterObjContext.multipart_response_iter()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.decrypter.DecrypterObjContext.response_iter"><code class="docutils literal notranslate"><span class="pre">DecrypterObjContext.response_iter()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.etag_quoter">Etag Quoter</a></li>
<li><a class="reference internal" href="#formpost">FormPost</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.formpost.FormPost"><code class="docutils literal notranslate"><span class="pre">FormPost</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.formpost.FormPost.app"><code class="docutils literal notranslate"><span class="pre">FormPost.app</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.formpost.FormPost.conf"><code class="docutils literal notranslate"><span class="pre">FormPost.conf</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.formpost.MAX_VALUE_LENGTH"><code class="docutils literal notranslate"><span class="pre">MAX_VALUE_LENGTH</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.formpost.READ_CHUNK_SIZE"><code class="docutils literal notranslate"><span class="pre">READ_CHUNK_SIZE</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.formpost.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gatekeeper">GateKeeper</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.gatekeeper.outbound_exclusions"><code class="docutils literal notranslate"><span class="pre">outbound_exclusions</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#healthcheck">Healthcheck</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.healthcheck.HealthCheckMiddleware"><code class="docutils literal notranslate"><span class="pre">HealthCheckMiddleware</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.healthcheck.HealthCheckMiddleware.DISABLED"><code class="docutils literal notranslate"><span class="pre">HealthCheckMiddleware.DISABLED()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.healthcheck.HealthCheckMiddleware.GET"><code class="docutils literal notranslate"><span class="pre">HealthCheckMiddleware.GET()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#keymaster">Keymaster</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.crypto.keymaster.BaseKeyMaster"><code class="docutils literal notranslate"><span class="pre">BaseKeyMaster</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.crypto.keymaster.BaseKeyMaster.create_key"><code class="docutils literal notranslate"><span class="pre">BaseKeyMaster.create_key()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.keymaster.KeyMaster"><code class="docutils literal notranslate"><span class="pre">KeyMaster</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.crypto.keymaster.KeyMasterContext"><code class="docutils literal notranslate"><span class="pre">KeyMasterContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.crypto.keymaster.KeyMasterContext.fetch_crypto_keys"><code class="docutils literal notranslate"><span class="pre">KeyMasterContext.fetch_crypto_keys()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#keystoneauth">KeystoneAuth</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.keystoneauth.KeystoneAuth"><code class="docutils literal notranslate"><span class="pre">KeystoneAuth</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.keystoneauth.KeystoneAuth.authorize_anonymous"><code class="docutils literal notranslate"><span class="pre">KeystoneAuth.authorize_anonymous()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.keystoneauth.KeystoneAuth.denied_response"><code class="docutils literal notranslate"><span class="pre">KeystoneAuth.denied_response()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.keystoneauth.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.list_endpoints">List Endpoints</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.list_endpoints.ListEndpointsMiddleware"><code class="docutils literal notranslate"><span class="pre">ListEndpointsMiddleware</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.list_endpoints.ListEndpointsMiddleware.get_object_ring"><code class="docutils literal notranslate"><span class="pre">ListEndpointsMiddleware.get_object_ring()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.memcache">Memcache</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.memcache.MemcacheMiddleware"><code class="docutils literal notranslate"><span class="pre">MemcacheMiddleware</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.name_check">Name Check (Forbidden Character Filter)</a></li>
<li><a class="reference internal" href="#module-swift.common.middleware.versioned_writes.object_versioning">Object Versioning</a><ul>
<li><a class="reference internal" href="#compatibility-between-modes">Compatibility between modes</a></li>
<li><a class="reference internal" href="#enable-object-versioning-in-a-container">Enable Object Versioning in a Container</a></li>
<li><a class="reference internal" href="#object-crud-operations-to-a-versioned-container">Object CRUD Operations to a Versioned Container</a></li>
<li><a class="reference internal" href="#object-versioning-api">Object Versioning API</a></li>
<li><a class="reference internal" href="#how-to-enable-object-versioning-in-a-swift-cluster">How to Enable Object Versioning in a Swift Cluster</a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.AccountContext"><code class="docutils literal notranslate"><span class="pre">AccountContext</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ByteCountingReader"><code class="docutils literal notranslate"><span class="pre">ByteCountingReader</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ContainerContext"><code class="docutils literal notranslate"><span class="pre">ContainerContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ContainerContext.handle_delete"><code class="docutils literal notranslate"><span class="pre">ContainerContext.handle_delete()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ContainerContext.handle_request"><code class="docutils literal notranslate"><span class="pre">ContainerContext.handle_request()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext"><code class="docutils literal notranslate"><span class="pre">ObjectContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_delete"><code class="docutils literal notranslate"><span class="pre">ObjectContext.handle_delete()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_post"><code class="docutils literal notranslate"><span class="pre">ObjectContext.handle_post()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_put"><code class="docutils literal notranslate"><span class="pre">ObjectContext.handle_put()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_put_version"><code class="docutils literal notranslate"><span class="pre">ObjectContext.handle_put_version()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectContext.handle_versioned_request"><code class="docutils literal notranslate"><span class="pre">ObjectContext.handle_versioned_request()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.object_versioning.ObjectVersioningContext"><code class="docutils literal notranslate"><span class="pre">ObjectVersioningContext</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.proxy_logging">Proxy Logging</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.proxy_logging.ProxyLoggingMiddleware"><code class="docutils literal notranslate"><span class="pre">ProxyLoggingMiddleware</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.proxy_logging.ProxyLoggingMiddleware.log_request"><code class="docutils literal notranslate"><span class="pre">ProxyLoggingMiddleware.log_request()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.ratelimit">Ratelimit</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.ratelimit.MaxSleepTimeHitError"><code class="docutils literal notranslate"><span class="pre">MaxSleepTimeHitError</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.ratelimit.RateLimitMiddleware"><code class="docutils literal notranslate"><span class="pre">RateLimitMiddleware</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.ratelimit.RateLimitMiddleware.get_ratelimitable_key_tuples"><code class="docutils literal notranslate"><span class="pre">RateLimitMiddleware.get_ratelimitable_key_tuples()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.ratelimit.RateLimitMiddleware.handle_ratelimit"><code class="docutils literal notranslate"><span class="pre">RateLimitMiddleware.handle_ratelimit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.ratelimit.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.ratelimit.get_maxrate"><code class="docutils literal notranslate"><span class="pre">get_maxrate()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.ratelimit.interpret_conf_limits"><code class="docutils literal notranslate"><span class="pre">interpret_conf_limits()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.read_only">Read Only</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.read_only.ReadOnlyMiddleware"><code class="docutils literal notranslate"><span class="pre">ReadOnlyMiddleware</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.read_only.ReadOnlyMiddleware.account_read_only"><code class="docutils literal notranslate"><span class="pre">ReadOnlyMiddleware.account_read_only()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.read_only.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#recon">Recon</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_async_info"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_async_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_auditor_info"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_auditor_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_device_info"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_device_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_diskusage"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_diskusage()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_driveaudit_error"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_driveaudit_error()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_expirer_info"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_expirer_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_load"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_load()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_mem"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_mem()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_mounted"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_mounted()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_quarantine_count"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_quarantine_count()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_reconstruction_info"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_reconstruction_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_relinker_info"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_relinker_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_replication_info"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_replication_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_ring_md5"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_ring_md5()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_sharding_info"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_sharding_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_socket_info"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_socket_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_swift_conf_md5"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_swift_conf_md5()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_time"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_time()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_unmounted"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_unmounted()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_updater_info"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_updater_info()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.recon.ReconMiddleware.get_version"><code class="docutils literal notranslate"><span class="pre">ReconMiddleware.get_version()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.copy">Server Side Copy</a><ul>
<li><a class="reference internal" href="#metadata">Metadata</a></li>
<li><a class="reference internal" href="#object-copy">Object Copy</a></li>
<li><a class="reference internal" href="#cross-account-object-copy">Cross Account Object Copy</a></li>
<li><a class="reference internal" href="#large-object-copy">Large Object Copy</a></li>
<li><a class="reference internal" href="#swift.common.middleware.copy.ServerSideCopyWebContext"><code class="docutils literal notranslate"><span class="pre">ServerSideCopyWebContext</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#static-large-objects">Static Large Objects</a></li>
<li><a class="reference internal" href="#staticweb">StaticWeb</a><ul>
<li><a class="reference internal" href="#swift.common.middleware.staticweb.StaticWeb"><code class="docutils literal notranslate"><span class="pre">StaticWeb</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.staticweb.StaticWeb.app"><code class="docutils literal notranslate"><span class="pre">StaticWeb.app</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.staticweb.StaticWeb.conf"><code class="docutils literal notranslate"><span class="pre">StaticWeb.conf</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.staticweb.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#symlink">Symlink</a><ul>
<li><a class="reference internal" href="#id17">Deployment</a><ul>
<li><a class="reference internal" href="#container-sync-configuration">Container sync configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.symlink.SymlinkContainerContext"><code class="docutils literal notranslate"><span class="pre">SymlinkContainerContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.symlink.SymlinkContainerContext.handle_container"><code class="docutils literal notranslate"><span class="pre">SymlinkContainerContext.handle_container()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.symlink.SymlinkMiddleware"><code class="docutils literal notranslate"><span class="pre">SymlinkMiddleware</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.symlink.SymlinkObjectContext"><code class="docutils literal notranslate"><span class="pre">SymlinkObjectContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.symlink.SymlinkObjectContext.handle_get_head"><code class="docutils literal notranslate"><span class="pre">SymlinkObjectContext.handle_get_head()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.symlink.SymlinkObjectContext.handle_get_head_symlink"><code class="docutils literal notranslate"><span class="pre">SymlinkObjectContext.handle_get_head_symlink()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.symlink.SymlinkObjectContext.handle_object"><code class="docutils literal notranslate"><span class="pre">SymlinkObjectContext.handle_object()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.symlink.SymlinkObjectContext.handle_post"><code class="docutils literal notranslate"><span class="pre">SymlinkObjectContext.handle_post()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.symlink.SymlinkObjectContext.handle_put"><code class="docutils literal notranslate"><span class="pre">SymlinkObjectContext.handle_put()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.symlink.symlink_sysmeta_to_usermeta"><code class="docutils literal notranslate"><span class="pre">symlink_sysmeta_to_usermeta()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.symlink.symlink_usermeta_to_sysmeta"><code class="docutils literal notranslate"><span class="pre">symlink_usermeta_to_sysmeta()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.tempauth">TempAuth</a><ul>
<li><a class="reference internal" href="#account-user-list">Account/User List</a></li>
<li><a class="reference internal" href="#multiple-reseller-prefix-items">Multiple Reseller Prefix Items</a></li>
<li><a class="reference internal" href="#required-group">Required Group</a></li>
<li><a class="reference internal" href="#x-service-token">X-Service-Token</a></li>
<li><a class="reference internal" href="#account-acls">Account ACLs</a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempauth.TempAuth"><code class="docutils literal notranslate"><span class="pre">TempAuth</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.tempauth.TempAuth.account_acls"><code class="docutils literal notranslate"><span class="pre">TempAuth.account_acls()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempauth.TempAuth.authorize"><code class="docutils literal notranslate"><span class="pre">TempAuth.authorize()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempauth.TempAuth.denied_response"><code class="docutils literal notranslate"><span class="pre">TempAuth.denied_response()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempauth.TempAuth.extract_acl_and_report_errors"><code class="docutils literal notranslate"><span class="pre">TempAuth.extract_acl_and_report_errors()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempauth.TempAuth.get_groups"><code class="docutils literal notranslate"><span class="pre">TempAuth.get_groups()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempauth.TempAuth.handle"><code class="docutils literal notranslate"><span class="pre">TempAuth.handle()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempauth.TempAuth.handle_get_token"><code class="docutils literal notranslate"><span class="pre">TempAuth.handle_get_token()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempauth.TempAuth.handle_request"><code class="docutils literal notranslate"><span class="pre">TempAuth.handle_request()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.tempauth.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tempurl">TempURL</a><ul>
<li><a class="reference internal" href="#client-usage">Client Usage</a></li>
<li><a class="reference internal" href="#cluster-configuration">Cluster Configuration</a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.DEFAULT_INCOMING_ALLOW_HEADERS"><code class="docutils literal notranslate"><span class="pre">DEFAULT_INCOMING_ALLOW_HEADERS</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.DEFAULT_INCOMING_REMOVE_HEADERS"><code class="docutils literal notranslate"><span class="pre">DEFAULT_INCOMING_REMOVE_HEADERS</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.DEFAULT_OUTGOING_ALLOW_HEADERS"><code class="docutils literal notranslate"><span class="pre">DEFAULT_OUTGOING_ALLOW_HEADERS</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.DEFAULT_OUTGOING_REMOVE_HEADERS"><code class="docutils literal notranslate"><span class="pre">DEFAULT_OUTGOING_REMOVE_HEADERS</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL"><code class="docutils literal notranslate"><span class="pre">TempURL</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.agent"><code class="docutils literal notranslate"><span class="pre">TempURL.agent</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.app"><code class="docutils literal notranslate"><span class="pre">TempURL.app</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.conf"><code class="docutils literal notranslate"><span class="pre">TempURL.conf</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.incoming_allow_headers"><code class="docutils literal notranslate"><span class="pre">TempURL.incoming_allow_headers</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.incoming_allow_headers_startswith"><code class="docutils literal notranslate"><span class="pre">TempURL.incoming_allow_headers_startswith</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.incoming_remove_headers"><code class="docutils literal notranslate"><span class="pre">TempURL.incoming_remove_headers</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.incoming_remove_headers_startswith"><code class="docutils literal notranslate"><span class="pre">TempURL.incoming_remove_headers_startswith</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.outgoing_allow_headers"><code class="docutils literal notranslate"><span class="pre">TempURL.outgoing_allow_headers</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.outgoing_allow_headers_startswith"><code class="docutils literal notranslate"><span class="pre">TempURL.outgoing_allow_headers_startswith</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.outgoing_remove_headers"><code class="docutils literal notranslate"><span class="pre">TempURL.outgoing_remove_headers</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.TempURL.outgoing_remove_headers_startswith"><code class="docutils literal notranslate"><span class="pre">TempURL.outgoing_remove_headers_startswith</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#swift.common.middleware.tempurl.filter_factory"><code class="docutils literal notranslate"><span class="pre">filter_factory()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.versioned_writes.legacy">Versioned Writes</a><ul>
<li><a class="reference internal" href="#id20">How to Enable Object Versioning in a Swift Cluster</a><ul>
<li><a class="reference internal" href="#upgrade-considerations">Upgrade considerations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples-using-curl-with-x-versions-location">Examples Using <code class="docutils literal notranslate"><span class="pre">curl</span></code> with <code class="docutils literal notranslate"><span class="pre">X-Versions-Location</span></code></a></li>
<li><a class="reference internal" href="#examples-using-curl-with-x-history-location">Examples Using <code class="docutils literal notranslate"><span class="pre">curl</span></code> with <code class="docutils literal notranslate"><span class="pre">X-History-Location</span></code></a></li>
<li><a class="reference internal" href="#how-to-disable-object-versioning-in-a-swift-cluster">How to Disable Object Versioning in a Swift Cluster</a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.legacy.VersionedWritesContext"><code class="docutils literal notranslate"><span class="pre">VersionedWritesContext</span></code></a><ul>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.legacy.VersionedWritesContext.handle_obj_versions_delete_pop"><code class="docutils literal notranslate"><span class="pre">VersionedWritesContext.handle_obj_versions_delete_pop()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.legacy.VersionedWritesContext.handle_obj_versions_delete_push"><code class="docutils literal notranslate"><span class="pre">VersionedWritesContext.handle_obj_versions_delete_push()</span></code></a></li>
<li><a class="reference internal" href="#swift.common.middleware.versioned_writes.legacy.VersionedWritesContext.handle_obj_versions_put"><code class="docutils literal notranslate"><span class="pre">VersionedWritesContext.handle_obj_versions_put()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-swift.common.middleware.xprofile">XProfile</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="https://openstack.org/projects/">Projects</a></li>
          <li><a href="https://www.openstack.org/software/security/">OpenStack Security</a></li>
          <li><a href="https://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="https://openstack.org/blog/">Blog</a></li>g
          <li><a href="https://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="https://openstack.org/community/">User Groups</a></li>
          <li><a href="https://openstack.org/community/events/">Events</a></li>
          <li><a href="https://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="https://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="https://docs.openstack.org/contributors">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="https://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="https://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="https://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="https://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="https://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="https://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="https://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-3.2.1.min.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- standard sphinx include libraries, which allow search highlighting -->
<script type="text/javascript" src="_static/underscore.js"></script>
<script type="text/javascript" src="_static/doctools.js"></script>
<script type="text/javascript" src="_static/searchtools.js"></script>
<script type="text/javascript" src="_static/language_data.js"></script>

<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '0.1.0.dev10164',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      LINK_SUFFIX: '.html',
      SOURCELINK_SUFFIX: '.txt',
      HAS_SOURCE:  true
    };
</script>

<!-- Javascript for page -->
<script language="JavaScript">
  /* Build a description of this page including SHA, source location on git
   * repo, build time and the project's launchpad bug tag. Set the HREF of the
   * bug buttons
   */
    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
    /* "giturl" is the URL of the source file on Git and is auto-generated by
     * openstackdocstheme.
     *
     * "pagename" is a standard sphinx parameter containing the name of
     * the source file, without extension.
     */

    var sourceFile = "middleware" + ".rst";
    gitURL = "Source: https://opendev.org/openstack/swift/src/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: c7afe681fd119752e66a8e9032e8782641fec3ff";
    var repositoryName = "openstack/swift";
    var bugProject = "swift";
    var bugTitle = "Middleware in Swift";
    var fieldTags = "";
    var useStoryboard = "";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.1.0.dev10164 on 2022-03-31 16:36:32";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags, repositoryName, useStoryboard);
    var currentSourceFile = "middleware";
    var pdfFileName = "doc-swift.pdf";
    pdfLink(currentSourceFile, pdfFileName);
</script>


  </body>
</html>